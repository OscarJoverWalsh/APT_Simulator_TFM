id,plugin,name,description,tactic,technique_id,technique_name
2f34977d-9558-4c12-abad-349716777c6b,sandcat,Sandcat,"CALDERA's default agent, written in GoLang. Communicates through the HTTP(S) contact by default.",command-and-control,T1105,Ingress Tool Transfer
356d1722-7784-40c4-822b-0cf864b0b36d,manx,Manx,A reverse-shell agent which communicates via the TCP contact,command-and-control,T1105,Ingress Tool Transfer
e13c4e45-d19f-440e-8a72-fad728a1789c,training,Delete Pretend Malicious Mail,Delete previously stored pretend malicious mail,training,x,x
f0d77555-fa79-4884-8afd-73d39f887879,training,Pretend Malicious Mail,Send an email with a pretend evil domain to be acted on,training,x,x
18702cd3-8e98-4eb7-99d4-0d2816926af1,training,Modify Bash/Powershell Profile,Add a line to the Bash or Powershell profile,training,x,x
fc4715ac-758e-4ba9-9e52-d07ff3d22a74,training,Add New Cronjob/Scheduled Task,Certification ability to create a new cronjob or scheduled task,training,x,x
6d53c4a8-ecd3-4131-a7a2-704a5b43dd83,training,Create Process on Unauthorized Port,Certification ability to create a listening process on an unauthorized port,training,x,x
586140a1-9755-4996-883d-82a17c7737b2,training,Pretend Malicious File,Create a pretend malicious file to be acted on,training,x,x
b007fe0c-c6b0-4fda-915c-255bbc070de2,stockpile,Copy Clipboard,copy the contents for the clipboard and print them,collection,T1115,Clipboard Data
4e97e699-93d7-4040-b5a3-2e906a58199e,stockpile,Stage sensitive files,copy files to staging directory,collection,T1074.001,Data Staged: Local Data Staging
30a8cf10-73dc-497c-8261-a64cc9e91505,stockpile,Compress staged directory (Password Protected),This ability packages staged files into a password-protected archive. Note - Requires 7Z for Windows and GPG version 2.1+ for Linux,collection,T1560.001,Archive Collected Data: Archive via Utility
6469befa-748a-4b9c-a96d-f191fde47d89,stockpile,Create staging directory,create a directory for exfil staging,collection,T1074.001,Data Staged: Local Data Staging
55678719-e76e-4df9-92aa-10655bbd1cf4,stockpile,cmd.exe information gathering,User enumeration,collection,T1059.001,Command and Scripting Interpreter: PowerShell
cc191baa-7472-4386-a2f4-42f203f1acfd,stockpile,SysInternals PSTool Process Discovery,Process discovery via SysInternals pstool,collection,T1057,Process Discovery
1f7ff232-ebf8-42bf-a3c4-657855794cfe,stockpile,Find company emails,Grep for all emails for the given target company,collection,T1005,Data from Local System
10fad81e-3f68-47be-83b6-fbee7711c6a9,stockpile,Advanced File Search and Stager,"Highly configurable file finder and stager for Linux and Windows. Drops a payload file to the host to parse
arguments rather than running multiple commands for each fact (e.g., each file type). This ability allows for a safe
mode, only staging files found that have the appropriate file ending. The staging directory is configurable but
defaults to the current user's Recycle Bin (Windows) and /tmp (Linux). Payload files include default values for all
parameters (matching the base fact source - File Search and Stage). Options for searches: file extensions (include,
exclude [windows]), directories (include, exclude), accessed date cutoff, modified date cutoff, sensitive search
strings in files or titles.
",collection,T1119,Automated Collection
316251ed-6a28-4013-812b-ddf5b5b007f8,stockpile,Screen Capture,capture the contents of the screen,collection,T1113,Screen Capture
90c2efaa-8205-480d-8bb6-61d90dbaf81b,stockpile,Find files,Locate files deemed sensitive,collection,T1005,Data from Local System
720a3356-eee1-4015-9135-0fc08f7eb2d5,stockpile,Find Git Repositories,This ability will locate directories that are cloned Git repositories.,collection,T1005,Data from Local System
94f21386-9547-43c4-99df-938ab05d45ce,stockpile,WMIC Process Enumeration,"Capture process id, executable path, pid and parent pid before writing to disk",collection,T1047,WMIC
02de522f-7e0a-4544-8afc-0c195f400f5f,stockpile,Parse SSH config,Search for valid SSH commands in the config file,collection,T1005,Data from Local System
d69e8660-62c9-431e-87eb-8cf6bd4e35cf,stockpile,Find IP addresses,Grep for IP addresses in file system per user,collection,T1005,Data from Local System
702bfdd2-9947-4eda-b551-c3a1ea9a59a2,stockpile,PowerShell information gathering,System Information Gathering Script,collection,T1059.001,Command and Scripting Interpreter: PowerShell
89955f55-529d-4d58-bed4-fed9e42515ec,stockpile,cURL socket address,See the raw content of a socket,collection,T1005,Data from Local System
52771610-2322-44cf-816b-a7df42b4c086,stockpile,Replace a service binary with alternate binary,"This is an example technique. snmptrap.exe should be changed in the command
below with the new desired service binary. Depending on the value of
host.service.modifiable this ability can damage the target system.
",persistence,T1543.003,Create or Modify System Process: Windows Service
95ad5d69-563e-477b-802b-4855bfb3be09,stockpile,wow64log DLL Hijack,Dll Hijack of WOW64 logger wow64log.dll using Akagi.exe,privilege-escalation,T1548.002,Abuse Elevation Control Mechanism: Bypass User Access Control
665432a4-42e7-4ee1-af19-a9a8c9455d0c,stockpile,UAC bypass registry,Set a registry key to allow UAC bypass,privilege-escalation,T1548.002,Abuse Elevation Control Mechanism: Bypass User Access Control
e99cce5c-cb7e-4a6e-8a09-1609a221b90a,stockpile,duser/osksupport DLL Hijack,UIPI bypass with uiAccess application,privilege-escalation,T1548.002,Abuse Elevation Control Mechanism: Bypass User Access Control
10681f2f-be03-44af-858d-f2b0812df185,stockpile,Weak executable files,Locate and infect files with weak but executable perms,privilege-escalation,T1574.010,Hijack Execution Flow: Services File Permissions Weakness
e3db134c-4aed-4c5a-9607-c50183c9ef9e,stockpile,Bypass UAC Medium,Bypass user account controls - medium,privilege-escalation,T1548.002,Abuse Elevation Control Mechanism: Bypass User Access Control
b7344901-0b02-4ead-baf6-e3f629ed545f,stockpile,Slui File Handler Hijack,executes the slui exe file handler hijack,privilege-escalation,T1548.002,Abuse Elevation Control Mechanism: Bypass User Access Control
47d08617-5ce1-424a-8cc5-c9c978ce6bf9,stockpile,Leave note,Create a text file for the user to find,impact,T1491,Defacement
78524da1-f347-4fbb-9295-209f1f408330,stockpile,Record microphone,Install sox and record microphone for n-seconds,impact,T1496,Resource Hijacking
0821b0b0-7902-4a7b-8052-80bda5a43684,stockpile,Shutdown Target System,Force shutdown a target system using Process Injection and raw shellcode,impact,T1499,Endpoint Denial of Service
46da2385-cf37-49cb-ba4b-a739c7a19de4,stockpile,Crypto (Monero) Mining,Download and execute Monero miner (xmrig) for 1 minute,impact,T1496,Resource Hijacking
68235976-2404-42a8-9105-68230cfef562,stockpile,Invoke-MemeKatz,Downloads random meme and sets as desktop background,impact,T1491,Defacement
2fe2d5e6-7b06-4fc0-bf71-6966a1226731,stockpile,Disrupt WIFI,Turn a computers WIFI off,impact,T1499,Endpoint Denial of Service
55f9600a-756f-496b-b27f-682052dc429c,stockpile,File Hunter Mission,Hunts for files of a certain extension and inserts a message,impact,T1565.001,Data Manipulation: Stored Data Manipulation
3b007f46-23e7-4a11-9c14-e7085b6a754a,stockpile,Quit Outlook,Quit Outlook,impact,T1489,Service Stop
0ab383be-b819-41bf-91b9-1bd4404d83bf,stockpile,Ragdoll,A Python agent which communicates via the HTML contact,command-and-control,T1071.001,Application Layer Protocol: Web Protocols
eb814e03-811a-467a-bc6d-dcd453750fa2,stockpile,Install PSTools,Download and install PSTools by unzipping the file,command-and-control,T1105,Ingress Tool Transfer
60f63260-39bb-4136-87a0-b6c2dca799fc,stockpile,Install PowerShell Core 6,"Download, install and start new process under PowerShell Core 6",command-and-control,T1105,Ingress Tool Transfer
de632c2d-a729-4b77-b781-6a6b09c148ba,stockpile,Find private keys,Find private keys on the file system,credential-access,T1552.004,Unsecured Credentials: Private Keys
7049e3ec-b822-4fdf-a4ac-18190f9b66d1,stockpile,Powerkatz (Staged),Use Invoke-Mimikatz,credential-access,T1003.001,OS Credential Dumping: LSASS Memory
1b4fb81c-8090-426c-93ab-0a633e7a16a7,stockpile,Sniff network traffic,Perform a packet capture,credential-access,T1040,Network Sniffing
0ef4cc7b-611c-4237-b20b-db36b6906554,stockpile,Leverage Procdump for lsass memory,Dump lsass for later use with mimikatz,credential-access,T1003.001,OS Credential Dumping: LSASS Memory
98e58fc4-3843-4511-89b1-50cb872e0c9b,stockpile,Credentials in Registry - HKLM,Search for possible credentials stored in the HKLM Hive,credential-access,T1552.002,Unsecured Credentials: Credentials in Registry
422526ec-27e9-429a-995b-c686a29561a4,stockpile,Dump history,Get contents of bash history,credential-access,T1552.003,Unsecured Credentials: Bash History
baac2c6d-4652-4b7e-ab0a-f1bf246edd12,stockpile,Run PowerKatz,Use powerkatz to execute mimikatz and attempt to grab plaintext and/or hashed passwords,credential-access,T1003.001,OS Credential Dumping: LSASS Memory
3aad5312-d48b-4206-9de4-39866c12e60f,stockpile,Credentials in Registry - HKCU,Search for possible credentials stored in Registry,credential-access,T1552.002,Unsecured Credentials: Credentials in Registry
c9f2c7ae-0092-4ea0-b9ae-92014eba7ce7,stockpile,Inject Cred dumper into process (Spookier),Injects cred dumper exe into an available process,credential-access,T1055.002,Process Injection: Portable Executable Injection
3c647015-ab0a-496a-8847-6ab173cd2b22,stockpile,MiniDumpWriteDump (Spooky),Custom GO credential dumper using minidumpwritedump,credential-access,T1003,OS Credential Dumping
b007f6e8-4a87-4440-8888-29ceab047d9b,stockpile,Disable Windows Defender All,Disable Windows Defender All,defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
e5bcefee-262d-4568-a261-e8a20855ec81,stockpile,Signed Binary Execution - Mavinject,Leverage Mavinject (signed binary) for DLL injection,defense-evasion,T1055.002,Process Injection: Portable Executable Injection
3864fd22-5c63-41c9-bdbc-a66b5ffa3f5e,stockpile,Bypass ExecutionPolicy,Ensure the ExecutionPolicy is turned to Bypass,defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
36eecb80-ede3-442b-8774-956e906aff02,stockpile,1-min sleep,Pause all operations to avoid making noise,defense-evasion,T1497.003,Virtualization/Sandbox Evasion: Time Based Evasion
49470433-30ce-4714-a44b-bea9dbbeca9a,stockpile,Disable Windows Defender Real-Time Protection,Disable Windows Defender Real-Time Protection,defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
4cd4eb44-29a7-4259-91ae-e457b283a880,stockpile,Delete payload,Remove a downloaded payload file,defense-evasion,T1070.004,Indicator Removal on Host: File Deletion
1258b063-27d6-489b-a677-4807faacf868,stockpile,Check Security Services,Check for security services. Security service list is based on the SUNBURST malware observed in a Solarwinds related compromise (https://research.checkpoint.com/2020/sunburst-teardrop-and-the-netsec-new-normal/).,defense-evasion,T1497.001,Virtualization/Sandbox Evasion: System Checks
5f844ac9-5f24-4196-a70d-17f0bd44a934,stockpile,Deadman - Delete agent file,Deadman ability to delete agent file after termination.,defense-evasion,T1070.004,Indicator Removal on Host: File Deletion
a398986f-31b0-436a-87e9-c8e82c028f3c,stockpile,Inject Sandcat into process,Injects sandcat DLL into an available process,defense-evasion,T1055.002,Process Injection: Portable Executable Injection
a42dfc86-12f0-4f06-b0cf-24830c7f61f4,stockpile,Spawn calculator (shellcode),Start a new calculator process,defense-evasion,T1055,Process Injection
7a6ba833-de40-466a-8969-5c37b13603e0,stockpile,Check analysis environment processes,Check for analysis/sandbox environment processes. Process black list is based on the SUNBURST malware observed in a Solarwinds related compromise (https://research.checkpoint.com/2020/sunburst-teardrop-and-the-netsec-new-normal/).,defense-evasion,T1497.001,Virtualization/Sandbox Evasion: System Checks
fcf71ee3-d1a9-4136-b919-9e5f6da43608,stockpile,Clear Logs,Clear Sysmon logs [intended to trigger CAR-2016-04-002],defense-evasion,T1070.001,Indicator Removal on Host: Clear Windows Event Logs
e5f9de8f-3df1-4e78-ad92-a784e3f6770d,stockpile,Move Powershell & triage,Copy powershell to non-standard location and perform triage commands,defense-evasion,T1059.001,PowerShell
a74bc239-a196-4f7e-8d5c-fe8c0266071c,stockpile,Signed Binary Execution - odbcconf,Leverage odbcconf for DLL injection,defense-evasion,T1055.001,Process Injection: Dynamic-link Library Injection
43b3754c-def4-4699-a673-1d85648fda6a,stockpile,Avoid logs,Stop terminal from logging history,defense-evasion,T1070.003,Indicator Removal on Host: Clear Command History
8adf02e8-6e71-4244-886c-98c402857404,stockpile,tasklist Process Enumeration,Capture running processes and their loaded DLLs,discovery,T1057,Process Discovery
a0676fe1-cd52-482e-8dde-349b73f9aa69,stockpile,Preferred WIFI,See the most used WIFI networks of a machine,discovery,T1016,System Network Configuration Discovery
4d9b079c-9ede-4116-8b14-72ad3a5533af,stockpile,PowerShell Process Enumeration,Capture running processes via PowerShell,discovery,T1057,Process Discovery
3a2ce3d5-e9e2-4344-ae23-470432ff8687,stockpile,Fingerprint network services,Uses nmap to fingerprint services that were network accessible,discovery,T1046,Network Service Scanning
b18e8767-b7ea-41a3-8e80-baf65a5ddef5,stockpile,Check Python,Check to see what version of python is installed,discovery,T1518,Software Discovery
6e1a53c0-7352-4899-be35-fa7f364d5722,stockpile,Print Working Directory,Print the current working directory on the system,discovery,T1083,File and Directory Discovery
2dece965-37a0-4f70-a391-0f30e3331aba,stockpile,Discover antivirus programs,Identify AV,discovery,T1518.001,Software Discovery: Security Software Discovery
b007fc38-9eb7-4320-92b3-9a3ad3e6ec25,stockpile,Get Chrome Bookmarks,Get Chrome Bookmarks,discovery,T1217,Browser Bookmark Discovery
5c65eec8-4839-4713-a4e1-86b2e75d1927,stockpile,Application Window Discovery,"Extracts the names of all open non-explorer windows, and the locations of all explorer windows.",discovery,T1010,Application Window Discovery
9a30740d-3aa8-4c23-8efa-d51215e8a5b9,stockpile,Scan WIFI networks,View all potential WIFI networks on host,discovery,T1016,System Network Configuration Discovery
6c91884e-11ec-422f-a6ed-e76774b0daac,stockpile,View printer queue,View details of queued documents in printer queue,discovery,T1120,Peripheral Device Discovery
ce485320-41a4-42e8-a510-f5a8fe96a644,stockpile,Discover Mail Server,Identify the organizations mail server,discovery,T1018,Remote System Discovery
c9be8043-a445-4cbf-b77b-ed7bb007fc7c,stockpile,Internet Explorer Version,Determine the version of Internet Explorer running,discovery,T1518,Software Discovery
9b007f62-daa1-44bd-a57d-00c5315ec6fe,stockpile,USB Connected Device Discovery,find attached usb devices,discovery,T1120,Peripheral Device Discovery
530e47c6-8592-42bf-91df-c59ffbd8541b,stockpile,View admin shares,Network Share Discovery,discovery,T1135,Network Share Discovery
0360ede1-3c28-48d3-a6ef-6e98f562c5af,stockpile,GetComputers (Alice),Get a list of all computers in a domain,discovery,T1018,Remote System Discovery
ac9dce33-2acc-4b34-94ce-2596409ce8f0,stockpile,Ping network,Ping the network in order to build the ARP cache,discovery,T1016,System Network Configuration Discovery
0093c0e0-68b6-4cab-b0d4-2b40b3c78f71,stockpile,enumerate VMs,Enumerate running virtual machines on hypervisor,discovery,T1057,Process Discovery
c1cd6388-3ced-48c7-a511-0434c6ba8f48,stockpile,Find local users,Get a list of all local users,discovery,T1087.001,Account Discovery: Local Account
0bff4ee7-42a4-4bde-b09a-9d79d8b9edd7,stockpile,Find LSASS,Get process info for LSASS,discovery,T1057,Process Discovery
5c4dd985-89e3-4590-9b57-71fed66ff4e2,stockpile,Permission Groups Discovery,Summary of permission and security groups,discovery,T1069.001,Permission Groups Discovery: Local Groups
5f77ecf9-613f-4863-8d2f-ed6b447a4633,stockpile,Parse SSH known_hosts,View the known_hosts file,discovery,T1018,Remote System Discovery
830bb6ed-9594-4817-b1a1-c298c0f9f425,stockpile,Check Chrome,Check to see if Gooogle Chrome browser is installed,discovery,T1518,Software Discovery
29451844-9b76-4e16-a9ee-d6feab4b24db,stockpile,PowerShell version,Discover the PowerShell version,discovery,T1082,System Information Discovery
85341c8c-4ecb-4579-8f53-43e3e91d7617,stockpile,Collect ARP details,Locate all active IP and FQDNs on the network,discovery,T1018,Remote System Discovery
c6607391-d02c-44b5-9b13-d3492ca58599,stockpile,Discover system services,Identify system services,discovery,T1007,System Service Discovery
e8017c46-acb8-400c-a4b5-b3362b5b5baa,stockpile,Network Interface Configuration,View network configuration info for host,discovery,T1016,System Network Configuration Discovery
7c42a30c-c8c7-44c5-80a8-862d364ac1e4,stockpile,UAC Status,Determine whether or not UAC is enabled,discovery,T1518.001,Software Discovery: Security Software Discovery
74d1b640-7f1e-4b36-beba-23a8228f39e0,stockpile,Local FQDN,Uses windows libraries to get FQDN of infected host,discovery,,
b6f545ef-f802-4537-b59d-2cb19831c8ed,stockpile,Snag broadcast IP,Capture the local network broadcast IP address,discovery,T1016,System Network Configuration Discovery
2946edba-54d8-11eb-ae93-0242ac130002,stockpile,Password Policy for a domain,Password Policy Discovery for a domain,discovery,T1201,Password Policy Discovery for a domain
638fb6bb-ba39-4285-93d1-7e4775b033a8,stockpile,Find System Network Connections,Find System Network Connections,discovery,T1049,System Network Connections Discovery
921055f4-5970-4707-909e-62f594234d91,stockpile,Remote Host Ping,Ping a remote host to see if it is accessible,discovery,T1016,System Network Configuration Discovery
47abe1f5-55a5-46cc-8cad-506dac8ea6d9,stockpile,Scan IP for ports,Use dropped scanner to find open popular ports,discovery,T1046,Network Service Scanning
c0da588f-79f0-4263-8998-7496b1a40596,stockpile,Identify active user,Find user running agent,discovery,T1033,System Owner/User Discovery
1c353eb4-29ab-4dfe-88ed-f34f5a60848e,stockpile,File and Directory Discovery,Find or discover files on the file system,discovery,T1083,File and Directory Discovery
26c8b8b5-7b5b-4de1-a128-7d37fb14f517,stockpile,Discover domain controller,Identify the remote domain controllers,discovery,T1018,Remote System Discovery
f1cf4ea1-43f0-4604-9537-3d1b1b2d5b1c,stockpile,GetServiceAccounts,Get Service Accounts for a domain,discovery,T1033,System Owner/User Discovery
52177cc1-b9ab-4411-ac21-2eadc4b5d3b8,stockpile,List Directory,List contents of current directory,discovery,T1083,File and Directory Discovery
8c06ebf8-bacf-486b-bd77-21ba8c5a5777,stockpile,Identify Firewalls,Identify Firewalls,discovery,T1518.001,Software Discovery: Security Software Discovery
a41c2324-8c63-4b15-b3c5-84f920d1f226,stockpile,Locate file from printer queue,Locate file that appears in the printer queue,discovery,T1083,File and Directory Discovery
b6b105b9-41dc-490b-bc5c-80d699b82ce8,stockpile,Find OS Version,Find OS Version,discovery,T1082,System Information Discovery
6d90e6fa-9324-4eb5-93be-9f737245bd7z,stockpile,Discover Domain Admins,Use PowerView to query the Active Directory server to determine remote admins,discovery,T1069.002,Permission Groups Discovery: Domain Groups
2488245e-bcbd-405d-920e-2de27db882b3,stockpile,Query Registry,Query Registry using PowerShell Get-ItemProperty,discovery,T1012,Query Registry
5a39d7ed-45c9-4a79-b581-e5fb99e24f65,stockpile,System processes,Identify system processes,discovery,T1057,Process Discovery
e82f39e2-56f8-4f19-8376-b007f9ac5f8a,stockpile,Password Policy,Password Policy Discovery,discovery,T1201,Password Policy Discovery
30732a56-4a23-4307-9544-09caf2ed29d5,stockpile,Find deletable dirs (per user),Discover all directories containing deletable files by user,discovery,T1082,System Information Discovery
05cda6f6-2b1b-462e-bff1-845af94343f7,stockpile,Discover injectable process,Discovers processes that the current user has the ability to access and selects an injectable one,discovery,T1057,Process Discovery
335cea7b-bec0-48c6-adfb-6066070f5f68,stockpile,View Processes,Display information about current system processes,discovery,T1057,Process Discovery
feaced8f-f43f-452a-9500-a5219488abb8,stockpile,Identify local users,Identify all local users,discovery,T1087.001,Account Discovery: Local Account
3b5db901-2cb8-4df7-8043-c4628a6a5d5a,stockpile,Find user processes,Get process info for processes running as a user,discovery,T1057,Process Discovery
46098c66-8d9a-4d23-8a95-dd5021c385ae,stockpile,Linux Enumeration & Privilege Escalation Discovery Script,Download and execute LinEnum.sh,discovery,T1082,System Information Discovery
deeac480-5c2a-42b5-90bb-41675ee53c7e,stockpile,View remote shares,View the shares of a remote host,discovery,T1135,Network Share Discovery
6131397e-7765-424e-a594-3d7fb2d93a6a,stockpile,GetDomain,Determine the Windows Domain of a computer,discovery,T1482,Domain Trust Discovery
13379ae1-d20e-4162-91f8-320d78a35e7f,stockpile,Discover local hosts,Use PowerView to query the Active Directory server for a list of computers in the Domain,discovery,T1018,Remote System Discovery
fdf8bf36-797f-4157-805b-fe7c1c6fc903,stockpile,Find Hostname,Find hostname of remote host,discovery,T1018,Remote System Discovery
14a21534-350f-4d83-9dd7-3c56b93a0c17,stockpile,Find Domain,Find Domain information,discovery,T1016,System Network Configuration Discovery
aaf34d82-aea9-4278-8ec4-789653e4f5d9,stockpile,GetAdminMembers,Get Administrator users for a computer,discovery,T1033,System Owner/User Discovery
5a4cb2be-2684-4801-9355-3a90c91e0004,stockpile,Network Service Scanning,Scans the local network for common open ports,discovery,T1046,Network Service Scanning
fa6e8607-e0b1-425d-8924-9b894da5a002,stockpile,Get System Time,get current system time (ISO 8601),discovery,T1124,System Time Discovery
364ea817-bbb9-4083-87dd-94b9dba45f6f,stockpile,Account Discovery (targeted),The net utility is executed via cmd to enumerate detailed information about a specific user account.,discovery,T1087.002,Account Discovery: Domain Account
5dc841fd-28ad-40e2-b10e-fb007fe09e81,stockpile,Virtual or Real,Determine if the system is virtualized or physical,discovery,T1497.001,Virtualization/Sandbox Evasion: System Checks
9849d956-37ea-49f2-a8b5-f2ca080b315d,stockpile,Check Go,Check to see if GoLang is installed,discovery,T1518,Software Discovery
2afae782-6d0a-4fbd-a6b6-d1ce90090eac,stockpile,Account-type Admin Enumerator,Use PowerView to query the Active Directory server to determine remote admins,discovery,T1069.002,Permission Groups Discovery: Domain Groups
bd527b63-9f9e-46e0-9816-b8434d2b8989,stockpile,Current User,Obtain user from current session,discovery,T1033,System Owner/User Discovery
fa4ed735-7006-4451-a578-b516f80e559f,stockpile,Reverse nslookup IP,Find hostname of remote IP in domain,discovery,T1018,Remote System Discovery
c7ec57cd-933e-42b6-99a4-e852a9e57a33,stockpile,Account Discovery (all),The net utility is executed via cmd to enumerate domain user accounts.,discovery,T1087.002,Account Discovery: Domain Account
22881b9d-0efa-4ef4-9704-df0f11170cc3,stockpile,Lateral Movement - esentutl,Tool transfer to lateral hosts using Alternate Data Streams to hide implant,lateral-movement,,
41bb2b7a-75af-49fd-bd15-6c827df25921,stockpile,Start Agent (WinRM),Start Agent using WinRM (WinRM),lateral-movement,T1021.006,Remote Services: Windows Remote Management
4908fdc4-74fc-4d7c-8935-26d11ad26a8d,stockpile,Copy 54ndc47 (WinRM and SCP),Copy 54ndc47 to remote host (powershell 5 or newer only) or SCP,lateral-movement,T1570,Lateral Tool Transfer
96d3c175-5e58-424c-8350-d7514b28a075,stockpile,Lateral Movement - Certutil,Uses CertUtil as a LoL technique to move the .exe agent as a certificate using windows-signed binaries,lateral-movement,,
620b674a-7655-436c-b645-bc3e8ea51abd,stockpile,Copy Sandcat File using PsExec on CMD,Copy Sandcat file using PsExec on CMD,lateral-movement,T1570,Lateral Tool Transfer
aa6ec4dd-db09-4925-b9b9-43adeb154686,stockpile,Mount Share,Mount a windows share,lateral-movement,T1021.002,Remote Services: SMB/Windows Admin Shares
3734aa1e-c536-42b3-8912-4c91b8bdce90,stockpile,Copy Sandcat File using Powershell,Copy Sandcat file using PowerShell,lateral-movement,T1021.006,Remote Services: Windows Remote Management
40161ad0-75bd-11e9-b475-0800200c9a66,stockpile,Net use,Mounts a network file share on a target computer,lateral-movement,T1021.002,Remote Services: SMB/Windows Admin Shares
65048ec1-f7ca-49d3-9410-10813e472b30,stockpile,Copy 54ndc47 (SMB),Copy 54ndc47 to remote host (SMB),lateral-movement,T1021.002,Remote Services: SMB/Windows Admin Shares
10a9d979-e342-418a-a9b0-002c483e0fa6,stockpile,Start 54ndc47,"Copy 54ndc47 to remote host and start it, assumes target uses SSH keys and passwordless authentication",lateral-movement,T1021.004,Remote Services: SSH
e7bf5dc7-62e4-48b2-acf8-abaf8734c19c,stockpile,Exfil Compressed Archive to S3 via AWS CLI,"Exfiltrate the compressed archive to the provided S3 bucket using the AWS CLI. It is assumed that the user
credentials configured with AWS CLI have the proper permissions to write to the target S3 bucket.
",exfiltration,,
110cea7a-5b03-4443-92ee-7ccefaead451,stockpile,Scheduled Exfiltration,This ability exfiltrates the staged directory at a scheduled time.,exfiltration,T1029,Scheduled Transfer
5c5b0392-1daa-45e1-967c-2f361ce78849,stockpile,Compress Staged Directory (Password Protected) and Split Into Smaller Chunks,"This ability will compress the staged files into a password protected archive and break it
into smaller chunks based on the given byte size. The original archive will be automatically
deleted. Use this instead of other archiving abilities if small file sizes for exfiltration 
are desired. When used with an exfiltration ability, the exfiltration ability will run numerous
times in an operation depending on how many chunks are created. 
",exfiltration,T1030,Data Transfer Size Limits
dd4d3d6f-be0a-4d80-ada2-0b7f3228d2dc,stockpile,Exfil Compressed Archive to S3 via Golang,"Use the AWS SDK for GoLang to upload the compressed archive to the provided S3 bucket.
It is assumed that the current user credentials have the proper permissions to write to the target S3 bucket.
Requires the agent to be compiled with the native_aws extension.
Timeout set to 45 seconds.
",exfiltration,T1567.002,Exfiltration to Cloud Storage
4a1120a5-971c-457f-bb07-60641b4723fd,stockpile,Exfil Compressed Archive to Github Repository,This will exfiltrate a given compressed directory to a GitHub repository. It assumes that all the facts supplied are valid.,exfiltration,T1567.001,Exfiltration to Code Repository
ea713bc4-63f0-491c-9a6f-0b01d560b87e,stockpile,Exfil staged directory,Exfil the staged directory,exfiltration,T1041,Exfiltration Over C2 Channel
300157e5-f4ad-4569-b533-9d1fa0e74d74,stockpile,Compress staged directory,Compress a directory on the file system,exfiltration,,
3ce95a28-25fc-4a7e-a0cd-0fdb190e2081,stockpile,Exfil Compressed Archive to Dropbox,This will exfiltrate an archive to Dropbox.,exfiltration,T1567.002,Exfiltration to Cloud Storage
2f90d4de-2612-4468-9251-b220e3727452,stockpile,Compress Git Repository,This ability will compress a given git repository.,exfiltration,,
d754878c-17dd-46dc-891c-a993f8a10336,stockpile,Exfil Compressed Archive to FTP Server,This ability exfiltrates a compressed archive to an FTP server.,exfiltration,T1048.003,Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol
a201bec2-a193-4b58-bf0e-57fa621da474,stockpile,Exfil Directory Files to GitHub,"This ability will exfiltrate all files in a set staged directory to a repository in GitHub.
",exfiltration,T1567.001,Exfiltration to Code Repository
ba0deadb-97ac-4a4c-aa81-21912fc90980,stockpile,Transfer Compressed Archive to Separate S3 Bucket via AWS CLI,"Transfer the compressed archive from one S3 bucket to another S3 bucket via AWS CLI. It is assumed that the proper
policies and security rules are in place to allow reading from the source bucket and writing to the destination
bucket.
",exfiltration,T1537,Transfer Data to Cloud Account
0582dc26-e0cf-4645-88cf-f37a02279976,stockpile,Exfil Compressed Archive to Github Gist,"This ability exfiltrates a compressed archive to Github Gists (Base64 Encoded). To reconstitute, save
the base64 string from the Gist and run ----
(Powershell) [Convert]::FromBase64String($(Get-Content b64.txt)) | set-content archive.extension -encoding byte ----
(Linux) cat b64.txt | base64 -d > archive.extension
",exfiltration,T1567.001,Exfiltration to Code Repository
ece5dde3-d370-4c20-b213-a1f424aa8d03,stockpile,Start 54ndc47 (WMI),Remotely executes 54ndc47 over WMI,execution,T1047,Windows Management Instrumentation
b1d41972-3ad9-4aa1-8f7f-05f049a2980e,stockpile,Start 54ndc47,Start a new 54ndc47 agent in background,execution,T1059.004,Command and Scripting Interpreter: Unix Shell
3796a00b-b11d-4731-b4ca-275a07d83299,stockpile,Impersonate user,Run an application as a different user,execution,T1059.001,Command and Scripting Interpreter: PowerShell
bfff9006-d1fb-46ce-b173-92cb04e9a031,stockpile,PowerShell bitly Link Download,Download,execution,T1059.001,Command and Scripting Interpreter: PowerShell
315cedf1-4a3a-4015-b63f-149d64bacbbc,stockpile,Emulate Administrator Tasks,Emulate administrator tasks on a system in a separate process,execution,T1059.001,Command and Scripting Interpreter: PowerShell
134b49a3-3f93-41bd-85f4-563eadbb6055,stockpile,Stop PowerShell processes,Kill all PowerShell processes,execution,T1059.001,Command and Scripting Interpreter: PowerShell
de52784d-4de6-4d4e-b79e-e7b68fe037fb,stockpile,Add bookmark,Add a malicous bookmark which looks like a current one,execution,T1059.002,Command and Scripting Interpreter: AppleScript
ccdb8caf-c69e-424b-b930-551969450c57,stockpile,PowerShell Invoke MimiKats,Download,execution,T1059.001,Command and Scripting Interpreter: PowerShell
95727b87-175c-4a69-8c7a-a5d82746a753,stockpile,Service Creation,"Create a service named ""sandsvc"" to execute remote 54ndc57 binary named ""s4ndc4t.exe""",execution,T1569.002,System Services: Service Execution
bf565e6a-0037-4aa4-852f-1afa222c76db,response,Search for Child Processes (elastic),Search for Sysmon Event 1 records to discover children of known processes.,hunt,x,x
4b283acc-45c0-4de8-b0ac-ac0699e5ab95,response,Search for PowerShell ExecutionPolicy Bypass (elastic),"Search for Sysmon Event 1 powershell records with ""ExecutionPolicy"" and ""Bypass""",hunt,x,x
b419604e-6f82-40a4-b215-12f8c8156c2f,response,Search for Parent Processes (elastic),Search for Sysmon Event 1 records to discover parents of known processes.,hunt,x,x
1837b43e-4fff-46b2-a604-a602f7540469,response,Elasticat,A Blue Python agent that executes elasticsearch queries.,command-and-control,T1071,Standard Application Layer Protocol
02fb7fa9-8886-4330-9e65-fa7bb1bc5271,response,Kill rogue process,Force kill any unauthorized processes,response,x,x
13d0d9cf-e31a-47b6-9217-f38e3f7c25ef,response,System Information from GUID,Collect system information from Sysmon event log given ProcessGUID. Ability timeout may need to be increased depending on Sysmon log size.,response,x,Query Event Logs
4744d99f-5fea-42a8-8ec4-c228db57caea,response,Remove Unauthorized Scheduled Task,Removes newly added scheduled tasks,response,x,x
e846973a-767b-4f9c-8b9e-5249cfcd7b97,response,Restore File Backup,Restore backups of files if file has been modified,response,x,x
32e563bb-ba06-4bcc-b817-fc2c434c0b66,response,Remove Unauthorized Cron Job,Removes newly added cron jobs,response,x,x
5ec7ae3b-c909-41bb-9b6b-dadec409cd40,response,Delete known suspicious files,"Use hash of known suspicious file to find instances of said file, and delete instances",response,x,x
2331077e-7be9-4e89-b2bb-32e8d7f6a708,response,Collect Parent's Child Proccesses,Collect all process creation events with the given parent process GUID,response,x,Query Event Logs
cb85039a-6196-4262-883b-0beeb804b83d,response,Enable Outbound TCP/UDP firewall rule,Blocks outbound TCP and UDP traffic on a specific port,response,T1065,Uncommonly Used Port
0fccf23f-6b1a-4ef3-8c89-e8bf27a1858f,response,Collect Grandchild Processes,Collect grandchild processes from Sysmon logs,response,x,Query Event Logs
debd322d-2100-45f7-8832-29ef7c56786d,response,Enable Inbound TCP/UDP firewall rule,Blocks inbound TCP and UDP traffic on a specific port,response,T1065,Uncommonly Used Port
bf01fdc9-d801-4461-81df-e511efb3c1fc,response,Restore Modified Sensitive Directory,Restore sensitive directories with their backups if they have been modified,response,x,x
f5fb8bce-4a79-466a-8187-ed0cd8e8dbe1,response,Collect Child Processes,Collect child processes from Sysmon logs,response,x,Query Event Logs
90418255-b202-4fc3-b0ea-b105bff39ca5,response,Collect GUID from PID,Collect process GUIDs by querying Sysmon for all events associated with the given PID,response,x,Query Event Logs
2ca64acd-dc12-4cc8-b78a-6a182508a50b,response,Inoculate C2,Reroute suspicious IP addresses to localhost by editing hosts file,response,x,x
83d7cf63-e10a-4615-a92e-dce257bf3b9d,response,Backup Powershell Profiles,"This ability creates backups of Powershell profiles, creating the profiles themselves if they do not exist.",setup,x,x
90a67a85-e81c-4525-8bae-12a2c5787d9a,response,Hash Powershell Profiles,"This ability creates file hashes of Powershell profiles, creating the profiles themselves if they do not exist.",setup,x,x
a65a62e1-b8c0-4f88-b564-166e7499d560,response,Scheduled Tasks Baseline,Capture the scheduled tasks that exist at the start of the operation,setup,x,x
df9d2b83-b40f-4167-af75-31ddde59af7e,response,Hash Bash Profiles,"If bash profile doesn't exist, create it, and then hash each profile.",setup,x,x
622e4bda-e5a8-42bb-93d9-a7b1eebc7e41,response,Backup Bash Profiles,"If bash profile doesn't exist, create it, and then backup each profile.",setup,x,x
243053d2-13c1-47f0-832d-6ef02ba95e1a,response,Backup Sensitive Directories,Create compressed backups of sensitive directories,setup,x,x
f313a0d7-2327-4f69-8da4-a6efd6135121,response,Hash Sensitive Files,Acquire hashes of sensitive files as a baseline to check if they are changed in the future,setup,x,x
2ed3c315-2022-499e-a844-1bbd119d0abe,response,Hash Sensitive Directories,Acquire hashes of compressed sensitive directories as a baseline to check if they are changed in the future,setup,x,x
34bc0116-13b6-4dd5-b681-9554c2a1fa95,response,Backup Sensitive Files,Backup sensitive files to temp directory in case these files are maliciously modified,setup,x,x
ba907d7a-b334-47e7-b652-4e481b5aa534,response,User Cron Jobs Baseline,Capture the cron jobs that exist at the start of the operation,setup,x,x
1b4aa8d5-ba97-4b9b-92a3-eaaaffbfdf0a,response,Find atypical open ports,Compare open ports against a known baseline,detection,T1065,Uncommonly Used Port
ee54384f-cfbc-4228-9dc1-cc5632307afb,response,New Cron Jobs,Checks to see if a new (unauthorized) cron job has been added,detection,x,x
3b4640bc-eacb-407a-a997-105e39788781,response,Find unauthorized processes,Search for processes which should not be on the host,detection,x,x
1226f8ec-e2e5-4311-88e7-378c0e5cc7ce,response,Suspicious URLs in mail,Finds suspicious URLs in received mail,detection,x,x
77272c88-ccf5-4225-a3d9-f9e171d1ca5b,response,Acquire suspicious files,Get information from AV about suspicious files,detection,x,x
930236c2-5397-4868-8c7b-72e294a5a376,response,Modified Sensitive Files,Checks sensitive file hashes against previously stored hashes to determine if the file has been modified,detection,x,x
8bc73098-54d1-4f69-abd5-271e3e2da5df,response,New Scheduled Tasks,Checks to see if a new (unauthorized) scheduled task has been added,detection,x,x
9bc10f37-0853-4d73-b547-019c11eda22f,response,Modified Sensitive Directory,Checks sensitive directory hashes against previously stored hashes to determine if the directory has been modified,detection,x,x
f9b3eff0-e11c-48de-9338-1578b351b14b,response,Hunt for known suspicious files,Use hash of known suspicious file to find instances of said file on hosts,hunt,x,x
4a9b51ba-1a0d-4128-a040-5535fd147dc3,gameboard,GameBoard Plugin Manual Detection - PID,GameBoard plugin pid detection placeholder ability,verification,x,x
0df4d46e-e202-4b29-9a19-c2540982002d,gameboard,GameBoard Plugin Manual Detection - GUID,GameBoard plugin guid detection placeholder ability,verification,x,x
e947c2f5e248a8bbfe0e26b5bf688109,atomic,Office365 - Email Forwarding,"Creates a new Inbox Rule to forward emails to an external user via the ""ForwardTo"" property of the New-InboxRule Powershell cmdlet.
",collection,T1114.003,Email Collection: Email Forwarding Rule
53d41aa7edbb10cea4c99df8c2b0862f,atomic,using device audio capture commandlet,"[AudioDeviceCmdlets](https://github.com/cdhunt/WindowsAudioDevice-Powershell-Cmdlet)
",collection,T1123,Audio Capture
b42bac313bde7e1641452628af72b915,atomic,Compress Data for Exfiltration With Rar,"An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration.
When the test completes you should find the txt files from the %USERPROFILE% directory compressed in a file called T1560.001-data.rar in the %USERPROFILE% directory 
",collection,T1560.001,Archive Collected Data: Archive via Utility
da86001b5081fcf773d8e62f22cf2b00,atomic,Registry artefact when application use webcam,"[can-you-track-processes-accessing-the-camera-and-microphone](https://svch0st.medium.com/can-you-track-processes-accessing-the-camera-and-microphone-7e6885b37072)
",collection,T1125,Video Capture
dca411f2ebdac351c96959066ac30a68,atomic,Add or copy content to clipboard with xClip,"Utilize Linux Xclip to copy history and place in clipboard then output to a history.txt file. Successful execution will capture history and output to a file on disk.
",collection,T1115,Clipboard Data
f1bd28014dc55d1849088a8e69a0b4ca,atomic,AWS - Scan for Anonymous Access to S3,"Upon successful execution, this test will test for anonymous access to AWS S3 buckets and dumps all the files to a local folder. 
",collection,T1530,Data from Cloud Storage Object
a9c2711492ba2c44d1ef3194a0ee138b,atomic,Azure - Enumerate Azure Blobs with MicroBurst,"Upon successful execution, this test will utilize a wordlist to enumerate the public facing containers and blobs of a specified Azure storage account. 
See https://www.netspi.com/blog/technical/cloud-penetration-testing/anonymously-enumerating-azure-file-resources/ . 
",collection,T1530,Data from Cloud Storage Object
4f7a9fbe6ef84e7fb32a3e85b7762210,atomic,Data Encrypted with zip and gpg symmetric,"Encrypt data for exiltration
",collection,T1560.001,Archive Collected Data: Archive via Utility
372e6f46fca18e4f1b43209c20ffafa2,atomic,Registry artefact when application use microphone,"[can-you-track-processes-accessing-the-camera-and-microphone](https://svch0st.medium.com/can-you-track-processes-accessing-the-camera-and-microphone-7e6885b37072)
",collection,T1123,Audio Capture
344e7eaf650763e0d3e9f02e62c1cf4b,atomic,Recon information for export with PowerShell,"collect information for exfiltration. Upon execution, check the users temp directory (%temp%) for files T1119_*.txt
to see what was collected.
",collection,T1119,Automated Collection
0c7c18db582bff4d0da4b4f8fdb2be49,atomic,Automated Collection PowerShell,"Automated Collection. Upon execution, check the users temp directory (%temp%) for the folder T1119_powershell_collection
to see what was collected.
",collection,T1119,Automated Collection
8cd2639cb742872b58a2356909628376,atomic,Compress Data for Exfiltration With PowerShell,"An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration.
When the test completes you should find the files from the $env:USERPROFILE directory compressed in a file called T1560-data-ps.zip in the $env:USERPROFILE directory 
",collection,T1560,Archive Collected Data
f6b9e50c4a887e5975ec058ff9ea56ae,atomic,Compress Data and lock with password for Exfiltration with 7zip,"Note: Requires 7zip installation
",collection,T1560.001,Archive Collected Data: Archive via Utility
582871bcbf9a88caed89ae25d76d018c,atomic,Windows Screencapture,"Use Psr.exe binary to collect screenshots of user display. Test will do left mouse click to simulate user behaviour
",collection,T1113,Screen Capture
64569d9eb87191fc3cbf365a656e31ab,atomic,Windows Screen Capture (CopyFromScreen),"Take a screen capture of the desktop through a call to the [Graphics.CopyFromScreen] .NET API.

[Graphics.CopyFromScreen]: https://docs.microsoft.com/en-us/dotnet/api/system.drawing.graphics.copyfromscreen
",collection,T1113,Screen Capture
7da5d03a766f4d6b2dbaf8a8a17d53ad,atomic,X Windows Capture,"Use xwd command to collect a full desktop screenshot and review file with xwud
",collection,T1113,Screen Capture
6bab3d3a468266765c4a6f3857243136,atomic,Compress Data and lock with password for Exfiltration with winzip,"Note: Requires winzip installation
wzzip sample.zip -s""blueblue"" *.txt (VARIANT)
",collection,T1560.001,Archive Collected Data: Archive via Utility
faea6af25bd5b3a0182f4a585af56554,atomic,Compressing data using zipfile in Python (Linux),"Uses zipfile from Python to compress files
",collection,T1560.002,Archive Collected Data: Archive via Library
f16438a836c9c466cc3d56cb0262fe3f,atomic,Stage data from Discovery.sh,"Utilize curl to download discovery.sh and execute a basic information gathering shell script
",collection,T1074.001,Data Staged: Local Data Staging
e8553d5d1077db444ab2bf2938b5fc5b,atomic,using Quicktime Player,"Use AppleScript to get Quicktime Player to record an audio file from the default microphone.

Should create a non-empty m4a file with sound from the microphone.

- requires Automation permissions but no additional microphone permissions
- saves file in /tmp by default. Other locations likely to require more permissions.
",collection,T1123,Audio Capture
abd5327a47c4994e2824f833eefe4250,atomic,Collect Clipboard Data via VBA,"This module copies the data stored in the user's clipboard and writes it to a file, $env:TEMP\atomic_T1115_clipboard_data.txt
",collection,T1115,Clipboard Data
2c79f238a874947ce287bd7f83e0fb9b,atomic,Encrypts collected data with AES-256 and Base64,"An adversary may compress all the collected data, encrypt and send them to a C2 server using base64 encoding. 
This atomic test tries to emulate the behaviour of the FLEXIROOT backdoor to archive the collected data. FLEXIROOT typically utilizes AES encryption and base64 encoding to transfer the encrypted data to the C2 server. 
In this test, standard zip compression and the OpenSSL library are used to encrypt the compressed data.
https://attack.mitre.org/versions/v7/software/S0267/",collection,T1560.001,Archive Collected Data: Archive via Utility
6f408258cabdeda38f81cfdc239fb6c0,atomic,Azure - Scan for Anonymous Access to Azure Storage (Powershell),"Upon successful execution, this test will test for anonymous access to Azure storage containers by invoking a web request and outputting the results to a file. 
The corresponding response could then be interpreted to determine whether or not the resource/container exists, as well as other information. 
See https://ninocrudele.com/the-three-most-effective-and-dangerous-cyberattacks-to-azure-and-countermeasures-part-2-attack-the-azure-storage-service     
",collection,T1530,Data from Cloud Storage Object
b87adfc0c92e77845da477f44a4d1944,atomic,Data Compressed - nix - tar Folder or File,"An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration. This test uses standard gzip compression.
",collection,T1560.001,Archive Collected Data: Archive via Utility
8495696b0a75577de442ba54bef343c1,atomic,Automated Collection Command Prompt,"Automated Collection. Upon execution, check the users temp directory (%temp%) for the folder T1119_command_prompt_collection
to see what was collected.
",collection,T1119,Automated Collection
760ad6f5fe8880dae1044a384c514ccd,atomic,Execute commands from clipboard,Echo a command to clipboard and execute it,collection,T1115,Clipboard Data
38a918787f583bb58b28ec495263d7b7,atomic,Compress Data and lock with password for Exfiltration with winrar,"Note: Requires winrar installation
rar a -p""blue"" hello.rar (VARIANT)
",collection,T1560.001,Archive Collected Data: Archive via Utility
8c0f619c7dfd33907bf20b1dfb58022b,atomic,Execute Commands from Clipboard using PowerShell,"Utilize PowerShell to echo a command to clipboard and execute it
",collection,T1115,Clipboard Data
5fab72013505efcd896475f9fe06c280,atomic,Capture Linux Desktop using Import Tool,"Use import command from ImageMagick to collect a full desktop screenshot
",collection,T1113,Screen Capture
70795de7cbb842edb029b3378c27c008,atomic,Utilize Clipboard to store or execute commands from,"Add data to clipboard to copy off or execute commands from.
",collection,T1115,Clipboard Data
ee00df65dba6910c97e7d910b948c6c5,atomic,Screencapture,"Use screencapture command to collect a full desktop screenshot
",collection,T1113,Screen Capture
fb0aa173a321f9fd643e94918ae415d8,atomic,Compressing data using tarfile in Python (Linux),"Uses tarfile from Python to compress files
",collection,T1560.002,Archive Collected Data: Archive via Library
7121cdf93b951311be9d7078c602efdc,atomic,Recon information for export with Command Prompt,"collect information for exfiltration. Upon execution, check the users temp directory (%temp%) for files T1119_*.txt
to see what was collected.
",collection,T1119,Automated Collection
47f3e8652525a485114b19e100bba352,atomic,Copy a sensitive File over Administive share with copy,"Copy from sensitive File from the c$ of another LAN computer with copy cmd
https://twitter.com/SBousseaden/status/1211636381086339073",collection,T1039,Data from Network Shared Drive
67a99afec9b560aa2b636e6d74c765f1,atomic,Screencapture (silent),"Use screencapture command to collect a full desktop screenshot
",collection,T1113,Screen Capture
c6c8a02a5633bdc9f887b94140a95934,atomic,Data Compressed - nix - zip,"An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration. This test uses standard zip compression.
",collection,,
00fd3b04d79d701df0900529c1006c62,atomic,Zip a Folder with PowerShell for Staging in Temp,"Use living off the land tools to zip a file and stage it in the Windows temporary folder for later exfiltration. Upon execution, Verify that a zipped folder named Folder_to_zip.zip
was placed in the temp directory.
",collection,T1074.001,Data Staged: Local Data Staging
617871022e40b752f362d831b4405b9c,atomic,Compressing data using bz2 in Python (Linux),"Uses bz2 from Python to compress files
",collection,T1560.002,Archive Collected Data: Archive via Library
a486bd42396e6e4680f908d4dfa18870,atomic,Email Collection with PowerShell Get-Inbox,"Search through local Outlook installation, extract mail, compress the contents, and saves everything to a directory for later exfiltration.
Successful execution will produce stdout message stating ""Please be patient, this may take some time..."". Upon completion, final output will be a mail.csv file.

Note: Outlook is required, but no email account necessary to produce artifacts.
",collection,T1114.001,Email Collection: Local Email Collection
071e2659937987a4a7c78baf7f4d59e8,atomic,Compressing data using GZip in Python (Linux),"Uses GZip from Python to compress files
",collection,T1560.002,Archive Collected Data: Archive via Library
e1aac34d578a19d68451a09a37e667ae,atomic,Copy a sensitive File over Administive share with Powershell,"Copy from sensitive File from the c$ of another LAN computer with powershell
https://twitter.com/SBousseaden/status/1211636381086339073",collection,T1039,Data from Network Shared Drive
4382d53f0f53399e72c728d019fffd77,atomic,Stage data from Discovery.bat,"Utilize powershell to download discovery.bat and save to a local file. This emulates an attacker downloading data collection tools onto the host. Upon execution,
verify that the file is saved in the temp directory.
",collection,T1074.001,Data Staged: Local Data Staging
3f92476875c5ba5acad424dbf15bce4d,atomic,Data Compressed - nix - gzip Single File,"An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration. This test uses standard gzip compression.
",collection,T1560.001,Archive Collected Data: Archive via Utility
2b00667c131aba669860a710213bbb88,atomic,AWS - Create a new IAM user,"Creates a new IAM user in AWS. Upon successful creation, a new user will be created. Adversaries create new IAM users so that their malicious activity do not interupt the normal functions of the compromised users and can remain undetected for a long time
",persistence,T1136.003,Create Account: Cloud Account
300ce4eae0a89518065bb58178c8703f,atomic,Web Shell Written to Disk,"This test simulates an adversary leveraging Web Shells by simulating the file modification to disk.
Idea from APTSimulator.
cmd.aspx source - https://github.com/tennc/webshell/blob/master/fuzzdb-webshell/asp/cmd.aspx
",persistence,T1505.003,Server Software Component: Web Shell
5542d8580c8a1380595d61f8c4095031,atomic,Install Outlook Home Page Persistence,"This test simulates persistence being added to a host via the Outlook Home Page functionality. This causes Outlook to retrieve URL containing a malicious payload every time the targeted folder is viewed.

Triggering the payload requires manually opening Outlook and viewing the targetted folder (e.g. Inbox).
",persistence,T1137.004,Office Application Startup: Outlook Home Page
b05d458f4fe87e5dce7f52987c89cdc8,atomic,AWS - Create Access Key and Secret Key,"Adversaries create their own new access and secret keys to programatically interact with AWS environment, which is already compromised
",persistence,T1098.001,Account Manipulation: Additional Cloud Credentials
e8c24e75714483eb3b526fc589a88f9a,atomic,Install IIS Module using PowerShell Cmdlet New-WebGlobalModule,"The following Atomic will utilize PowerShell Cmdlet New-WebGlobalModule to install a new IIS Module. IIS must be installed.
This atomic utilizes a DLL on disk, but to test further suspiciousness, compile and load [IIS-Raid](https://www.mdsec.co.uk/2020/02/iis-raid-backdooring-iis-using-native-modules/).
A successful execution will install a module into IIS using New-WebGlobalModule.
[Managing IIS Modules with PowerShell](https://learn.microsoft.com/en-us/powershell/module/webadministration/set-webglobalmodule?view=windowsserver2022-ps)
[IIS Modules](https://www.microsoft.com/en-us/security/blog/2022/12/12/iis-modules-the-evolution-of-web-shells-and-how-to-detect-them/)
",persistence,T1505.004,IIS Components
cbf44e79b4bef7b2e997508f759beee3,atomic,Azure - adding user to Azure role in subscription,"The adversaries want to add user to some Azure role, also called Azure resource role. Threat actor 
may be interested primarily in highly privileged roles, e.g. Owner, Contributor.
By default, the role Reader is assigned to user in this test.

New-AzRoleAssignment cmdlet could be also use to assign user/service principal to resource, resource group and management group.

The account you use to run the PowerShell command must have Microsoft.Authorization/roleAssignments/write 
(e.g. such as User Access Administrator or Owner) and the Azure Active Directory Graph Directory.Read.All 
and Microsoft Graph Directory.Read.All permissions.

Detection hint - check Operation Name ""Create role assignment"" in subscriptions Activity Logs.
",persistence,T1098,Account Manipulation
6edfb4431a2c7b2809ebf6d0a7a63bc5,atomic,AWS - Create a group and add a user to that group,"Adversaries create AWS group, add users to specific to that group to elevate their privilieges to gain more accesss
",persistence,T1098,Account Manipulation
bac18f187778e4202196ddd3c6041d31,atomic,Azure - adding service principal to Azure role in subscription,"The adversaries want to add service principal to some Azure role, also called Azure resource role. Threat actor 
may be interested primarily in highly privileged roles, e.g. Owner, Contributor.
By default, the role Reader is assigned to service principal in this test.

New-AzRoleAssignment cmdlet could be also use to assign user/service principal to resource, resource group and management group.

The account you use to run the PowerShell command must have Microsoft.Authorization/roleAssignments/write 
(e.g. such as User Access Administrator or Owner) and the Azure Active Directory Graph Directory.Read.All 
and Microsoft Graph Directory.Read.All permissions.

Detection hint - check Operation Name ""Create role assignment"" in subscriptions Activity Logs.
",persistence,T1098,Account Manipulation
b563c36cff8c0a66194dd5a4f1daa1be,atomic,Create a new account similar to ANONYMOUS LOGON,"Create a new account similar to ANONYMOUS LOGON in a command prompt.
",persistence,T1136.002,Create Account: Domain Account
20e4f555f0b87421c9e9ec83d99eb562,atomic,Azure AD - Create a new user,"Creates a new user in Azure AD. Upon successful creation, a new user will be created. Adversaries create new users so that their malicious activity does not interrupt the normal functions of the compromised users and can remain undetected for a long time.",persistence,T1136.003,Create Account: Cloud Account
7cd26e24cc23c5a7e1183120fa034f89,atomic,Simulate Patching termsrv.dll,"Simulates patching of termsrv.dll by making a benign change to the file and replacing it with the original afterwards.
Before we can make the modifications we need to take ownership of the file and grant ourselves the necessary permissions.
",persistence,T1505.005,Server Software Component: Terminal Services DLL
c17527c8e46c4a6f1622f61401735407,atomic,Azure AD Application Hijacking - App Registration,"Add a certificate to an Application through its App Registration. The certificate can then be used to authenticate as the application.
This can be used for persistence, and also for privilege escalation by benefiting from the Application's rights.
An account with high-enough Azure AD privileges is needed, such as Global Administrator or Application Administrator. The account authentication must be without MFA.
",persistence,T1098.001,Account Manipulation: Additional Cloud Credentials
9de217b5623080a6bc898c636b1e599d,atomic,Password Change on Directory Service Restore Mode (DSRM) Account,"Change the password on the Directory Service Restore Mode (DSRM) account using ntdsutil by syncing to existing account
",persistence,T1098,Account Manipulation
c736f0cee0c30c06095fedc05fa83912,atomic,Azure AD - adding service principal to Azure AD role,"The adversaries want to add service principal to some Azure AD role. Threat actor 
may be interested primarily in highly privileged roles, e.g. Global Administrator, Application Administrator, 
Privileged Authentication Administrator (this role can reset Global Administrator password!).
By default, the role Global Reader is assigned to service principal in this test.

The account you use to run the PowerShell command should have Privileged Role Administrator or Global Administrator role in your Azure AD.

Detection hint - check Activity ""Add member to role"" in Azure AD Audit Logs. In targer you will also see Service Principal as a type.
",persistence,T1098,Account Manipulation
8a95e17c084e9a8bf41c69c73beeb0af,atomic,Create a new Domain Account using PowerShell,"Creates a new Domain User using the credentials of the Current User
",persistence,T1136.002,Create Account: Domain Account
c6bf167afe0b85a1e88127fc0d093e4d,atomic,Create a new Windows domain admin user,"Creates a new domain admin user in a command prompt.
",persistence,T1136.002,Create Account: Domain Account
0c67915b076b2b044cedb3fe979f4c7e,atomic,Modify SSH Authorized Keys,"Modify contents of <user-home>/.ssh/authorized_keys to maintain persistence on victim host. 
If the user is able to save the same contents in the authorized_keys file, it shows user can modify the file.
",persistence,T1098.004,SSH Authorized Keys
5ceb5fd63b2cea41b66395f610aed024,atomic,Create a new Windows admin user,"Creates a new admin user in a command prompt.
",persistence,T1136.001,Create Account: Local Account
cbaeea20cd3e11d2bf3512f91b155410,atomic,Create a new user in Linux with `root` UID and GID.,"Creates a new user in Linux and adds the user to the `root` group. This technique was used by adversaries during the Butter attack campaign.
",persistence,T1136.001,Create Account: Local Account
ae8bd61cb6d10568145c87134e95c96f,atomic,Azure AD - adding user to Azure AD role,"The adversaries want to add user to some Azure AD role. Threat actor 
may be interested primarily in highly privileged roles, e.g. Global Administrator, Application Administrator, 
Privileged Authentication Administrator (this role can reset Global Administrator password!).
By default, the role Global Reader is assigned to the user principal in this test.

The account you use to run the PowerShell command should have Privileged Role Administrator or Global Administrator role in your Azure AD.

Detection hint - check Activity ""Add member to role"" in Azure AD Audit Logs. In targer you will also see User as a type.
",persistence,T1098,Account Manipulation
b3aef1cccb10fc2ecf00bc80646ef8fe,atomic,Domain Account and Group Manipulate,"Create a random atr-nnnnnnnn account and add it to a domain group (by default, Domain Admins). 

The quickest way to run it is against a domain controller, using `-Session` of `Invoke-AtomicTest`. Alternatively,
you need to install PS Module ActiveDirectory (in prereqs) and run the script with appropriare AD privileges to 
create the user and alter the group. Automatic installation of the dependency requires an elevated session, 
and is unlikely to work with Powershell Core (untested).

If you consider running this test against a production Active Directory, the good practise is to create a dedicated
service account whose delegation is given onto a dedicated OU for user creation and deletion, as well as delegated
as group manager of the target group.

Example: `Invoke-AtomicTest -Session $session 'T1098' -TestNames ""Domain Account and Group Manipulate"" -InputArgs @{""group"" = ""DNSAdmins"" }`
",persistence,T1098,Account Manipulation
a976d2bc6da0471ddf8e3583ce4f7ed7,atomic,Azure AD - Create a new user via Azure CLI,"Creates a new user in Azure AD via the Azure CLI. Upon successful creation, a new user will be created. Adversaries create new users so that their malicious activity does not interrupt the normal functions of the compromised users and can remain undetected for a long time.",persistence,T1136.003,Create Account: Cloud Account
1eef166892fd91bb46844c09f4165518,atomic,Azure AD Application Hijacking - Service Principal,"Add a certificate to an Application through its Service Principal. The certificate can then be used to authenticate as the application.
This can be used for persistence, and also for privilege escalation by benefiting from the Application's rights.
An account with high-enough Azure AD privileges is needed, such as Global Administrator or Application Administrator. The account authentication must be without MFA.
",persistence,T1098.001,Account Manipulation: Additional Cloud Credentials
778e76984e52af739eff58d6cce22f42,atomic,Admin Account Manipulate,"Manipulate Admin Account Name
",persistence,T1098,Account Manipulation
b00d08275bb2b3ef620e103b1fd7b9e4,atomic,Install MS Exchange Transport Agent Persistence,"Install a Microsoft Exchange Transport Agent for persistence. This requires execution from an Exchange Client Access Server and the creation of a DLL with specific exports. Seen in use by Turla.
More details- https://docs.microsoft.com/en-us/exchange/transport-agents-exchange-2013-help
",persistence,T1505.002,Server Software Component: Transport Agent
45c73c8b658b660da5cc7bb6207bc08f,atomic,Create a user account on a MacOS system,"Creates a user on a MacOS system with dscl
",persistence,T1136.001,Create Account: Local Account
c93df79781db0a1ed7cc34323f2ecec0,atomic,Create a new user in a command prompt,"Creates a new user in a command prompt. Upon execution, ""The command completed successfully."" will be displayed. To verify the
new account, run ""net user"" in powershell or CMD and observe that there is a new user named ""T1136.001_CMD""
",persistence,T1136.001,Create Account: Local Account
12ad9edefc86af07700fbf49bfdac6ba,atomic,Office Application Startup - Outlook as a C2,"As outlined in MDSEC's Blog post https://www.mdsec.co.uk/2020/11/a-fresh-outlook-on-mail-based-persistence/ 
it is possible to use Outlook Macro as a way to achieve persistance and execute arbitrary commands. This transform Outlook into a C2.
Too achieve this two things must happened on the syste
- The macro security registry value must be set to '4'
- A file called VbaProject.OTM must be created in the Outlook Folder.
",persistence,T1137,Office Application Startup
80d22fb154cc39b34d920f0855ce746e,atomic,Azure AD - adding permission to application,"The adversaries want to add permission to newly created application. Application could be then used for persistence or for further operation in the attacked infrastructure. Permissions like AppRoleAssignment.ReadWrite.All or RoleManagement.ReadWrite.Directory in particular can be a valuable target for a threat actor.
This technique will create a new app, with the provided name, and give it the provided permission. But if you prefer to add credentials to an existing app, replace in the code: ""Get-AzureADApplication"" instead of ""New-AzureADServicePrincipal"".
The DirectoryRecommendations.Read.All permissions has been selected as the default.

The account you use to run the PowerShell command should have Global Administrator/Application Administrator/Cloud Application Administrator role in your Azure AD.

Detection hint - check Operation Name ""Add app role assignment to service principal"" in subscriptions Activity Logs.
You can also take a look at the materials:
https://learnsentinel.blog/2022/01/04/azuread-privesc-sentinel/
https://github.com/reprise99/Sentinel-Queries
https://docs.google.com/presentation/d/1AWx1w0Xcq8ENvOmSjAJswEgEio-il09QWZlGg9PbHqE/edit#slide=id.g10460eb209c_0_2766
https://gist.github.com/andyrobbins/7c3dd62e6ed8678c97df9565ff3523fb
",persistence,T1098,Account Manipulation
231b7dd1e4747af98c35602340a1b6bf,atomic,Install IIS Module using AppCmd.exe,"The following Atomic will utilize AppCmd.exe to install a new IIS Module. IIS must be installed.
This atomic utilizes a DLL on disk, but to test further suspiciousness, compile and load [IIS-Raid](https://www.mdsec.co.uk/2020/02/iis-raid-backdooring-iis-using-native-modules/).
A successful execution will install a module into IIS using AppCmd.exe.
[Managing and installing Modules Reference](https://learn.microsoft.com/en-us/iis/get-started/introduction-to-iis/iis-modules-overview#to-install-a-module-using-appcmdexe)
[IIS Modules](https://www.microsoft.com/en-us/security/blog/2022/12/12/iis-modules-the-evolution-of-web-shells-and-how-to-detect-them/)
",persistence,T1505.004,IIS Components
f39aace719f4cdcf8569001f7a25aabf,atomic,Create a new user in PowerShell,"Creates a new user in PowerShell. Upon execution, details about the new account will be displayed in the powershell session. To verify the
new account, run ""net user"" in powershell or CMD and observe that there is a new user named ""T1136.001_PowerShell""
",persistence,T1136.001,Create Account: Local Account
d9eaee9a1d1851fa44d69442f0bb3fe0,atomic,Create a user account on a Linux system,"Create a user via useradd
",persistence,T1136.001,Create Account: Local Account
ba3554b0cfd41b45bf16250b9afb1cca,atomic,Mount host filesystem to escape privileged Docker container,"This technique abuses privileged Docker containers to mount the host's filesystem and then create a cron job to launch a reverse shell as the host's superuser.
The container running the test needs be privileged.  It may take up to a minute for this to run due to how often crond triggers a job.
Dev note: the echo to create cron_filename is broken up to prevent localized execution of hostname and id by Powershell. 
",privilege-escalation,T1611,Escape to Host
d55b419a683d8b328f8f8d01dfc08148,atomic,Deploy container using nsenter container escape,"In this escape `kubectl` is used to launch a new pod, with a container that has the host pids mapped into the container (`hostPID:true`). It uses the alpine linux container image. It runs with privilege on the host (`privileged:true`). When the container is launched the command `nsenter --mount=/proc/1/ns/mnt -- /bin/bash` is ran. Since the host processes have been mapped into the container, the container enters the host namespace, escaping the container.

Additional Details:
- https://twitter.com/mauilion/status/1129468485480751104
- https://securekubernetes.com/scenario_2_attack/
",privilege-escalation,T1611,Escape to Host
fb5a68924b414467360a1a3550bd0fa2,atomic,Windows - Stop service by killing process,"Stops a specified service killng the service's process.
This technique was used by WannaCry. Upon execution, if the spoolsv service was running ""SUCCESS: The process ""spoolsv.exe"" with PID 2316 has been terminated.""
will be displayed. If the service was not running ""ERROR: The process ""spoolsv.exe"" not found."" will be displayed and it can be
started by running the cleanup command.
",impact,T1489,Service Stop
10971624ef3e693f52e8f526fdc26f5f,atomic,Reboot System via `halt` - Linux,"This test restarts a Linux system using `halt`.
",impact,T1529,System Shutdown/Reboot
c3f187080c141397bf8af092c44697a7,atomic,Azure AD - Delete user via Azure CLI,"Deletes a user in Azure AD. Adversaries may interrupt availability of system and network resources by inhibiting access to accounts utilized by legitimate users. Accounts may be deleted, locked, or manipulated (excluding changed credentials) to remove access to accounts.",impact,T1531,Account Access Removal
c1bc47341136e6562c6f5c321a893374,atomic,Delete User via dscl utility,"This test deletes the user account using the dscl utility.
",impact,T1531,Account Access Removal
17be2b5f2b1dd2d7dd2eb1a63aecdeee,atomic,Logoff System - Windows,"This test performs a Windows system logoff as seen in [dcrat backdoor capabilities](https://www.mandiant.com/resources/analyzing-dark-crystal-rat-backdoor)
",impact,T1529,System Shutdown/Reboot
8429e707230a826e7213a51acd219a51,atomic,Delete User - Windows,"Deletes a user account to prevent access. Upon execution, run the command ""net user"" to verify that the new ""AtomicUser"" account was deleted.
",impact,T1531,Account Access Removal
c156ac5c9fa67080365268d95f29053d,atomic,Windows - Delete Volume Shadow Copies via WMI,"Deletes Windows Volume Shadow Copies via WMI. This technique is used by numerous ransomware families and APT malware such as Olympic Destroyer.
Shadow copies can only be created on Windows server or Windows 8.
",impact,T1490,Inhibit System Recovery
be4801446e4452c2a3e53dbe57c7a365,atomic,Encrypt files using openssl (Linux),"Uses openssl to encrypt a file
",impact,T1486,Data Encrypted for Impact
752f0b88233950aee6c1c249e89ee941,atomic,Encrypt files using ccrypt (Linux),"Attempts to encrypt data on target systems as root to simulate an inturruption authentication to target system. If root permissions are not available then attempts to encrypt data within user's home directory.
",impact,T1486,Data Encrypted for Impact
61a3e3faa588f1946a659139d6fd7a18,atomic,Windows - Stop service using net.exe,"Stops a specified service using the net.exe command. Upon execution, if the service was running ""The Print Spooler service was stopped successfully.""
will be displayed. If the service was not running, ""The Print Spooler service is not started."" will be displayed and it can be
started by running the cleanup command.
",impact,T1489,Service Stop
9e5e4c0655fd1b5be88bd40b8251175f,atomic,Windows - wbadmin Delete Windows Backup Catalog,"Deletes Windows Backup Catalog. This technique is used by numerous ransomware families and APT malware such as Olympic Destroyer. Upon execution,
""The backup catalog has been successfully deleted."" will be displayed in the PowerShell session.
",impact,T1490,Inhibit System Recovery
e2a0dedb06b65b649f077c8e7e3f0d68,atomic,Reboot System via `poweroff` - Linux,"This test restarts a Linux system using `poweroff`.
",impact,T1529,System Shutdown/Reboot
8467c994685ccf178db166964bd80fab,atomic,Windows - Disable Windows Recovery Console Repair,"Disables repair by the Windows Recovery Console on boot. This technique is used by numerous ransomware families and APT malware such as Olympic Destroyer.
Upon execution, ""The operation completed successfully."" will be displayed in the powershell session.
",impact,T1490,Inhibit System Recovery
a3035e1a84301ca2ab38a7d966cce6b7,atomic,Encrypt files using gpg (Linux),"Uses gpg to encrypt a file
",impact,T1486,Data Encrypted for Impact
90adc98ddf396bb7cb3b90a1f090a0e0,atomic,Replace Desktop Wallpaper,"Downloads an image from a URL and sets it as the desktop wallpaper.
",impact,T1491.001,Defacement: Internal Defacement
617ea9a1ca1df0d88fe31919dfbcdc90,atomic,Restart System - Windows,"This test restarts a Windows system.
",impact,T1529,System Shutdown/Reboot
c8f329d2847ede593b6cb4a1ec6120fb,atomic,Disable System Restore Through Registry,"Modify the registry of the currently logged in user using reg.exe via cmd console to disable system restore on the computer. 
See how remcos RAT abuses this technique- https://www.virustotal.com/gui/file/2d7855bf6470aa323edf2949b54ce2a04d9e38770f1322c3d0420c2303178d91/details
",impact,T1490,Inhibit System Recovery
870fe83b763d6cb8c2edc46112250bb6,atomic,Shutdown System - Windows,"This test shuts down a Windows system.
",impact,T1529,System Shutdown/Reboot
2fc2e45dde68ab78a97a22ca138652e1,atomic,Configure LegalNoticeCaption and LegalNoticeText registry keys to display ransom message,"Display ransom message to users at system start-up by configuring registry keys HKLM\SOFTWARE\Micosoft\Windows\CurrentVersion\Policies\System\LegalNoticeCaption and HKLM\SOFTWARE\Micosoft\Windows\CurrentVersion\Policies\System\LegalNoticeText.

[SynAck Ransomware](https://www.trendmicro.com/vinfo/es/security/news/cybercrime-and-digital-threats/synack-ransomware-leverages-process-doppelg-nging-for-evasion-and-infection), 
[Grief Ransomware](https://redcanary.com/blog/grief-ransomware/), 
[Maze Ransomware](https://cyware.com/research-and-analysis/maze-ransomware-a-deadly-combination-of-data-theft-and-encryption-to-target-us-organizations-8f27),
[Pysa Ransomware](https://www.cybereason.com/blog/research/threat-analysis-report-inside-the-destructive-pysa-ransomware),
[Spook Ransomware](https://community.fortinet.com/t5/FortiEDR/Threat-Coverage-How-FortiEDR-protects-against-Spook-Ransomware/ta-p/204226),
[DopplePaymer Ransomware](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Ransom:Win32/Dopplepaymer&threatId=-2147221958),
[Reedemer Ransomware](https://blog.cyble.com/2022/07/20/redeemer-ransomware-back-action/),
[Kangaroo Ransomware](https://www.bleepingcomputer.com/news/security/the-kangaroo-ransomware-not-only-encrypts-your-data-but-tries-to-lock-you-out-of-windows/)
",impact,T1491.001,Defacement: Internal Defacement
8af540e33bedd20ad6122751d2c996a2,atomic,Windows - wbadmin Delete systemstatebackup,"Deletes the Windows systemstatebackup using wbadmin.exe. This technique is used by numerous ransomware families. This may only be successful on server platforms that have Windows Backup enabled.
",impact,T1490,Inhibit System Recovery
5a9a7d8b4f632652c3ed175c071c5c7a,atomic,Windows - Delete Backup Files,"Deletes backup files in a manner similar to Ryuk ransomware. Upon exection, many ""access is denied"" messages will appear as the commands try
to delete files from around the system.
",impact,T1490,Inhibit System Recovery
2edd8c0ae5c3fe1e732a58e60bdc4f08,atomic,Data Encrypted with GPG4Win,Gpg4win is a Windows tool (also called Kleopatra which is the preferred certificate manager) that uses email and file encryption packages for symmetric encryption. It is used by attackers to encrypt disks. User will need to add pass phrase to encrypt file as automation is not allowed under newer versions.,impact,T1486,Data Encrypted for Impact
2d53d6fabd39bf9c70b0dfcdfbbc926d,atomic,Windows - Disable the SR scheduled task,"Use schtasks.exe to disable the System Restore (SR) scheduled task
",impact,T1490,Inhibit System Recovery
66f19707907a88df172057c131ae2168,atomic,Overwrite deleted data on C drive,"RansomEXX malware removes all deleted files using windows built-in cipher.exe to prevent forensic recover.
This process is very slow and test execution may timeout. 
https://www.cybereason.com/blog/cybereason-vs.-ransomexx-ransomware
https://support.microsoft.com/en-us/topic/cipher-exe-security-tool-for-the-encrypting-file-system-56c85edd-85cf-ac07-f2f7-ca2d35dab7e4
",impact,T1485,Data Destruction
0e5730f670555b9dba829f3d90cbd445,atomic,Change User Password via passwd,"This test changes the user password to hinder access to the account using passwd utility.
",impact,T1531,Account Access Removal
0672185d22612c95792d39efab04ba17,atomic,Encrypt files using 7z (Linux),"Uses 7z to encrypt a file
",impact,T1486,Data Encrypted for Impact
f7e779369b3f0cff24152d7dd94eca98,atomic,Change User Password - Windows,"Changes the user password to hinder access attempts. Seen in use by LockerGoga. Upon execution, log into the user account ""AtomicAdministrator"" with
the password ""HuHuHUHoHo283283"".
",impact,T1531,Account Access Removal
0c87d07c3de3863cd0390de213cd6379,atomic,Delete User via sysadminctl utility,"This test deletes the user account using the sysadminctl utility.
",impact,T1531,Account Access Removal
25bab84a1a63926a7cf7f56e4029ef15,atomic,Restart System via `shutdown` - macOS/Linux,"This test restarts a macOS/Linux system.
",impact,T1529,System Shutdown/Reboot
153905affadb36241ced3d3b12ba0481,atomic,Windows - Delete Volume Shadow Copies,"Deletes Windows Volume Shadow Copies. This technique is used by numerous ransomware families and APT malware such as Olympic Destroyer. Upon
execution, if no shadow volumes exist the message ""No items found that satisfy the query."" will be displayed. If shadow volumes are present, it
will delete them without printing output to the screen. This is because the /quiet parameter was passed which also suppresses the y/n
confirmation prompt. Shadow copies can only be created on Windows server or Windows 8.

https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc788055(v=ws.11)
",impact,T1490,Inhibit System Recovery
5f407c31b29d92be4648b3cff37e0abe,atomic,macOS/Linux - Simulate CPU Load with Yes,"This test simulates a high CPU load as you might observe during cryptojacking attacks.
End the test by using CTRL/CMD+C to break.
",impact,T1496,Resource Hijacking
6b666245c021b73f91449ae08a581eaf,atomic,Windows - Stop service using Service Controller,"Stops a specified service using the sc.exe command. Upon execution, if the spooler service was running infomration will be displayed saying
it has changed to a state of STOP_PENDING. If the spooler service was not running ""The service has not been started."" will be displayed and it can be
started by running the cleanup command.
",impact,T1489,Service Stop
991b57c6ea9ab986d904928e57c5163a,atomic,Shutdown System via `halt` - Linux,"This test shuts down a Linux system using `halt`.
",impact,T1529,System Shutdown/Reboot
7b782764b73290661c9fe187a3a92a12,atomic,Windows - Overwrite file with Sysinternals SDelete,"Overwrites and deletes a file using Sysinternals SDelete. Upon successful execution, ""Files deleted: 1"" will be displayed in
the powershell session along with other information about the file that was deleted.
",impact,T1485,Data Destruction
e90756bb6dcd21462dc4cc452661df91,atomic,Windows - Delete Volume Shadow Copies via WMI with PowerShell,"Deletes Windows Volume Shadow Copies with PowerShell code and Get-WMIObject.
This technique is used by numerous ransomware families such as Sodinokibi/REvil.
Executes Get-WMIObject. Shadow copies can only be created on Windows server or Windows 8, so upon execution
there may be no output displayed.
",impact,T1490,Inhibit System Recovery
2cc4d863d4b7c634e8b6add14cf8c7a4,atomic,macOS/Linux - Overwrite file with DD,"Overwrites and deletes a file using DD.
To stop the test, break the command with CTRL/CMD+C.
",impact,T1485,Data Destruction
3f71c3360964b1a8c81618eb963c05f9,atomic,Remove Account From Domain Admin Group,"This test will remove an account from the domain admins group
",impact,T1531,Account Access Removal
e1ba582a3787829bb7f146009a040c8b,atomic,Azure AD - Delete user via Azure AD PowerShell,"Deletes a user in Azure AD. Adversaries may interrupt availability of system and network resources by inhibiting access to accounts utilized by legitimate users. Accounts may be deleted, locked, or manipulated (excluding changed credentials) to remove access to accounts.",impact,T1531,Account Access Removal
e7defb71a411a050c650ab0901520109,atomic,Shutdown System via `shutdown` - macOS/Linux,"This test shuts down a macOS/Linux system using a halt.
",impact,T1529,System Shutdown/Reboot
d82ceb9939d3d920ee550187ad8235c8,atomic,PureLocker Ransom Note,"building the IOC (YOUR_FILES.txt) for the PureLocker ransomware 
https://www.bleepingcomputer.com/news/security/purelocker-ransomware-can-lock-files-on-windows-linux-and-macos/
",impact,T1486,Data Encrypted for Impact
9c179dc2e0bea7b2340e92c574926fc2,atomic,Restart System via `reboot` - macOS/Linux,"This test restarts a macOS/Linux system via `reboot`.
",impact,T1529,System Shutdown/Reboot
c17af196907f72450ed545de754fee45,atomic,Shutdown System via `poweroff` - Linux,"This test shuts down a Linux system using `poweroff`.
",impact,T1529,System Shutdown/Reboot
53861bc51eb67cb9775c95b9e02ad141,atomic,Enumerate PlugNPlay Camera,"Enumerate PlugNPlay Camera using powershell commandlet. this technique was seen in dcrat malware backdoor capabilities where it enumerate the camera info mounted on the compromised host. reference: https://www.mandiant.com/resources/analyzing-dark-crystal-rat-backdoor
",reconnaissance,T1592.001,Gather Victim Host Information: Hardware
2ebdab5e06cbf1f321c85b0fc6ce1dfb,atomic,Netcat C2,"Start C2 Session Using Ncat
To start the listener on a Linux device, type the following: 
nc -l -p <port>
",command-and-control,T1095,Non-Application Layer Protocol
148563e9c9fb2aaf64c617b2302d4c56,atomic,OSTAP Worming Activity,"OSTap copies itself in a specfic way to shares and secondary drives. This emulates the activity.
",command-and-control,T1105,Ingress Tool Transfer
371c8a9f96a5feb709658bf9933592d4,atomic,NetSupport - RAT Execution,"A recent trend by threat actors, once a foothold is established, maintain long term persistence using third party remote services such as NetSupport to provide the operator with access to the network using legitimate services. 
",command-and-control,T1219,Remote Access Software
b0e28215c59037cc6cdb61b38615c32d,atomic,File Download via PowerShell,"Use PowerShell to download and write an arbitrary file from the internet. Example is from the 2021 Threat Detection Report by Red Canary.
",command-and-control,T1105,Ingress Tool Transfer
2443f86c5b3067f3c3fda59384c566b6,atomic,sftp remote file copy (pull),"Utilize sftp to perform a remote file copy (pull)
",command-and-control,T1105,Ingress Tool Transfer
a546abab3fca70dd49036e96d8e8dee3,atomic,DNS over HTTPS Long Domain Query,"This test simulates an infected host returning data to a command and control server using long domain names.
The simulation involves sending DoH queries that gradually increase in length until reaching the maximum length. The intent is to test the effectiveness of detection of DoH queries for long domain names over a set threshold.
 Upon execution, DNS information about the domain will be displayed for each callout in a JSON format.
",command-and-control,T1572,Protocol Tunneling
e6715e61f5df646692c624b3499384c4,atomic,svchost writing a file to a UNC path,"svchost.exe writing a non-Microsoft Office file to a file with a UNC path.
Upon successful execution, this will rename cmd.exe as svchost.exe and move it to `c:\`, then execute svchost.exe with output to a txt file.
",command-and-control,T1105,Ingress Tool Transfer
9b34fc9731b75debb71fc7a0101a03ad,atomic,Lolbas replace.exe use to copy UNC file,"Copy UNC file to destination
Reference: https://lolbas-project.github.io/lolbas/Binaries/Replace/
",command-and-control,T1105,Ingress Tool Transfer
a43fdf7e96a3485431f079491056766c,atomic,Download a file using wscript,Use wscript to run a local VisualBasic file to download a remote file,command-and-control,T1105,Ingress Tool Transfer
a17ba4dfbcf9117ba3fcb935ff91f49c,atomic,Tor Proxy Usage - Debian/Ubuntu,"This test is designed to launch the tor proxy service, which is what is utilized in the background by the Tor Browser and other applications with add-ons in order to provide onion routing functionality.
Upon successful execution, the tor proxy service will be launched. 
",command-and-control,,
69b202bf0bb7b4ff43d4abb8867c1784,atomic,DNS over HTTPS Large Query Volume,"This test simulates an infected host sending a large volume of DoH queries to a command and control server.
The intent of this test is to trigger threshold based detection on the number of DoH queries either from a single source system or to a single targe domain.
A custom domain and sub-domain will need to be passed as input parameters for this test to work. Upon execution, DNS information about the domain will be displayed for each callout in a JSON format.
",command-and-control,T1572,Protocol Tunneling
15d7ca52df3177e60fbd8a9c8ab66719,atomic,Download a File with Windows Defender MpCmdRun.exe,"Uses Windows Defender MpCmdRun.exe to download a file from the internet (must have version 4.18 installed).
The input arguments ""remote_file"" and ""local_path"" can be used to specify the download URL and the name of the output file.
By default, the test downloads the Atomic Red Team license file to the temp directory.

More info and how to find your version can be found here https://lolbas-project.github.io/lolbas/Binaries/MpCmdRun/
",command-and-control,T1105,Ingress Tool Transfer
981cf81e3bb0649fafc31217c8cbc00d,atomic,Powercat C2,"Start C2 Session Using Powercat
To start the listener on a Linux device, type the following: 
nc -l -p <port>
",command-and-control,T1095,Non-Application Layer Protocol
af4bcca1e12279e4b6388cefcf40b190,atomic,Malicious User Agents - CMD,"This test simulates an infected host beaconing to command and control. Upon execution, no out put will be displayed. 
Use an application such as Wireshark to record the session and observe user agent strings and responses.

Inspired by APTSimulator - https://github.com/NextronSystems/APTSimulator/blob/master/test-sets/command-and-control/malicious-user-agents.bat
",command-and-control,T1071.001,Application Layer Protocol: Web Protocols
bda00f459bb9118c4c88de426055e180,atomic,DNS C2,"This will attempt to start a C2 session using the DNS protocol. You will need to have a listener set up and create DNS records prior to executing this command.
The following blogs have more information.

https://github.com/iagox86/dnscat2

https://github.com/lukebaggett/dnscat2-powershell
",command-and-control,T1071.004,Application Layer Protocol: DNS
866227c57aaeb1e0e9d761e15fc29e44,atomic,rsync remote file copy (push),"Utilize rsync to perform a remote file copy (push)
",command-and-control,T1105,Ingress Tool Transfer
10b46b4b36e03efea62ea69331623358,atomic,UltraViewer - RAT Execution,"A recent trend by threat actors, once a foothold is established, maintain long term persistence using third party remote services such as UltraViewer to provide the operator with access to the network using legitimate services. 
",command-and-control,T1219,Remote Access Software
a88b5c13a1d5d6bdf02b66bc73411f41,atomic,Windows - PowerShell Download,"This test uses PowerShell to download a payload.
This technique is used by multiple adversaries and malware families.
",command-and-control,T1105,Ingress Tool Transfer
bd6226bd86cbcd3e083f997194d66372,atomic,Testing usage of uncommonly used port,"Testing uncommonly used port utilizing telnet.
",command-and-control,T1571,Non-Standard Port
04d923d1b722004f912afca5635cd518,atomic,Curl Download File,"The following Atomic utilizes native curl.exe, or downloads it if not installed, to download a remote DLL and output to a number of directories to simulate malicious behavior.
Expected output will include whether the file downloaded successfully or not.
",command-and-control,T1105,Ingress Tool Transfer
50a319ee67cdb786e6207194c8d61c72,atomic,rsync remote file copy (pull),"Utilize rsync to perform a remote file copy (pull)
",command-and-control,T1105,Ingress Tool Transfer
aada5380e7d0a4c7b71f2a324d9d5327,atomic,AnyDesk Files Detected Test on Windows,"An adversary may attempt to trick the user into downloading AnyDesk and use to establish C2. Download of AnyDesk installer will be at the destination location and ran when sucessfully executed.
",command-and-control,T1219,Remote Access Software
d9acc651d3e778f0c04700a00f52d52c,atomic,DNS Long Domain Query,"This test simulates an infected host returning data to a command and control server using long domain names.
The simulation involves sending DNS queries that gradually increase in length until reaching the maximum length. The intent is to test the effectiveness of detection of DNS queries for long domain names over a set threshold.
 Upon execution, DNS information about the domain will be displayed for each callout.
",command-and-control,T1071.004,Application Layer Protocol: DNS
920b95f39d124c8a9e7342d88bd54516,atomic,DNS Large Query Volume,"This test simulates an infected host sending a large volume of DNS queries to a command and control server.
The intent of this test is to trigger threshold based detection on the number of DNS queries either from a single source system or to a single targe domain.
A custom domain and sub-domain will need to be passed as input parameters for this test to work. Upon execution, DNS information about the domain will be displayed for each callout.
",command-and-control,T1071.004,Application Layer Protocol: DNS
f8beff0e35ecdb7cfea66d289bc77b5a,atomic,Curl Upload File,"The following Atomic utilizes native curl.exe, or downloads it if not installed, to upload a txt file to simulate data exfiltration
Expected output will include whether the file uploaded successfully or not.
",command-and-control,T1105,Ingress Tool Transfer
9332aff267b00ede37b09606340ee1dc,atomic,ScreenConnect Application Download and Install on Windows,"An adversary may attempt to trick the user into downloading ScreenConnect for use as a C2 channel. Download of ScreenConnect installer will be in the Downloads directory.
Msiexec will be used to quietly insall ScreenConnect.
",command-and-control,T1219,Remote Access Software
5897806f5beb75a30356063c17f58f49,atomic,Nimgrab - Transfer Files,"Use nimgrab.exe to download a file from the web. 
",command-and-control,T1105,Ingress Tool Transfer
08c16e90b1f129f1219361ab95b54f93,atomic,Ammyy Admin Software Execution,"An adversary may attempt to trick the user into downloading Ammyy Admin Remote Desktop Software for use as a C2 channel. 
Upon successful execution, Ammyy Admin will be executed. 
",command-and-control,T1219,Remote Access Software
1daded6839d3954bf7d12b34eb36a1b3,atomic,certutil download (urlcache),"Use certutil -urlcache argument to download a file from the web. Note - /urlcache also works!
",command-and-control,T1105,Ingress Tool Transfer
fb827394b296192cb7a81031a2e37ae2,atomic,OpenSSL C2,"Thanks to @OrOneEqualsOne for this quick C2 method.
This is to test to see if a C2 session can be established using an SSL socket.
More information about this technique, including how to set up the listener, can be found here:
https://medium.com/walmartlabs/openssl-server-reverse-shell-from-windows-client-aee2dbfa0926

Upon successful execution, powershell will make a network connection to 127.0.0.1 over 443.
",command-and-control,T1573,Encrypted Channel
087b39642aeab378db9c474ce07e1b4e,atomic,Lolbas replace.exe use to copy file,"Copy file.cab to destination
Reference: https://lolbas-project.github.io/lolbas/Binaries/Replace/
",command-and-control,T1105,Ingress Tool Transfer
7262a40d1253cb58b4e54fc1aacc938a,atomic,File download with finger.exe on Windows,"Simulate a file download using finger.exe. Connect to localhost by default, use custom input argument to test finger connecting to an external server.
Because this is being tested on the localhost, you should not be expecting a successful connection
https://www.exploit-db.com/exploits/48815
https://www.bleepingcomputer.com/news/security/windows-10-finger-command-can-be-abused-to-download-or-steal-files/
",command-and-control,T1105,Ingress Tool Transfer
62aff7e142552ec146d8cd9146f191d5,atomic,GoToAssist Files Detected Test on Windows,"An adversary may attempt to trick the user into downloading GoToAssist and use to establish C2. Download of GoToAssist installer will be at the destination location and ran when sucessfully executed.
",command-and-control,T1219,Remote Access Software
acca08a5361f1b4aee26128810327533,atomic,Psiphon,"Psiphon 3 is a circumvention tool from Psiphon Inc. that utilizes VPN, SSH and HTTP Proxy technology to provide you
with uncensored access to Internet.
This process will launch Psiphon 3 and establish a connection. Shortly after it will be shut down via process kill commands.
More information can be found about Psiphon using the following urls
http://s3.amazonaws.com/0ubz-2q11-gi9y/en.html
https://psiphon.ca/faq.html
",command-and-control,T1090.003,Proxy: Multi-hop Proxy
253e8dc2d0195de95eae8e9ec7e350a9,atomic,whois file download,"Download a remote file using the whois utility
",command-and-control,T1105,Ingress Tool Transfer
13286011c4ad0d577bccb6a85a13982a,atomic,UltraVNC Execution,"An adversary may attempt to trick the user into downloading UltraVNC for use as a C2 channel.
Upon successful execution, UltraVNC will be executed.
",command-and-control,T1219,Remote Access Software
04d33ddae0126966ae6d841267c17329,atomic,Download a file with IMEWDBLD.exe,"Use IMEWDBLD.exe (built-in to windows) to download a file. This will throw an error for an invalid dictionary file.
Downloaded files can be found in ""%LocalAppData%\Microsoft\Windows\INetCache\<8_RANDOM_ALNUM_CHARS>/<FILENAME>[1].<EXTENSION>"" or `%LocalAppData%\Microsoft\Windows\INetCache\IE\<8_RANDOM_ALNUM_CHARS>/<FILENAME>[1].<EXTENSION>.
Run ""Get-ChildItem -Path C:\Users\<USERNAME>\AppData\Local\Microsoft\Windows\INetCache\ -Include <FILENAME>* -Recurse -Force -File -ErrorAction SilentlyContinue"" without quotes and adding the correct username and file name to locate the file.
",command-and-control,T1105,Ingress Tool Transfer
f58b975c94224c4d5f8a28c0744109c3,atomic,DNS Regular Beaconing,"This test simulates an infected host beaconing via DNS queries to a command and control server at regular intervals over time.
This behaviour is typical of implants either in an idle state waiting for instructions or configured to use a low query volume over time to evade threshold based detection.
A custom domain and sub-domain will need to be passed as input parameters for this test to work. Upon execution, DNS information about the domain will be displayed for each callout.
",command-and-control,T1071.004,Application Layer Protocol: DNS
9ed218029d8392d2b4fdedd0f44bb052,atomic,ICMP C2,"This will attempt to  start C2 Session Using ICMP. For information on how to set up the listener
refer to the following blog: https://www.blackhillsinfosec.com/how-to-c2-over-icmp/
",command-and-control,T1095,Non-Application Layer Protocol
f50ec080343f1bec4e739dd20675c349,atomic,TeamViewer Files Detected Test on Windows,"An adversary may attempt to trick the user into downloading teamviewer and using this to maintain access to the machine. Download of TeamViewer installer will be at the destination location when sucessfully executed.
",command-and-control,T1219,Remote Access Software
3d331538a65d7ebee865a1906f729bad,atomic,Linux Download File and Run,"Utilize linux Curl to download a remote file, chmod +x it and run it.
",command-and-control,T1105,Ingress Tool Transfer
2f872c3c1107218205093c16a8cb6d66,atomic,scp remote file copy (push),"Utilize scp to perform a remote file copy (push)
",command-and-control,T1105,Ingress Tool Transfer
8c88994e55a53a5f85b75ecded495ab0,atomic,Tor Proxy Usage - MacOS,"This test is designed to launch the tor proxy service, which is what is utilized in the background by the Tor Browser and other applications with add-ons in order to provide onion routing functionality.
Upon successful execution, the tor proxy service will be launched. 
",command-and-control,T1090.003,Proxy: Multi-hop Proxy
e3dac029090c397b775979ddb50fc30f,atomic,Connection Proxy,"Enable traffic redirection.

Note that this test may conflict with pre-existing system configuration.
",command-and-control,T1090.001,Proxy: Internal Proxy
810ebb2d039e78c1017dcb5efbd4a074,atomic,Malicious User Agents - Nix,"This test simulates an infected host beaconing to command and control.
Inspired by APTSimulator - https://github.com/NextronSystems/APTSimulator/blob/master/test-sets/command-and-control/malicious-user-agents.bat
",command-and-control,T1071.001,Application Layer Protocol: Web Protocols
68f09bfb5a5a28c11608d106eac63abd,atomic,Windows - BITSAdmin BITS Download,"This test uses BITSAdmin.exe to schedule a BITS job for the download of a file.
This technique is used by Qbot malware to download payloads.
",command-and-control,T1105,Ingress Tool Transfer
5fd6b6b635191898a202dc7c21aa6068,atomic,XOR Encoded data.,"XOR encodes the data with a XOR key.
Reference - https://gist.github.com/loadenmb/8254cee0f0287b896a05dcdc8a30042f
",command-and-control,T1132.001,Data Encoding: Standard Encoding
806814854866002bd861b76b7a2ee2c9,atomic,sftp remote file copy (push),"Utilize sftp to perform a remote file copy (push)
",command-and-control,T1105,Ingress Tool Transfer
51e07e3ad45919d52901a7a06646ae91,atomic,DNS over HTTPS Regular Beaconing,"This test simulates an infected host beaconing via DoH queries to a command and control server at regular intervals over time.
This behaviour is typical of implants either in an idle state waiting for instructions or configured to use a low query volume over time to evade threshold based detection.
A custom domain and sub-domain will need to be passed as input parameters for this test to work. Upon execution, DNS information about the domain will be displayed for each callout in a JSON format.
",command-and-control,T1572,Protocol Tunneling
060cb51c43467792396a7ba1e9ed087b,atomic,Printer Migration Command-Line Tool UNC share folder into a zip file,"Create a ZIP file from a folder in a remote drive
",command-and-control,T1105,Ingress Tool Transfer
f4e6b028e9c60c515541d52921fa2b48,atomic,scp remote file copy (pull),"Utilize scp to perform a remote file copy (pull)
",command-and-control,T1105,Ingress Tool Transfer
f1b3fca18d7465cd10e5a7477a3bf97d,atomic,LogMeIn Files Detected Test on Windows,"An adversary may attempt to trick the user into downloading LogMeIn and use to establish C2. Download of LogMeIn installer will be at the destination location and ran when sucessfully executed.
",command-and-control,T1219,Remote Access Software
d5c3d4d3a33600ba963db53932e355f7,atomic,Base64 Encoded data.,"Utilizing a common technique for posting base64 encoded data.
",command-and-control,T1132.001,Data Encoding: Standard Encoding
7a3cf53858c519cfc11eff3c7b813ac9,atomic,Tor Proxy Usage - Windows,"This test is designed to launch the tor proxy service, which is what is utilized in the background by the Tor Browser and other applications with add-ons in order to provide onion routing functionality.
Upon successful execution, the tor proxy will be launched, run for 60 seconds, and then exit. 
",command-and-control,T1090.003,Proxy: Multi-hop Proxy
2ed8948f1c1156af47d50379e7965d90,atomic,certutil download (verifyctl),"Use certutil -verifyctl argument to download a file from the web. Note - /verifyctl also works!
",command-and-control,T1105,Ingress Tool Transfer
c9b955a568daf19171ce87c25c7fd24c,atomic,Connection Proxy for macOS UI,"Enable traffic redirection on macOS UI (not terminal).
The test will modify and enable the ""Web Proxy"" and ""Secure Web Proxy"" settings  in System Preferences => Network => Advanced => Proxies for the specified network interface.

Note that this test may conflict with pre-existing system configuration.
",command-and-control,T1090.001,Proxy: Internal Proxy
a268a831389fc0be60eefa838ccf80e0,atomic,certreq download,Use certreq to download a file from the web,command-and-control,T1105,Ingress Tool Transfer
552e8cf1f7fdc83d9ecf2c1bf22cf51a,atomic,Download a file with Microsoft Connection Manager Auto-Download,"Uses the cmdl32 to download arbitrary file from the internet. The cmdl32 package is allowed to install the profile used to launch the VPN connection. However, the config is modified to download the arbitary file. 
The issue of cmdl32.exe detecting and deleting the payload by identifying it as not a VPN Servers profile is avoided by setting a temporary TMP folder and denying the delete permission to all files for the user.
Upon successful execution the test will open calculator and Notepad executable for 10 seconds.
reference:
https://twitter.com/ElliotKillick/status/1455897435063074824
https://github.com/LOLBAS-Project/LOLBAS/pull/151
https://lolbas-project.github.io/lolbas/Binaries/Cmdl32/
https://strontic.github.io/xcyclopedia/library/cmdl32.exe-FA1D5B8802FFF4A85B6F52A52C871BBB.html
",command-and-control,T1105,Ingress Tool Transfer
0a4318388a85274588de8a60688c622f,atomic,MSP360 Connect Execution,"An adversary may attempt to trick the user into downloading MSP360 Connect for use as a C2 channel.
Upon successful execution, MSP360 Connect will be executed.
",command-and-control,T1219,Remote Access Software
b944f7b8548f3a3c8036f1b55324f881,atomic,MAZE Propagation Script,"This test simulates MAZE ransomware's propogation script that searches through a list of computers, tests connectivity to them, and copies a binary file to the Windows\Temp directory of each one. 
Upon successful execution, a specified binary file will attempt to be copied to each online machine, a list of the online machines, as well as a list of offline machines will be output to a specified location.
Reference: https://www.fireeye.com/blog/threat-research/2020/05/tactics-techniques-procedures-associated-with-maze-ransomware-incidents.html 
",command-and-control,T1105,Ingress Tool Transfer
5f468e3e1c415900aab5e33f88da8c60,atomic,iwr or Invoke Web-Request download,"Use 'iwr' or ""Invoke-WebRequest"" -URI argument to download a file from the web. Note: without -URI also works in some versions.
",command-and-control,T1105,Ingress Tool Transfer
b200c52b097fd12b22b3203e0035e55d,atomic,RemotePC Software Execution,"An adversary may attempt to trick the user into downloading RemotePC Software for use as a C2 channel. 
Upon successful execution, RemotePC will be executed. 
",command-and-control,T1219,Remote Access Software
7f734143338de2b02093a703f919e7fc,atomic,Testing usage of uncommonly used port with PowerShell,"Testing uncommonly used port utilizing PowerShell. APT33 has been known to attempt telnet over port 8081. Upon execution, details about the successful
port check will be displayed.
",command-and-control,T1571,Non-Standard Port
b0eb5108debf92ed5707a964b2bf3481,atomic,portproxy reg key,"Adds a registry key to set up a proxy on the endpoint at HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\PortProxy\v4tov4
Upon execution there will be a new proxy entry in netsh
netsh interface portproxy show all
",command-and-control,T1090.001,Proxy: Internal Proxy
ef2c951840423ba90c208867dcf89c87,atomic,Malicious User Agents - Powershell,"This test simulates an infected host beaconing to command and control. Upon execution, no output will be displayed. 
Use an application such as Wireshark to record the session and observe user agent strings and responses.

Inspired by APTSimulator - https://github.com/NextronSystems/APTSimulator/blob/master/test-sets/command-and-control/malicious-user-agents.bat
",command-and-control,T1071.001,Application Layer Protocol: Web Protocols
0a69420bec84b02bd47464f6835653b1,atomic,Word spawned a command shell and used an IP address in the command line,"Word spawning a command prompt then running a command with an IP address in the command line is an indicator of malicious activity.
Upon execution, CMD will be launched and ping 8.8.8.8.
",initial-access,T1566.001,Phishing: Spearphishing Attachment
1afaec09315ab71fdfb167175e8a019a,atomic,Download Macro-Enabled Phishing Attachment,"This atomic test downloads a macro enabled document from the Atomic Red Team GitHub repository, simulating an end user clicking a phishing link to download the file.
The file ""PhishingAttachment.xlsm"" is downloaded to the %temp% directory.
",initial-access,T1566.001,Phishing: Spearphishing Attachment
4f0c66956fc56e1ab11f4a1e394a4fd0,atomic,Octopus Scanner Malware Open Source Supply Chain,"This test simulates an adversary Octopus drop the RAT dropper ExplorerSync.db
[octopus-scanner-malware-open-source-supply-chain](https://securitylab.github.com/research/octopus-scanner-malware-open-source-supply-chain/)
[the-supreme-backdoor-factory](https://www.dfir.it/blog/2019/02/26/the-supreme-backdoor-factory/)
",initial-access,T1195,Supply Chain Compromise
076ce07e755915250b7d1af352c75aa0,atomic,Copy Private SSH Keys with CP,"Copy private SSH keys on a Linux system to a staging folder using the `cp` command.
",credential-access,T1552.004,Unsecured Credentials: Private Keys
a59dbd1a2ac17d69455248e7d91231bc,atomic,Password spray all Active Directory domain users with a single password via LDAP against domain controller (NTLM or Kerberos),"Attempt to brute force all Active Directory domain users with a single password (called ""password spraying"") on a domain controller, via LDAP, with NTLM or Kerberos

Prerequisite: AD RSAT PowerShell module is needed and it must run under a domain user (to fetch the list of all domain users)
",credential-access,T1110.003,Brute Force: Password Spraying
1690470fc24d4f33da5858999f955d2a,atomic,Steal Firefox Cookies (Windows),"This test queries Firefox's cookies.sqlite database to steal the cookie data contained within it, similar to Zloader/Zbot's cookie theft function. 
Note: If Firefox is running, the process will be killed to ensure that the DB file isn't locked. 
See https://www.malwarebytes.com/resources/files/2020/05/the-silent-night-zloader-zbot_final.pdf. 
",credential-access,T1539,Steal Web Session Cookie
2d78dfbfea7fa4ec7349993b83048079,atomic,ADFS token signing and encryption certificates theft - Local,"Retrieve ADFS token signing and encrypting certificates. This is a precursor to the Golden SAML attack (T1606.002). You must be signed in as Administrator on an ADFS server.
Based on https://o365blog.com/post/adfs/ and https://github.com/fireeye/ADFSDump.
",credential-access,T1552.004,Unsecured Credentials: Private Keys
2f03250355bb1403dcfac6808782a192,atomic,Request All Tickets via PowerShell,"The following test will utilize native PowerShell Identity modules to query the domain to extract allthe Service Principal Names. This behavior is typically used during a kerberos or silver ticket attack. 
A successful execution will output the SPNs for the domain in question.
",credential-access,T1558.003,Steal or Forge Kerberos Tickets: Kerberoasting
e0c75b4cc32124ef4c61508694fd0808,atomic,Get-DomainUser with PowerView,"Utilizing PowerView, run Get-DomainUser to identify domain users. Upon execution, progress and info about users within the domain being scanned will be displayed.
",credential-access,T1558.004,Steal or Forge Kerberos Tickets: AS-REP Roasting
4a99aa7ab51979ac419506be5d3f2c29,atomic,SUDO Brute Force - Debian,"An adversary may find themselves on a box (e.g. via ssh key auth, with no password) with a user that has sudo'ers privileges, but they do not know the users password. Normally, failed attempts to access root will not cause the root account to become locked, to prevent denial-of-service. This functionality enables an attacker to undertake a local brute force password guessing attack without locking out the root user. 

This test creates the ""art"" user with a password of ""password123"", logs in, downloads and executes the sudo_bruteforce.sh which brute force guesses the password, then deletes the user
",credential-access,T1110.001,Brute Force: Password Guessing
dcf01b96aca3771f0afc86357cbe5c6d,atomic,Password Brute User using Kerbrute Tool,"Bruteforce a single user's password from a wordlist
",credential-access,T1110.001,Brute Force: Password Guessing
935e8026584b85192519c57d7080b048,atomic,Extract Windows Credential Manager via VBA,"This module will extract the credentials found within the Windows credential manager and dump
them to $env:TEMP\windows-credentials.txt
",credential-access,T1555,Credentials from Password Stores
9c2f9c808a72b05686236a63e1da93c8,atomic,WinPwn - passhunt,Search for Passwords on this system using passhunt via WinPwn,credential-access,T1552.001,Unsecured Credentials: Credentials In Files
a3fb0059bd5dea11d715cba0e09631d5,atomic,SSH Credential Stuffing From Linux,"Using username,password combination from a password dump to login over SSH.
",credential-access,T1110.004,Brute Force: Credential Stuffing
6b8a391237b7169d02dd6538f8290345,atomic,WinPwn - PowerSharpPack - Retrieving NTLM Hashes without Touching LSASS,PowerSharpPack - Retrieving NTLM Hashes without Touching LSASS technique via function of WinPwn,credential-access,T1187,Forced Authentication
6bbb6f8b1db42e2c2c79892e8c31feb3,atomic,Enumerate credentials from Windows Credential Manager using vaultcmd.exe [Windows Credentials],This module will enumerate credentials stored in Windows Credentials vault of Windows Credential Manager using builtin utility vaultcmd.exe,credential-access,T1555,Credentials from Password Stores
44df0e5fd9ba43087400e0348aa5ac1c,atomic,Credential Dumping with NPPSpy,"Changes ProviderOrder Registry Key Parameter and creates Key for NPPSpy.
After user's logging in cleartext password is saved in C:\NPPSpy.txt.
Clean up deletes the files and reverses Registry changes.
NPPSpy Source: https://github.com/gtworek/PSBits/tree/master/PasswordStealing/NPPSpy",credential-access,T1003,OS Credential Dumping
baf7e695c46eda5497fc648d976054a6,atomic,Password spray all Azure AD users with a single password,"Attempt to brute force all Azure AD users with a single password (called ""password spraying"") via AzureAD Powershell module.
Valid credentials are only needed to fetch the list of Azure AD users.
",credential-access,T1110.003,Brute Force: Password Spraying
27fa36b2a66d4c2ce6c0198854cda800,atomic,Gsecdump,"Dump credentials from memory using Gsecdump.

Upon successful execution, you should see domain\username's followed by two 32 character hashes.

If you see output that says ""compat: error: failed to create child process"", execution was likely blocked by Anti-Virus. 
You will receive only error output if you do not run this test from an elevated context (run as administrator)

If you see a message saying ""The system cannot find the path specified"", try using the get-prereq_commands to download and install Gsecdump first.
",credential-access,T1003,OS Credential Dumping
000549902a51ef21f57d3d28a6e5ecc0,atomic,CertUtil ExportPFX,"The following Atomic test simulates adding a generic non-malicious certificate to the Root certificate store. This behavior generates a registry modification that adds the cloned root CA certificate in the keys outlined in the blog. In addition, this Atomic utilizes CertUtil to export the PFX (ExportPFX), similar to what was seen in the Golden SAML attack.
Keys will look like - \SystemCertificates\CA\Certificates or \SystemCertificates\Root\Certificates
Reference: https://posts.specterops.io/code-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec
Reference: https://www.splunk.com/en_us/blog/security/a-golden-saml-journey-solarwinds-continued.html
",credential-access,T1552.004,Unsecured Credentials: Private Keys
c6ea575d9641c11410417105f14175ab,atomic,WinPwn - Loot local Credentials - mimi-kittenz,Loot local Credentials - mimi-kittenz technique via function of WinPwn - Extend timeout to 600s,credential-access,T1555.003,Credentials from Password Stores: Credentials from Web Browsers
c98d344fed27267f83450731071922aa,atomic,Password Spray Microsoft Online Accounts with MSOLSpray (Azure/O365),"This test attempts to brute force a list of Microsoft Online (Azure/O365) users with a single password via the MSOLSpray Powershell module.
",credential-access,T1110.003,Brute Force: Password Spraying
f5606cc7632289d5ca72d4a485c14f6b,atomic,Enumerate credentials from Windows Credential Manager using vaultcmd.exe [Web Credentials],This module will enumerate credentials stored in Web Credentials vault of Windows Credential Manager using builtin utility vaultcmd.exe,credential-access,T1555,Credentials from Password Stores
2cc37a6cf2f1acdeaa6a6638016444d1,atomic,Retrieve Microsoft IIS Service Account Credentials Using AppCmd (using config),"AppCmd.exe is a command line utility which is used for managing an IIS web server. The config command within the tool reveals the service account credentials configured for the webserver. An adversary may use these credentials for other malicious purposes.
[Reference](https://twitter.com/0gtweet/status/1588815661085917186?cxt=HHwWhIDUyaDbzYwsAAAA)",credential-access,T1003,OS Credential Dumping
aeb4fdbb3453127caaef0ad5c250d838,atomic,Extracting passwords with findstr,"Extracting Credentials from Files. Upon execution, the contents of files that contain the word ""password"" will be displayed.
",credential-access,T1552.001,Unsecured Credentials: Credentials In Files
f0a6a8fe9ec4afd504d22c509a9660e9,atomic,Steal Chrome Cookies (Windows),"This test queries Chrome's SQLite database to steal the encrypted cookie data, designed to function similarly to Zloader/Zbot's cookie theft function. 
Once an adversary obtains the encrypted cookie info, they could go on to decrypt the encrypted value, potentially allowing for session theft. 
Note: If Chrome is running, the process will be killed to ensure that the DB file isn't locked. 
See https://www.malwarebytes.com/resources/files/2020/05/the-silent-night-zloader-zbot_final.pdf. 
",credential-access,T1539,Steal Web Session Cookie
86a1f874f775e156551e30fe039517d8,atomic,Decrypt Mozilla Passwords with Firepwd.py,"Firepwd.py is a script that can decrypt Mozilla (Thunderbird, Firefox) passwords.
Upon successful execution, the decrypted credentials will be output to a text file, as well as displayed on screen. 
",credential-access,T1555.003,Credentials from Password Stores: Credentials from Web Browsers
9e771275f11328252ac359ee3cc2f32c,atomic,"Access /etc/{shadow,passwd} with a standard bin that's not cat","Dump /etc/passwd and /etc/shadow using ed
",credential-access,T1003.008,OS Credential Dumping: /etc/passwd and /etc/shadow
09fc509d77ec1ce89738bedeac2e9e3a,atomic,Brute Force Credentials of single Active Directory domain users via SMB,"Attempts to brute force a single Active Directory account by testing connectivity to the IPC$ share on a domain controller
",credential-access,T1110.001,Brute Force: Password Guessing
91a18ae1efe4119a549cea2ac7de72c4,atomic,Request A Single Ticket via PowerShell,"The following test will utilize native PowerShell Identity modules to query the domain to extract the Service Principal Names for a single computer. This behavior is typically used during a kerberos or silver ticket attack. 
A successful execution will output the SPNs for the endpoint in question.
",credential-access,T1558.003,Steal or Forge Kerberos Tickets: Kerberoasting
9d0478981edda6091f911a1305025bde,atomic,Dump credentials from Windows Credential Manager With PowerShell [web Credentials],This module will extract the credentials from Windows Credential Manager,credential-access,T1555,Credentials from Password Stores
e91bbca3e82c76d7780b4326b1882b19,atomic,Crafting Active Directory golden tickets with mimikatz,"Once the hash of the special krbtgt user is retrieved it is possible to craft Kerberos Ticket Granting Ticket impersonating any user in the Active Directory domain.
This test crafts a Golden Ticket and then performs an SMB request with it for the SYSVOL share, thus triggering a service ticket request (event ID 4769).
The generated ticket is injected in a new empty Windows session and discarded after, so it does not pollute the current Windows session.
",credential-access,T1558.001,Steal or Forge Kerberos Tickets: Golden Ticket
f6a54519202161924924772a013c51b2,atomic,Find and Access Github Credentials,"This test looks for .netrc files (which stores github credentials in clear text )and dumps its contents if found.
",credential-access,T1552.001,Unsecured Credentials: Credentials In Files
8de14c0ea1b80dbd5de0cf5d28cff16b,atomic,Dump Credential Manager using keymgr.dll and rundll32.exe,"This test executes the exported function `KRShowKeyMgr` located in `keymgr.dll` using `rundll32.exe`. It opens a window that allows to export stored Windows credentials from the credential manager to a file (`.crd` by default). The file can then be retrieved and imported on an attacker-controlled computer to list the credentials get the passwords. The only limitation is that it requires a CTRL+ALT+DELETE input from the attacker, which can be achieve multiple ways (e.g. a custom implant with remote control capabilities, enabling RDP, etc.).
Reference: https://twitter.com/0gtweet/status/1415671356239216653",credential-access,T1003,OS Credential Dumping
c7aa16aea441e7bec9a6391af601acc9,atomic,WinPwn - Loot local Credentials - Wifi Credentials,Loot local Credentials - Wifi Credentials technique via function of WinPwn,credential-access,T1555,Credentials from Password Stores
279d24eeb12b40e4547945accf59ca62,atomic,Password Spray Invoke-DomainPasswordSpray Light,"Perform a domain password spray using the same core method of the [DomainPasswordSpray tool](https://github.com/dafthack/DomainPasswordSpray) 
but without all the extra code that makes the script get blocked by many AVs. 
This atomic test will attempt a single password against all users in a password list at $env:Temp\usersdpsLight.txt. You can create this file manually
or with the automated prereq_command. The prereq_command will limit the user list to 200 users by default to help you avoid massive account lockout.
",credential-access,T1110.003,Brute Force: Password Spraying
fd3ee5ac9978245dae1e7563a1c6b13d,atomic,Export Certificates with Mimikatz,"The following Atomic test will utilize Mimikatz to extract the certificates from the local system My store. This tool is available at https://github.com/gentilkiwi/mimikatz and can be obtained using the get-prereq_commands.
A successful attempt will stdout the certificates and write multiple .pfx and .der files to disk.
",credential-access,T1552.004,Unsecured Credentials: Private Keys
32b3ff317f207b221b14283a30f48007,atomic,Extract Browser and System credentials with LaZagne,"[LaZagne Source](https://github.com/AlessandroZ/LaZagne)
",credential-access,T1552.001,Unsecured Credentials: Credentials In Files
f6c693da77b8824b3c52ba3b6ca0bf88,atomic,Retrieve Microsoft IIS Service Account Credentials Using AppCmd (using list),"AppCmd.exe is a command line utility which is used for managing an IIS web server. The list command within the tool reveals the service account credentials configured for the webserver. An adversary may use these credentials for other malicious purposes.
[Reference](https://twitter.com/0gtweet/status/1588815661085917186?cxt=HHwWhIDUyaDbzYwsAAAA)",credential-access,T1003,OS Credential Dumping
053d6505f7c4cf792b0ab2f262dff95a,atomic,Create Volume Shadow Copy remotely (WMI) with esentutl,"This test is intended to be run from a remote workstation with domain admin context.
The Active Directory database NTDS.dit may be dumped by copying it from a Volume Shadow Copy created with esentutl.
",credential-access,T1003.003,OS Credential Dumping: NTDS
8a3763d7c08e9865d77f96d033716d1c,atomic,Search macOS Safari Cookies,"This test uses `grep` to search a macOS Safari binaryCookies file for specified values. This was used by CookieMiner malware.

Upon successful execution, MacOS shell will cd to `~/Libraries/Cookies` and grep for `Cookies.binarycookies`.
",credential-access,T1555.003,Credentials from Password Stores: Credentials from Web Browsers
25e524a8b1364858658ca0f6751da778,atomic,PowerDump Hashes and Usernames from Registry,Executes a hashdump by reading the hashes from the registry.,credential-access,T1003.002,OS Credential Dumping: Security Account Manager
0310c8a2dcab1e2bdfadf004c1141da8,atomic,Dump LSASS.exe Memory using Out-Minidump.ps1,"The memory of lsass.exe is often dumped for offline credential theft attacks. This test leverages a pure
powershell implementation that leverages the MiniDumpWriteDump Win32 API call.
Upon successful execution, you should see the following file created $env:SYSTEMROOT\System32\lsass_*.dmp.
",credential-access,T1003.001,OS Credential Dumping: LSASS Memory
1a877cae5bfda737bd8c362423d1b8e3,atomic,Cat the contents of a Kubernetes service account token file,"Access the Kubernetes service account access token stored within a container in a cluster.
",credential-access,T1552.007,Kubernetes List Secrets
7784d702d69cb5219ff8fa6177b3ad81,atomic,Search Through Bash History,"Search through bash history for specifice commands we want to capture
",credential-access,T1552.003,Unsecured Credentials: Bash History
56c2f2d8b48bcb1c999d4e8929bd8d9b,atomic,Stage Popular Credential Files for Exfiltration,"This test is designed to search a drive for credential files used by the most common web browsers on Windows (Firefox, Chrome, Opera, and Edge), export the found files to a folder, and zip it,
simulating how an adversary might stage sensitive credential files for exfiltration in order to conduct offline password extraction with tools like [firepwd.py](https://github.com/lclevy/firepwd) or [HackBrowserData](https://github.com/moonD4rk/HackBrowserData). 
",credential-access,T1555.003,Credentials from Password Stores: Credentials from Web Browsers
2d2b2b31b70f1beef285b942c580f4c3,atomic,WinPwn - sensitivefiles,Search for sensitive files on this local system using the SensitiveFiles function of WinPwn,credential-access,T1552.001,Unsecured Credentials: Credentials In Files
995eb25ee0b9d036110318311ca2527b,atomic,Export Root Certificate with Export-Certificate,"Creates a Root certificate and exports it with Export-Certificate PowerShell Cmdlet.
Upon a successful attempt, this will write a pfx to disk and utilize the Cmdlet Export-Certificate.
",credential-access,T1552.004,Unsecured Credentials: Private Keys
24b8cc6c8e6c224a4f698ac3983d524d,atomic,Run Chrome-password Collector,"A modified sysinternals suite will be downloaded and staged. The Chrome-password collector, renamed accesschk.exe, will then be executed from #{file_path}.

Successful execution will produce stdout message stating ""Copying db ... passwordsDB DB Opened. statement prepare DB connection closed properly"". Upon completion, final output will be a file modification of $env:TEMP\sysinternals\passwordsdb.

Adapted from [MITRE ATTACK Evals](https://github.com/mitre-attack/attack-arsenal/blob/66650cebd33b9a1e180f7b31261da1789cdceb66/adversary_emulation/APT29/CALDERA_DIY/evals/data/abilities/credential-access/e7cab9bb-3e3a-4d93-99cc-3593c1dc8c6d.yml)
",credential-access,T1555.003,Credentials from Password Stores: Credentials from Web Browsers
b2d33bf89e8cd3fa19911b8650804087,atomic,Brute Force Credentials of single Active Directory domain user via LDAP against domain controller (NTLM or Kerberos),"Attempt to brute force Active Directory domain user on a domain controller, via LDAP, with NTLM or Kerberos
",credential-access,T1110.001,Brute Force: Password Guessing
954860df5054a5fabc114abefd8e45f6,atomic,WinPwn - BrowserPwn,Collect Browser credentials as well as the history via winpwn browserpwn function of WinPwn.,credential-access,T1555.003,Credentials from Password Stores: Credentials from Web Browsers
755379ed9f057c8b0f95d98bfbf3880d,atomic,SSH Credential Stuffing From MacOS,"Using username,password combination from a password dump to login over SSH.
",credential-access,T1110.004,Brute Force: Credential Stuffing
3f4dd4cffe51d21011fbe98bd2c00c09,atomic,SUDO Brute Force - Redhat,"An adversary may find themselves on a box (e.g. via ssh key auth, with no password) with a user that has sudo'ers privileges, but they do not know the users password. Normally, failed attempts to access root will not cause the root account to become locked, to prevent denial-of-service. This functionality enables an attacker to undertake a local brute force password guessing attack without locking out the root user. 

This test creates the ""art"" user with a password of ""password123"", logs in, downloads and executes the sudo_bruteforce.sh which brute force guesses the password, then deletes the user
",credential-access,,
745d16045bcf10379b8cf2fa45f2b66e,atomic,ADFS token signing and encryption certificates theft - Remote,"Retrieve ADFS token signing and encrypting certificates. This is a precursor to the Golden SAML attack (T1606.002). You must be signed in as a Domain Administrators user on a domain-joined computer.
Based on https://o365blog.com/post/adfs/ and https://github.com/fireeye/ADFSDump.
",credential-access,T1552.004,Unsecured Credentials: Private Keys
268f529c68280d4cbd0aa06cf6438be8,atomic,Rubeus kerberoast,"Information on the Rubeus tool and it's creators found here: https://github.com/GhostPack/Rubeus#asreproast
This build targets .NET 4.5.  If targeting a different version you will need to compile Rubeus
",credential-access,T1558.003,Steal or Forge Kerberos Tickets: Kerberoasting
c285cfeaf0c226d3d2b3812726dbe3a8,atomic,Password Spray (DomainPasswordSpray),"Perform a domain password spray using the DomainPasswordSpray tool. It will try a single password against all users in the domain

https://github.com/dafthack/DomainPasswordSpray
",credential-access,T1110.003,Brute Force: Password Spraying
4f3f0cbca49ee581e3296d16f559c725,atomic,Password Spray all Domain Users,"CAUTION! Be very careful to not exceed the password lockout threshold for users in the domain by running this test too frequently.
This atomic attempts to map the IPC$ share on one of the Domain Controllers using a password of Spring2020 for each user in the %temp%\users.txt list. Any successful authentications will be printed to the screen with a message like ""[*] username:password"", whereas a failed auth will simply print a period. Use the input arguments to specify your own password to use for the password spray.
Use the get_prereq_command's to create a list of all domain users in the temp directory called users.txt.
See the ""Windows FOR Loop Password Spraying Made Easy"" blog by @OrOneEqualsOne for more details on how these spray commands work. https://medium.com/walmartlabs/windows-for-loop-password-spraying-made-easy-c8cd4ebb86b5",credential-access,T1110.003,Brute Force: Password Spraying
36fc42ced381416ca7d5d7af0ee0561b,atomic,Dump LSASS.exe using imported Microsoft DLLs,"The memory of lsass.exe is often dumped for offline credential theft attacks. This can be achieved by
importing built-in DLLs and calling exported functions. Xordump will re-read the resulting minidump 
file and delete it immediately to avoid brittle EDR detections that signature lsass minidump files.

Upon successful execution, you should see the following file created $env:TEMP\lsass-xordump.t1003.001.dmp.
",credential-access,T1003.001,OS Credential Dumping: LSASS Memory
d27398e945aa13a0812450cd48815572,atomic,Azure - Search Azure AD User Attributes for Passwords,"This test uses the MSOnline Powershell module to retrieve all user attributes for a specified account, which can sometimes contain unsecured credentials. 
Upon successful execution, this test will scan all user attributes for any strings containing ""password"".
Those unsecured credentials will be output to a text file, as well as the account that they are associated with and the user attribute in which they were found. 
See: https://github.com/dafthack/CloudPentestCheatsheets/blob/master/cheatsheets/Azure.md
",credential-access,T1552.005,Unsecured Credentials: Cloud Instance Metadata API
ecb6d616a6566411dc36a6510904b0ba,atomic,Dump LSASS.exe Memory using ProcDump,"The memory of lsass.exe is often dumped for offline credential theft attacks. This can be achieved with Sysinternals
ProcDump.

Upon successful execution, you should see the following file created c:\windows\temp\lsass_dump.dmp.

If you see a message saying ""procdump.exe is not recognized as an internal or external command"", try using the  get-prereq_commands to download and install the ProcDump tool first.
",credential-access,T1003.001,OS Credential Dumping: LSASS Memory
af30d8506a8aba7a022b687261d22541,atomic,Access /etc/shadow (Local),"/etc/shadow file is accessed in Linux environments
",credential-access,T1003.008,OS Credential Dumping: /etc/passwd and /etc/shadow
3e5b04b8ee0a1a4950da8f35d95e65fc,atomic,Enumeration for Credentials in Registry,"Queries to enumerate for credentials in the Registry. Upon execution, any registry key containing the word ""password"" will be displayed.
",credential-access,T1552.002,Unsecured Credentials: Credentials in Registry
58351281e64f2182ac4f8b44f63e9042,atomic,WinPwn - Snaffler,Check Domain Network-Shares for cleartext passwords using Snaffler function of WinPwn,credential-access,T1552.001,Unsecured Credentials: Credentials In Files
f6867f2b9b1b3c2eb733ad7ce7438f04,atomic,WinPwn - Loot local Credentials - Decrypt Teamviewer Passwords,Loot local Credentials - Decrypt Teamviewer Passwords technique via function of WinPwn,credential-access,T1555,Credentials from Password Stores
e66e4283978c8df9077696ace360a507,atomic,Rubeus asreproast,"Information on the Rubeus tool and it's creators found here: https://github.com/GhostPack/Rubeus#asreproast
This build targets .NET 4.5.  If targeting a different version you will need to compile Rubeus
",credential-access,T1558.004,Steal or Forge Kerberos Tickets: AS-REP Roasting
6dc5c587fd22d65b81a443b7ce065ab1,atomic,Create Volume Shadow Copy with Powershell,"This test is intended to be run on a domain Controller.

The Active Directory database NTDS.dit may be dumped by copying it from a Volume Shadow Copy.
",credential-access,T1003.003,OS Credential Dumping: NTDS
1ae855684c48448c29ad04858bbe5a2a,atomic,WinPwn - Loot local Credentials - Dump SAM-File for NTLM Hashes,Loot local Credentials - Dump SAM-File for NTLM Hashes technique via function of WinPwn,credential-access,T1003.002,OS Credential Dumping: Security Account Manager
aee64e494f7adfb1867d67f7ee08e5c6,atomic,WinPwn - PowerSharpPack - Sharpweb for Browser Credentials,PowerSharpPack - Sharpweb searching for Browser Credentials technique via function of WinPwn,credential-access,T1555.003,Credentials from Password Stores: Credentials from Web Browsers
e11194c092261fb1a60c378aa8788e15,atomic,dump volume shadow copy hives with certutil,"Dump hives from volume shadow copies with the certutil utility, exploiting a vulnerability known as ""HiveNightmare"" or ""SeriousSAM"".
This can be done with a non-admin user account. [CVE-2021-36934](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-36934)
",credential-access,T1003.002,OS Credential Dumping: Security Account Manager
03526668cc55b6544244b107feadaf22,atomic,LSASS read with pypykatz,"Parses secrets hidden in the LSASS process with python. Similar to mimikatz's sekurlsa::

Python 3 must be installed, use the get_prereq_command's to meet the prerequisites for this test.

Successful execution of this test will display multiple useranames and passwords/hashes to the screen.
",credential-access,T1003.001,OS Credential Dumping: LSASS Memory
cf60378dd1bbaccd4e7391c0317da202,atomic,Create Volume Shadow Copy with WMI,"This test is intended to be run on a domain Controller.

The Active Directory database NTDS.dit may be dumped by copying it from a Volume Shadow Copy.
",credential-access,T1003.003,OS Credential Dumping: NTDS
69219b448ba0a75bae573d58d8b6cf40,atomic,dump volume shadow copy hives with System.IO.File,"Dump hives from volume shadow copies with System.IO.File. [CVE-2021-36934](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-36934)
",credential-access,T1003.002,OS Credential Dumping: Security Account Manager
e9a13658d13fbb309abf51dce4a71f55,atomic,Brute Force:Credential Stuffing using Kerbrute Tool,"Will read username and password combos from a file or stdin (format username:password) and perform a bruteforce attack
",credential-access,T1110.004,Brute Force: Credential Stuffing
2b20abe4020074cc3598e28dcf41d1bc,atomic,Offline Credential Theft With Mimikatz,"The memory of lsass.exe is often dumped for offline credential theft attacks. Adversaries commonly perform this offline analysis with
Mimikatz. This tool is available at https://github.com/gentilkiwi/mimikatz and can be obtained using the get-prereq_commands.
",credential-access,T1003.001,OS Credential Dumping: LSASS Memory
f7ea25ca809e576a3b5b5b1e4dd94ea4,atomic,Create Symlink to Volume Shadow Copy,"This test is intended to be run on a domain Controller.

The Active Directory database NTDS.dit may be dumped by creating a symlink to Volume Shadow Copy.
",credential-access,T1003.003,OS Credential Dumping: NTDS
c85384aa4b2dbca53e4ef5f9cac7a39b,atomic,ListSecrets,"A Kubernetes secret is an object that lets users store and manage sensitive information, such as passwords and connection strings in the cluster. Secrets can be consumed by reference in the pod configuration. Attackers who have permissions to retrieve the secrets from the API server (by using the pod service account, for example) can access sensitive information that might include credentials to various services.
",credential-access,T1552.007,Kubernetes List Secrets
bb0df721f4a4defa743efe9e61837c44,atomic,Cached Credential Dump via Cmdkey,"List credentials currently stored on the host via the built-in Windows utility cmdkey.exe
Credentials listed with Cmdkey only pertain to the current user
Passwords will not be displayed once they are stored
https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/cmdkey
https://www.peew.pw/blog/2017/11/26/exploring-cmdkey-an-edge-case-for-privilege-escalation
",credential-access,T1003.005,OS Credential Dumping: Cached Domain Credentials
d74777514cba5a4fd4f297261ed0d8ef,atomic,Dump credentials from Windows Credential Manager With PowerShell [windows Credentials],This module will extract the credentials from Windows Credential Manager,credential-access,T1555,Credentials from Password Stores
16d35ea694e0568c1fee03936e448865,atomic,Password Cracking with Hashcat,Execute Hashcat.exe with provided SAM file from registry of Windows and Password list to crack against,credential-access,T1110.002,Brute Force: Password Cracking
6f0815bd32e08646588c398d0e79ebb3,atomic,Create Mini Dump of LSASS.exe using ProcDump,"The memory of lsass.exe is often dumped for offline credential theft attacks. This can be achieved with Sysinternals
ProcDump. This particular method uses -mm to produce a mini dump of lsass.exe

Upon successful execution, you should see the following file created c:\windows\temp\lsass_dump.dmp.

If you see a message saying ""procdump.exe is not recognized as an internal or external command"", try using the  get-prereq_commands to download and install the ProcDump tool first.
",credential-access,T1003.001,OS Credential Dumping: LSASS Memory
cf4411185e815ccecbe712b46ae2156e,atomic,BrowserStealer (Chrome / Firefox / Microsoft Edge),"[Github Repo](https://github.com/SaulBerrenson/BrowserStealer) Simple password/cookies stealer for chrome, edge, and gecko based browsers (30 listed working). This attack simulates stealing the data from the browser files and printing them to the command line.
If using to test with Firefox, if the browser is x64 you need to use the x64 build
",credential-access,T1555.003,Credentials from Password Stores: Credentials from Web Browsers
3a27f7828503c255275fa014464fb815,atomic,Dump individual process memory with Python (Local),"Using `/proc/$PID/mem`, where $PID is the target process ID, use a Python script to
copy a process's heap memory to an external file so it can be searched or exfiltrated later.
",credential-access,T1003.007,OS Credential Dumping: Proc Filesystem
35d92515122effdd73801c6ac3021da7,atomic,Dump LSASS.exe Memory using comsvcs.dll,"The memory of lsass.exe is often dumped for offline credential theft attacks. This can be achieved with a built-in dll.

Upon successful execution, you should see the following file created $env:TEMP\lsass-comsvcs.dmp.
",credential-access,T1003.001,OS Credential Dumping: LSASS Memory
3267861a1da6d870da272e15b9ab088b,atomic,Simulating access to Chrome Login Data,"Simulates an adversary accessing encrypted credentials from Google Chrome Login database. 
",credential-access,T1555.003,Credentials from Password Stores: Credentials from Web Browsers
410108b9909252e207bfaa7d92a117f4,atomic,GPP Passwords (Get-GPPPassword),"Look for the encrypted cpassword value within Group Policy Preference files on the Domain Controller.
This test is intended to be run from a domain joined workstation, not on the Domain Controller itself.
The Get-GPPPasswords.ps1 executed during this test can be obtained using the get-prereq_commands.

Successful test execution will either display the credentials found in the GPP files or indicate ""No preference files found"".
",credential-access,T1552.006,Unsecured Credentials: Group Policy Preferences
ac51003d352df853d49a28ca5a4311f9,atomic,Azure - Dump All Azure Key Vaults with Microburst,"Upon successful execution of this test, the names, locations, and contents of key vaults within an Azure account will be output to a file.
See - https://www.netspi.com/blog/technical/cloud-penetration-testing/a-beginners-guide-to-gathering-azure-passwords/",credential-access,T1528,Steal Application Access Token
4cecc12b906ec724e9f2178fed1e7071,atomic,Capture Passwords with MimiPenguin,"MimiPenguin is a tool inspired by MimiKatz that targets Linux systems affected by CVE-2018-20781 (Ubuntu-based distros and certain versions of GNOME Keyring). 
Upon successful execution on an affected system, MimiPenguin will retrieve passwords from memory and output them to a specified file. 
See https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20781. 
See https://www.tecmint.com/mimipenguin-hack-login-passwords-of-linux-users/#:~:text=Mimipenguin%20is%20a%20free%20and,tested%20on%20various%20Linux%20distributions.
",credential-access,T1003.007,OS Credential Dumping: Proc Filesystem
780cde60c956ccbff24c43ff7b7e70ea,atomic,Access unattend.xml,"Attempts to access unattend.xml, where credentials are commonly stored, within the Panther directory where installation logs are stored.
If these files exist, their contents will be displayed. They are used to store credentials/answers during the unattended windows install process.
",credential-access,T1552.001,Unsecured Credentials: Credentials In Files
8b5f748da9647a4d9c5a37f20124ba9c,atomic,Request for service tickets,"This test uses the Powershell Empire Module: Invoke-Kerberoast.ps1
The following are further sources and credits for this attack:
[Kerberoasting Without Mimikatz source] (https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/)
[Invoke-Kerberoast source] (https://powersploit.readthedocs.io/en/latest/Recon/Invoke-Kerberoast/)
when executed successfully , the test displays available services with their hashes. 
If the testing domain doesn't have any service principal name configured, there is no output
",credential-access,T1558.003,Steal or Forge Kerberos Tickets: Kerberoasting
fd4249a81164c9014b395cf211fdeed2,atomic,Simulating Access to Chrome Login Data - MacOS,"This test locates the Login Data files used by Chrome to store encrypted credentials, then copies them to the temp directory for later exfil. 
Once the files are exfiltrated, malware like CookieMiner could be used to perform credential extraction. 
See https://unit42.paloaltonetworks.com/mac-malware-steals-cryptocurrency-exchanges-cookies/ . 
",credential-access,T1555.003,Credentials from Password Stores: Credentials from Web Browsers
52928f462ea8f5fa617aa8c815f5598b,atomic,WinPwn - PowerSharpPack - Kerberoasting Using Rubeus,PowerSharpPack - Kerberoasting Using Rubeus technique via function of WinPwn,credential-access,T1558.004,Steal or Forge Kerberos Tickets: AS-REP Roasting
1a9d81f05549fb5061467e303cd8f386,atomic,Simulating access to Windows Firefox Login Data,"Simulates an adversary accessing encrypted credentials from firefox web browser's login database.
more info in https://support.mozilla.org/en-US/kb/profiles-where-firefox-stores-user-data
",credential-access,T1555.003,Credentials from Password Stores: Credentials from Web Browsers
e16297dffb68b5ffa5b243243233cd1c,atomic,Private Keys,"Find private keys on the Windows file system.
File extensions include: .key, .pgp, .gpg, .ppk., .p12, .pem, pfx, .cer, .p7b, .asc
",credential-access,T1552.004,Unsecured Credentials: Private Keys
0a154631923cfdbf2bc717716a9b75d8,atomic,Registry parse with pypykatz,"Parses registry hives to obtain stored credentials
",credential-access,T1003.002,OS Credential Dumping: Security Account Manager
10ce4e4c0a8d29ead8968da8156d8358,atomic,Access Saved Credentials via VaultCmd,"List credentials currently stored in Windows Credential Manager via the native Windows utility vaultcmd.exe
Credential Manager stores credentials for signing into websites, applications, and/or devices that request authentication through NTLM or Kerberos
https://blog.malwarebytes.com/101/2016/01/the-windows-vaults/
https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16
",credential-access,T1555.004,Credentials from Password Stores: Windows Credential Manager
ac7757ba58f423fa808b4b6f115cc613,atomic,"WinPwn - Loot local Credentials - AWS, Microsoft Azure, and Google Compute credentials","Loot local Credentials - AWS, Microsoft Azure, and Google Compute credentials technique via function of WinPwn",credential-access,T1552.001,Unsecured Credentials: Credentials In Files
548f5aa3ec2fcfc6872ee10975480f29,atomic,Copy NTDS.dit from Volume Shadow Copy,"This test is intended to be run on a domain Controller.

The Active Directory database NTDS.dit may be dumped by copying it from a Volume Shadow Copy.

This test requires steps taken in the test ""Create Volume Shadow Copy with vssadmin"".
A successful test also requires the export of the SYSTEM Registry hive.
This test must be executed on a Windows Domain Controller.
",credential-access,T1003.003,OS Credential Dumping: NTDS
31cf0ec60219bc8a36865f2eaddf1fbd,atomic,DCSync (Active Directory),"Active Directory attack allowing retrieval of account information without accessing memory or retrieving the NTDS database.
Works against a remote Windows Domain Controller using the replication protocol.
Privileges required: domain admin or domain controller account (by default), or any other account with required rights.
[Reference](https://adsecurity.org/?p=1729)
",credential-access,T1003.006,OS Credential Dumping: DCSync
f4dac543bf0d8241df7f584ad501bbd7,atomic,Copy Private SSH Keys with rsync,"Copy private SSH keys on a Linux or macOS system to a staging folder using the `rsync` command.
",credential-access,T1552.004,Unsecured Credentials: Private Keys
59c02702e85383fa2fe0c95c257166de,atomic,Keychain,"### Keychain Files

  ~/Library/Keychains/

  /Library/Keychains/

  /Network/Library/Keychains/

  [Security Reference](https://developer.apple.com/legacy/library/documentation/Darwin/Reference/ManPages/man1/security.1.html)

  [Keychain dumper](https://github.com/juuso/keychaindump)
",credential-access,T1555.001,Credentials from Password Stores: Keychain
5e3512c73a461c17ddcb1cc0bbdbeef9,atomic,WinPwn - PowerSharpPack - Kerberoasting Using Rubeus,PowerSharpPack - Kerberoasting Using Rubeus technique via function of WinPwn,credential-access,T1558.003,Steal or Forge Kerberos Tickets: Kerberoasting
6d968b2bfa7f45550662620724618fb9,atomic,WinPwn - SessionGopher,Launches SessionGopher on this system via WinPwn,credential-access,T1552.001,Unsecured Credentials: Credentials In Files
efdca41c8a098f89f2db9c334627d8ac,atomic,WinPwn - Kerberoasting,Kerberoasting technique via function of WinPwn,credential-access,T1558.003,Steal or Forge Kerberos Tickets: Kerberoasting
9238ae711ad42fea9892671fef93783f,atomic,AWS - Password Spray an AWS using GoAWSConsoleSpray,"GoAWSConsoleSpray is a tool that can be used to spray AWS IAM Console Credentials in order to identify a valid login for a user account built by WhiteOakSecurity. For more details reagrding the tool, check - https://www.whiteoaksecurity.com/blog/goawsconsolespray-password-spraying-tool/
",credential-access,T1110.003,Brute Force: Password Spraying
c8d711527846fa2c5816f150c690c2d5,atomic,Discover Private SSH Keys,"Discover private SSH keys on a macOS or Linux system.
",credential-access,T1552.004,Unsecured Credentials: Private Keys
790523f56191466c7103452ccdbabd33,atomic,Crafting Active Directory silver tickets with mimikatz,"Once the hash of service account is retrieved it is possible to forge Kerberos ticket granting service (TGS) tickets, also known as silver tickets.
The generated ticket is injected in a new empty Windows session and discarded after, so it does not pollute the current Windows session.
",credential-access,T1558.002,Steal or Forge Kerberos Tickets: Silver Ticket
33f718d05dddc362f6f83802b8b89e93,atomic,AWS - Retrieve EC2 Password Data using stratus,"This atomic runs an API call GetPasswordData from a role that does not have permission to do so. This simulates an attacker attempting to retrieve RDP passwords on a high number of Windows EC2 instances. This atomic test leverages a tool called stratus-red-team built by DataDog (https://github.com/DataDog/stratus-red-team). Stratus Red Team is a self-contained binary. You can use it to easily detonate offensive attack techniques against a live cloud environment. Ref: https://stratus-red-team.cloud/attack-techniques/AWS/aws.credential-access.ec2-get-password-data/
",credential-access,T1552,Unsecured Credentials
927d62f0c59f2a0832d95562bc3e84e2,atomic,LaZagne.py - Dump Credentials from Firefox Browser,"Credential Dump Ubuntu 20.04.4 LTS Focal Fossa Firefox Browser, Reference https://github.com/AlessandroZ/LaZagne",credential-access,T1555.003,Credentials from Password Stores: Credentials from Web Browsers
0501437f74ad9350b96fdaf64d0fb6c7,atomic,Dump LSASS.exe Memory using NanoDump,"The NanoDump tool uses syscalls and an invalid dump signature to avoid detection.

https://github.com/helpsystems/nanodump

Upon successful execution, you should find the nanondump.dmp file in the temp directory
",credential-access,T1003.001,OS Credential Dumping: LSASS Memory
2966a5fc825f509f4adff7b855e26574,atomic,Dump individual process memory with sh (Local),"Using `/proc/$PID/mem`, where $PID is the target process ID, use shell utilities to
copy process memory to an external file so it can be searched or exfiltrated later.
",credential-access,T1003.007,OS Credential Dumping: Proc Filesystem
7fa4ea18694f2552547b65e23952cabb,atomic,"Registry dump of SAM, creds, and secrets","Local SAM (SAM & System), cached credentials (System & Security) and LSA secrets (System & Security) can be enumerated
via three registry keys. Then processed locally using https://github.com/Neohapsis/creddump7

Upon successful execution of this test, you will find three files named, sam, system and security in the %temp% directory.
",credential-access,T1003.002,OS Credential Dumping: Security Account Manager
08c8ac512b422e66e7ec398f60f02645,atomic,WebBrowserPassView - Credentials from Browser,The following Atomic test utilizes WebBrowserPassView to extract passwords from browsers on a Window system. WebBrowserPassView is an open source application used to retrieve passwords stored on a local computer. Recently noticed as a tool used in the BlackCat Ransomware.,credential-access,T1555.003,Credentials from Password Stores: Credentials from Web Browsers
7532005da662bfc703ce3d8ef4e8ac70,atomic,WinPwn - DomainPasswordSpray Attacks,DomainPasswordSpray Attacks technique via function of WinPwn,credential-access,T1110.003,Brute Force: Password Spraying
87601246abde270b512d08c868c03bfb,atomic,Powershell Mimikatz,"Dumps credentials from memory via Powershell by invoking a remote mimikatz script.
If Mimikatz runs successfully you will see several usernames and hashes output to the screen.
Common failures include seeing an \""access denied\"" error which results when Anti-Virus blocks execution. 
Or, if you try to run the test without the required administrative privleges you will see this error near the bottom of the output to the screen ""ERROR kuhl_m_sekurlsa_acquireLSA""
",credential-access,T1003.001,OS Credential Dumping: LSASS Memory
1353d954c020fa5ff039b7e85ee261bc,atomic,WinPwn - Loot local Credentials - Invoke-WCMDump,Loot local Credentials - Invoke-WCMDump technique via function of WinPwn,credential-access,T1555.004,Credentials from Password Stores: Windows Credential Manager
3883fdbd7c29b2f2f20121c75f875944,atomic,Brute Force Credentials of single Azure AD user,"Attempt to brute force Azure AD user via AzureAD powershell module.
",credential-access,T1110.001,Brute Force: Password Guessing
107a14acdd84a7d6e7c891177b0db3aa,atomic,Crafting Active Directory golden tickets with Rubeus,"Once the hash of the special krbtgt user is retrieved it is possible to craft Kerberos Ticket Granting Ticket impersonating any user in the Active Directory domain.
This test crafts a Golden Ticket and then performs an SMB request with it for the SYSVOL share, thus triggering a service ticket request (event ID 4769).
The generated ticket is injected in a new empty Windows session and discarded after, so it does not pollute the current Windows session.
",credential-access,T1558.001,Steal or Forge Kerberos Tickets: Golden Ticket
f7257d271a176f7c609b4a33513d2eef,atomic,Export Root Certificate with Export-PFXCertificate,"Creates a Root certificate and exports it with Export-PFXCertificate PowerShell Cmdlet.
Upon a successful attempt, this will write a pfx to disk and utilize the Cmdlet Export-PFXCertificate.
",credential-access,T1552.004,Unsecured Credentials: Private Keys
e0496104d8da1ada94001fe7778e7402,atomic,Extract all accounts in use as SPN using setspn,"The following test will utilize setspn to extract the Service Principal Names. This behavior is typically used during a kerberos or silver ticket attack. 
A successful execution will output all the SPNs for the related domain. 
",credential-access,T1558.003,Steal or Forge Kerberos Tickets: Kerberoasting
2c6e39a39ebf794d74417a7b1291463b,atomic,WinPwn - Loot local Credentials - lazagne,"The [LaZagne project](https://github.com/AlessandroZ/LaZagne) is an open source application used to retrieve lots of passwords stored on a local computer. 
Each software stores its passwords using different techniques (plaintext, APIs, custom algorithms, databases, etc.). 
This tool has been developed for the purpose of finding these passwords for the most commonly-used software",credential-access,T1555,Credentials from Password Stores
12b56ab7e1f7739b1a60f6d8098a7ce7,atomic,Find AWS credentials,"Find local AWS credentials from file, defaults to using / as the look path.
",credential-access,T1552.001,Unsecured Credentials: Credentials In Files
6b55240dbd6e02df957284328938fcf6,atomic,Create Volume Shadow Copy with vssadmin,"This test is intended to be run on a domain Controller.

The Active Directory database NTDS.dit may be dumped by copying it from a Volume Shadow Copy.
",credential-access,T1003.003,OS Credential Dumping: NTDS
bead649d4e8d5e0f507e8e71914724db,atomic,LaZagne - Credentials from Browser,"The following Atomic test utilizes [LaZagne](https://github.com/AlessandroZ/LaZagne) to extract passwords from browsers on the Windows operating system.
LaZagne is an open source application used to retrieve passwords stored on a local computer. 
",credential-access,T1555.003,Credentials from Password Stores: Credentials from Web Browsers
502b7914aac58f15708500e3ec62526b,atomic,Golden SAML,"Forge a ""Golden SAML"" token which allows to impersonate any Azure AD user, and authenticate to AADGraph (as a proof). 
You will need the ADFS token signing certificate (see T1552.004 to export it).
More info here : https://o365blog.com/post/adfs/
",credential-access,T1606.002,Forge Web Credentials: SAML token
749175da6f9c4fc4609df39c8f98fca2,atomic,Password Spray using Kerbrute Tool,"Test a single password against a list of users
",credential-access,T1110.003,Brute Force: Password Spraying
18f31c311ac208802e88ab8d5af8603e,atomic,Dump svchost.exe to gather RDP credentials,"The svchost.exe contains the RDP plain-text credentials.
Source: https://www.n00py.io/2021/05/dumping-plaintext-rdp-credentials-from-svchost-exe/

Upon successful execution, you should see the following file created $env:TEMP\svchost-exe.dmp.
",credential-access,T1003,OS Credential Dumping
1d6526136ce6998ddb48511587e8ffe6,atomic,Copy the users GnuPG directory with rsync,"Copy the users GnuPG (.gnupg) directory on a Mac or Linux system to a staging folder using the `rsync` command.
",credential-access,T1552.004,Unsecured Credentials: Private Keys
a8911b689872a0b7060bc920440d2647,atomic,Dump LSASS with createdump.exe from .Net v5,"Use createdump executable from .NET to create an LSASS dump.

[Reference](https://twitter.com/bopin2020/status/1366400799199272960?s=20)
",credential-access,T1003.001,OS Credential Dumping: LSASS Memory
53d863a190b41b6af474be875b74784b,atomic,GPP Passwords (findstr),"Look for the encrypted cpassword value within Group Policy Preference files on the Domain Controller. This value can be decrypted with gpp-decrypt on Kali Linux.
",credential-access,T1552.006,Unsecured Credentials: Group Policy Preferences
32df42a1c7b596e73b7e4eee24438994,atomic,Simulating access to Opera Login Data,"Simulates an adversary accessing encrypted credentials from Opera web browser's login database. 
",credential-access,T1555.003,Credentials from Password Stores: Credentials from Web Browsers
bdd7294d26bde5f398e6ec5d846cdee5,atomic,Access /etc/passwd (Local),"/etc/passwd file is accessed in Linux environments
",credential-access,T1003.008,OS Credential Dumping: /etc/passwd and /etc/shadow
b8c5d884f259766b9fa1e6f32666ca0f,atomic,Simulating access to Windows Edge Login Data,"Simulates an adversary accessing encrypted credentials from Edge web browser's login database.
more info in https://www.forensicfocus.com/articles/chromium-based-microsoft-edge-from-a-forensic-point-of-view/
",credential-access,T1555.003,Credentials from Password Stores: Credentials from Web Browsers
b0cc317b44660531ede5eafdce1e3cb5,atomic,Extract passwords with grep,"Extracting credentials from files
",credential-access,T1552.001,Unsecured Credentials: Credentials In Files
262666862164b89881f6b5c565c0a3be,atomic,Enumeration for PuTTY Credentials in Registry,"Queries to enumerate for PuTTY credentials in the Registry. PuTTY must be installed for this test to work. If any registry
entries are found, they will be displayed.
",credential-access,T1552.002,Unsecured Credentials: Credentials in Registry
adbbf2ebad58d40cb7260e0cb42e5093,atomic,Dumping LSA Secrets,"Dump secrets key from Windows registry
When successful, the dumped file will be written to $env:Temp\secrets.
Attackers may use the secrets key to assist with extracting passwords and enumerating other sensitive system information.
https://pentestlab.blog/2018/04/04/dumping-clear-text-credentials/#:~:text=LSA%20Secrets%20is%20a%20registry,host%2C%20local%20security%20policy%20etc.
",credential-access,T1003.004,OS Credential Dumping: LSA Secrets
ccf2af19610078752b4982a33b269f6f,atomic,Run DSInternals Get-ADReplAccount,"The following Atomic will run Get-ADReplAccount from DSInternals.
Upon successful execution, domain and credentials will appear in stdout. 
[Reference](https://www.crowdstrike.com/blog/observations-from-the-stellarparticle-campaign/) CrowdStrike StellerParticle.
https://www.dsinternals.com/en/retrieving-active-directory-passwords-remotely/
",credential-access,T1003.006,OS Credential Dumping: DCSync
be6f8d1c9a01d720483c8a5daca1c472,atomic,Create Volume Shadow Copy remotely with WMI,"This test is intended to be run from a remote workstation with domain admin context.
The Active Directory database NTDS.dit may be dumped by copying it from a Volume Shadow Copy.
",credential-access,T1003.003,OS Credential Dumping: NTDS
315440f0fd42ea0129065a76d89184f1,atomic,Azure - Dump Azure Instance Metadata from Virtual Machines,"This test invokes a web request to the default Instance Metadata API of 169.254.169.254 in order to dump the data contained within it to a file. 
See: https://www.sans.org/blog/cloud-instance-metadata-services-imds-/
",credential-access,T1552.005,Unsecured Credentials: Cloud Instance Metadata API
d21b4ae13ee85560eb6b82c5c9150ae7,atomic,esentutl.exe SAM copy,"Copy the SAM hive using the esentutl.exe utility
This can also be used to copy other files and hives like SYSTEM, NTUSER.dat etc.
",credential-access,T1003.002,OS Credential Dumping: Security Account Manager
7fa328192c9a6815c2ea93fe54fa0059,atomic,List All Secrets,"A Kubernetes secret is an object that lets users store and manage sensitive information, such as passwords and connection strings in the cluster. Secrets can be consumed by reference in the pod configuration. Attackers who have permissions to retrieve the secrets from the API server (by using the pod service account, for example) can access sensitive information that might include credentials to various services or provide further access to the cluster.
[More information about secrets](https://kubernetes.io/docs/concepts/configuration/secret/).

This test will make a request to the Kubernetes api at the `/api/v1/secrets` endpoint requesting every secret stored within the cluster.
",credential-access,T1552.007,Kubernetes List Secrets
16dfb3bfff123ed3be652367df062c61,atomic,Dump LSASS.exe Memory using direct system calls and API unhooking,"The memory of lsass.exe is often dumped for offline credential theft attacks. This can be achieved using direct system calls and API unhooking in an effort to avoid detection. 
https://github.com/outflanknl/Dumpert
https://outflank.nl/blog/2019/06/19/red-team-tactics-combining-direct-system-calls-and-srdi-to-bypass-av-edr/
Upon successful execution, you should see the following file created C:\\windows\\temp\\dumpert.dmp.

If you see a message saying \""The system cannot find the path specified.\"", try using the  get-prereq_commands to download the  tool first.
",credential-access,T1003.001,OS Credential Dumping: LSASS Memory
118b56eddccdf2cc0ed064e73ff33a28,atomic,PetitPotam,"This module runs the Windows executable of PetitPotam in order to coerce authentication for a remote system.
",credential-access,T1187,Forced Authentication
838fcd628b987b82c6dff35cd275f916,atomic,"Access /etc/{shadow,passwd} with shell builtins","Dump /etc/passwd and /etc/shadow using bash builtins
",credential-access,T1003.008,OS Credential Dumping: /etc/passwd and /etc/shadow
f2d48f9efed23e058bfe0f46d93d07a2,atomic,WinPwn - powershellsensitive,Check Powershell event logs for credentials or other sensitive information via winpwn powershellsensitive function.,credential-access,T1552.001,Unsecured Credentials: Credentials In Files
b41910e3770cff37dd642650f0d91672,atomic,Staging Local Certificates via Export-Certificate,"Export all user certificates and add to a compressed archive.
",credential-access,T1649,Steal or Forge Authentication Certificates
df3a85f892f81ee118bee2a49141710a,atomic,Dump Active Directory Database with NTDSUtil,"This test is intended to be run on a domain Controller.

The Active Directory database NTDS.dit may be dumped using NTDSUtil for offline credential theft attacks. This capability
uses the ""IFM"" or ""Install From Media"" backup functionality that allows Active Directory restoration or installation of
subsequent domain controllers without the need of network-based replication.

Upon successful completion, you will find a copy of the ntds.dit file in the C:\Windows\Temp directory.
",credential-access,T1003.003,OS Credential Dumping: NTDS
adce11c81bb77ae74660c6c743a0442d,atomic,Clear Powershell History by Deleting History File,"Clears Powershell history
",defense-evasion,T1070.003,Indicator Removal on Host: Clear Command History
b1129d5b6d29f6611c03e4f091d6c42d,atomic,MSXSL Bypass using remote files,"Executes the code specified within a XSL script tag during XSL transformation using a remote payload.
Requires download of MSXSL.exe. No longer available from Microsoft.
(Available via Internet Archive https://web.archive.org/web/20200825011623/https://www.microsoft.com/en-us/download/details.aspx?id=21714 )
Open Calculator.exe when test successfully executed, while AV turned off.
",defense-evasion,T1220,XSL Script Processing
995a75a3009f98f56160ea61cb00645a,atomic,Masquerading - windows exe running as different windows exe,"Copies a windows exe, renames it as another windows exe, and launches it to masquerade as second windows exe
",defense-evasion,T1036.003,Masquerading: Rename System Utilities
350c23947232688eeda9b7b2511732f5,atomic,Windows Powershell Logging Disabled,"Modify the registry of the currently logged in user using reg.exe via cmd console to disable Powershell Module Logging, Script Block Logging, Transcription and Script Execution
see https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.PowerShell::EnableModuleLogging
",defense-evasion,T1112,Modify Registry
6ff9659bac38f7c1f64b7f302309c2f3,atomic,Msiexec.exe - Execute Local MSI file with an embedded DLL,"Executes an MSI containing an embedded DLL using msiexec.exe
",defense-evasion,T1218.007,Signed Binary Proxy Execution: Msiexec
0d2e984bedf73f5266e250d7ecd257cf,atomic,Invoke CHM with default Shortcut Command Execution,Executes a CHM file with the default Shortcut Command method.,defense-evasion,T1218.001,Signed Binary Proxy Execution: Compiled HTML File
b62952c5352ee68c1340feb08a5a02a1,atomic,Execute base64-encoded PowerShell,"Creates base64-encoded PowerShell code and executes it. This is used by numerous adversaries and malicious tools.

Upon successful execution, powershell will execute an encoded command and stdout default is ""Write-Host ""Hey, Atomic!""
",defense-evasion,T1027,Obfuscated Files or Information
6c35402f56f69f6eaf8c0cbe36fa1638,atomic,Lolbin Gpscript logon option,"Executes logon scripts configured in Group Policy.
https://lolbas-project.github.io/lolbas/Binaries/Gpscript/
https://oddvar.moe/2018/04/27/gpscript-exe-another-lolbin-to-the-list/
",defense-evasion,T1218,Signed Binary Proxy Execution
238fac804625c68206069fbec5cbf49c,atomic,Dynamic C# Compile,"When C# is compiled dynamically, a .cmdline file will be created as a part of the process. 
Certain processes are not typically observed compiling C# code, but can do so without touching disk. This can be used to unpack a payload for execution.
The exe file that will be executed is named as T1027.004_DynamicCompile.exe is containted in the 'bin' folder of this atomic, and the source code to the file is in the 'src' folder.
Upon execution, the exe will print 'T1027.004 Dynamic Compile'.
",defense-evasion,T1027.004,Obfuscated Files or Information: Compile After Delivery
03a0a74a1396a51c5cb607e787070048,atomic,Overwrite and delete a file with shred,"Use the `shred` command to overwrite the temporary file and then delete it
",defense-evasion,T1070.004,Indicator Removal on Host: File Deletion
a713f8a033268f0b923012f527067640,atomic,Disable Windows Change Password Feature,"Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows change password feature.
See how ransomware abuses this technique- https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/ransom_heartbleed.thdobah
",defense-evasion,T1112,Modify Registry
bcdc2f68450358a50f50fa89410fa122,atomic,Compiled HTML Help Local Payload,"Uses hh.exe to execute a local compiled HTML Help payload.
Upon execution calc.exe will open
",defense-evasion,T1218.001,Signed Binary Proxy Execution: Compiled HTML File
dfe7d14833fd57a8e8e48019e063b0a7,atomic,Delete system journal logs via rm and journalctl utilities,"The first sub-test deletes the journal files using rm utility in the ""/var/log/journal/"" directory and the second sub-test clears the journal by modifiying time period of logs that should be retained to zero.
",defense-evasion,T1070.002,Indicator Removal on Host: Clear Linux or Mac System Logs
fd992e8ecfdac9b56dd6868904044827,atomic,Activate Windows NoRun Group Policy Feature,"Modify the registry of the currently logged in user using reg.exe via cmd console to Remove Run menu from Start Menu Group Policy.
Take note that some Group Policy changes might require a restart to take effect.
See how Trojan abuses this technique- https://www.sophos.com/de-de/threat-center/threat-analyses/viruses-and-spyware/Troj~Krotten-N/detailed-analysis
",defense-evasion,T1112,Modify Registry
b3e9f59599e24e318d7a5292c2830362,atomic,Windows - Modify file last modified timestamp with PowerShell,"Modifies the file last modified timestamp of a specified file. This technique was seen in use by the Stitch RAT.
To verify execution, use File Explorer to view the Properties of the file and observe that the Modified time is the year 1970.
",defense-evasion,T1070.006,Indicator Removal on Host: Timestomp
ac8b270b934f97529a09688fe944b347,atomic,Disable Carbon Black Response,"Disables Carbon Black Response
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
afae914d4839d5194835d8475604e7b8,atomic,Disable Windows Defender with PwSh Disable-WindowsOptionalFeature,"The following Atomic will attempt to disable Windows-Defender using the built in PowerShell cmdlet Disable-WindowsOptionalFeature, Deployment Image Servicing and Management tool. 
Similar to DISM.exe, this cmdlet is used to enumerate, install, uninstall, configure, and update features and packages in Windows images.
A successful execution will not standard-out any details. Remove the quiet switch if verbosity is needed.
This method will remove Defender and it's packages.
Reference: https://docs.microsoft.com/en-us/powershell/module/dism/disable-windowsoptionalfeature?view=windowsserver2022-ps
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
8c47e4a4fe7c3e255b062ca1339d11ed,atomic,Create Hidden User using IsHidden option,"Add a hidden user on macOS using IsHidden optoin
",defense-evasion,T1564.002,Hide Artifacts: Hidden Users
93127a8c6cdb05fd84f871a5faa9d7c7,atomic,Disable macOS Gatekeeper,"Disables macOS Gatekeeper
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
0fa53cacfb86254022a27a050159fa83,atomic,Terminal Server Client Connection History Cleared,"The built-in Windows Remote Desktop Connection (RDP) client (mstsc.exe) saves the remote computer name (or IP address) and the username that is used to login after each successful connection to the remote computer
",defense-evasion,T1112,Modify Registry
d3ddb9ff73f1927990c8286b6bf796e7,atomic,Regasm Uninstall Method Call Test,"Executes the Uninstall Method, No Admin Rights Required. Upon execution, ""I shouldn't really execute either."" will be displayed.
",defense-evasion,T1218.009,Signed Binary Proxy Execution: Regsvcs/Regasm
c33bd0d7424951f39b73a1f5f491fe17,atomic,Allow RDP Remote Assistance Feature,"Modify the registry of the currently logged in user using reg.exe via cmd console to allow rdp remote assistance feature. This feature allow specific
user to rdp connect on the targeted machine.
See how azorult malware abuses this technique- https://app.any.run/tasks/a6f2ffe2-e6e2-4396-ae2e-04ea0143f2d8/
",defense-evasion,T1112,Modify Registry
a534890161825ac40b02e5f4c82cc5dd,atomic,Clear Bash history (cat dev/null),"Clears bash history via cat /dev/null
",defense-evasion,T1070.003,Indicator Removal on Host: Clear Command History
d5ac8f5ec45224dc36453a9490845f23,atomic,Masquerading as Windows LSASS process,"Copies cmd.exe, renames it, and launches it to masquerade as an instance of lsass.exe.

Upon execution, cmd will be launched by powershell. If using Invoke-AtomicTest, The test will hang until the 120 second timeout cancels the session
",defense-evasion,T1036.003,Masquerading: Rename System Utilities
28b6c4b9b4441ece378a8cfd09bb451f,atomic,Hide a Directory,"Hide a directory on MacOS
",defense-evasion,T1564.001,Hide Artifacts: Hidden Files and Directories
93b4f004682dfb6d1af15e01c2859f93,atomic,Disable Windows Defender with DISM,"The following Atomic will attempt to disable Windows-Defender using the built in DISM.exe, Deployment Image Servicing and Management tool. 
DISM is used to enumerate, install, uninstall, configure, and update features and packages in Windows images.
A successful execution will not standard-out any details. Remove the quiet switch if verbosity is needed.
This method will remove Defender and it's package.
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
f6f3109375020c484e291ac3668f38af,atomic,Odbcconf.exe - Execute Arbitrary DLL,"Execute arbitrary DLL file stored locally.
",defense-evasion,T1218.008,Signed Binary Proxy Execution: Odbcconf
2030ccf9f80ce3020e4ee510fadeb0be,atomic,Rundll32 with desk.cpl,"Rundll32.exe loading an executable renamed as .scr using desk.cpl 
Reference: 
  - [LOLBAS - Libraries/Desk](https://lolbas-project.github.io/lolbas/Libraries/Desk/)
SIGMA rules:
  - [SCR File Write Event](https://github.com/SigmaHQ/sigma/blob/b53f08b081e0a50099be9b9e8eced82097fdbaf2/rules/windows/file_event/file_event_win_new_src_file.yml)
  - [Rundll32 InstallScreenSaver Execution](https://github.com/SigmaHQ/sigma/blob/b53f08b081e0a50099be9b9e8eced82097fdbaf2/rules/windows/process_creation/proc_creation_win_lolbin_rundll32_installscreensaver.yml)
",defense-evasion,T1218.011,Signed Binary Proxy Execution: Rundll32
5d426eb0a666aec389a212616662c66d,atomic,attrib - Remove read-only attribute,"Removes the read-only attribute from a file or folder using the attrib.exe command. Upon execution, no output will be displayed.
Open the file in File Explorer > Right Click - Prperties and observe that the Read Only checkbox is empty.
",defense-evasion,T1222.001,File and Directory Permissions Modification: Windows File and Directory Permissions Modification
23dafb943f2f1a3e21e8204826c7b271,atomic,Execute a process from a directory masquerading as the current parent directory.,"Create and execute a process from a directory masquerading as the current parent directory (`...` instead of normal `..`)
",defense-evasion,T1036.005,Masquerading: Match Legitimate Name or Location
5eec8bf22546e9b98fb21d5af305797c,atomic,Azure - Eventhub Deletion,"Identifies an Event Hub deletion in Azure.
An Event Hub is an event processing service that ingests and processes large volumes of events and data.
An adversary may delete an Event Hub in an attempt to evade detection.
https://docs.microsoft.com/en-us/azure/event-hubs/event-hubs-about.
",defense-evasion,T1562.008,Impair Defenses: Disable Cloud Logs
69ac4d0ed190b9442fca7e16f649a2be,atomic,Suspend History,"suspend Shell History seen in Awfulshred wiper- https://unix.stackexchange.com/questions/10922/temporarily-suspend-bash-history-on-a-given-shell
",defense-evasion,,
f7de34810a85331e65c656023acb549b,atomic,chmod - Change file or folder mode (numeric mode) recursively,"Changes a file or folder's permissions recursively using chmod and a specified numeric mode.
",defense-evasion,T1222.002,File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification
c7377e8d72e51f1d71f37f86357540c2,atomic,Lolbin Jsc.exe compile javascript to exe,"Use jsc.exe to compile javascript code stored in scriptfile.js and output scriptfile.exe.
https://lolbas-project.github.io/lolbas/Binaries/Jsc/
https://www.phpied.com/make-your-javascript-a-windows-exe/
",defense-evasion,T1127,Trusted Developer Utilities Proxy Execution
e510c5fd2f1ea418990fcf06775bc9b4,atomic,Certutil Rename and Decode,"Rename certutil and decode a file. This is in reference to latest research by FireEye [here](https://www.fireeye.com/blog/threat-research/2018/09/apt10-targeting-japanese-corporations-using-updated-ttps.html)
",defense-evasion,T1140,Deobfuscate/Decode Files or Information
3c36afcd68b8139b52e7399c41e30959,atomic,Windows HideSCAVolume Group Policy Feature,"Modify the registry of the currently logged in user using reg.exe via cmd console to remove the volume icon Group Policy. 
Take note that some Group Policy changes might require a restart to take effect..
See how ransomware abuses this technique- https://www.virustotal.com/gui/file/2d7855bf6470aa323edf2949b54ce2a04d9e38770f1322c3d0420c2303178d91/details
",defense-evasion,T1112,Modify Registry
eefa25ef5e2f94020b95d80e31ef2bc9,atomic,Binary simply packed by UPX,"Copies and then runs a simple binary (just outputting ""the cake is a lie""), that was packed by UPX.
No other protection/compression were applied.
",defense-evasion,T1027.002,Obfuscated Files or Information: Software Packing
2b403e3d0f5501a43b025c29b7c55d60,atomic,Chmod through c script,"chmods a file using a c script
",defense-evasion,T1222.002,File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification
326a9797b0d59b8f6d5a3c384c564b9f,atomic,Base64 decoding with shell utilities,"Use common shell utilities to decode a base64-encoded text string and echo it to the console
",defense-evasion,T1140,Deobfuscate/Decode Files or Information
12ba4650b2b42fb4b58989faacc03061,atomic,chown - Change file or folder ownership and group recursively,"Changes a file or folder's ownership and group information recursively using chown.
",defense-evasion,T1222.002,File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification
f5e00f183d185e4306b355d3c3e5d8f3,atomic,Mount an ISO image and run executable from the ISO,"Mounts an ISO image downloaded from internet to evade Mark-of-the-Web and run hello.exe executable from the ISO. 
Upon successful execution, powershell will download the .iso from the Atomic Red Team repo, mount the image, and run the executable from the ISO image that will open command prompt echoing ""Hello, World!"". 
ISO provided by:https://twitter.com/mattifestation/status/1398323532988399620 Reference:https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/,  ",defense-evasion,T1553.005,Subvert Trust Controls: Mark-of-the-Web Bypass
081fccc31e55ea72b25e9914f15921b0,atomic,WINWORD Remote Template Injection,"Open a .docx file that loads a remote .dotm macro enabled template from https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1221/src/opencalc.dotm 
Executes the code specified within the .dotm template.
Requires download of WINWORD found in Microsoft Ofiice at Microsoft: https://www.microsoft.com/en-us/download/office.aspx.  
Default docs file opens Calculator.exe when test sucessfully executed, while AV turned off.
",defense-evasion,T1221,Template Injection
bfaa2b76303409212beaf87d88cc8564,atomic,Masquerading as Linux crond process.,"Copies sh process, renames it as crond, and executes it to masquerade as the cron daemon.

Upon successful execution, sh is renamed to `crond` and executed.
",defense-evasion,T1036.003,Masquerading: Rename System Utilities
34952e2eefd3066c5f574744e1734ca6,atomic,AMSI Bypass - AMSI InitFailed,"Any easy way to bypass AMSI inspection is it patch the dll in memory setting the ""amsiInitFailed"" function to true.
Upon execution, no output is displayed.

https://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
5c922d92f383656401d5633ca23db497,atomic,Pad Binary to Change Hash using truncate command - Linux/macOS,"Uses truncate to add a byte to the binary to change the hash.

Upon successful execution, truncate will modify `/tmp/evil-binary`, therefore the expected hash will change.
",defense-evasion,T1027.001,Obfuscated Files or Information: Binary Padding
ee72a74844bbc0bcdff17b3ce7157b19,atomic,Clear Bash history (echo),"Clears bash history via rm
",defense-evasion,T1070.003,Indicator Removal on Host: Clear Command History
0424ccb447bfa66b94162266f55ecd52,atomic,Change Powershell Execution Policy to Bypass,"Attackers need to change the powershell execution policy in order to run their malicious powershell scripts.
They can either specify it during the execution of the powershell script or change the registry value for it.
",defense-evasion,T1112,Modify Registry
fa4ba6a06b4a5cd955ea5a60fae24281,atomic,Activate Windows NoClose Group Policy Feature,"Modify the registry of the currently logged in user using reg.exe via cmd console to Disable and remove the Shut Down command Group Policy. 
Take note that some Group Policy changes might require a restart to take effect.
See how Trojan abuses this technique- https://www.sophos.com/de-de/threat-center/threat-analyses/viruses-and-spyware/Troj~Krotten-N/detailed-analysis
",defense-evasion,T1112,Modify Registry
ba8d59e23b49ff619ec0b9e81b967a16,atomic,Install root CA on Debian/Ubuntu,"Creates a root CA with openssl
",defense-evasion,T1553.004,Subvert Trust Controls: Install Root Certificate
ec078c0f9c10dc9fddd3fee713750137,atomic,Delete system log files using OSAScript,"This test deletes the system log file using osascript via ""do shell script""(sh/bash by default) which in-turn spawns rm utility, requires admin privileges
",defense-evasion,T1070.002,Indicator Removal on Host: Clear Linux or Mac System Logs
5ffa5b3b330848d39dc1728365dad61c,atomic,Set a file's creation timestamp,"Stomps on the create timestamp of a file

Setting the creation timestamp requires changing the system clock and reverting.
Sudo or root privileges are required to change date. Use with caution.
",defense-evasion,T1070.006,Indicator Removal on Host: Timestomp
1b43591006b8e25b8df16ee52f0832bf,atomic,Remove Administrative Shares,"Administrative shares are hidden network shares created by Microsoft’s Windows NT operating systems that grant system administrators 
remote access to every disk volume on a network-connected system. As Microsoft puts it, “Missing administrative shares typically 
indicate that the computer in question has been compromised by malicious software.
https://threatpost.com/conti-ransomware-gang-has-full-log4shell-attack-chain/177173/
",defense-evasion,T1070.005,Indicator Removal on Host: Network Share Connection Removal
c29f0da7c0bf612d30acb64e1d6e9368,atomic,Invoke HTML Application - Simulate Lateral Movement over UNC Path,Executes an HTA Application with Simulate lateral movement over UNC Path.,defense-evasion,T1218.005,Signed Binary Proxy Execution: Mshta
26c0843592bd870dab849c9f682b09da,atomic,Deobfuscate/Decode Files Or Information,"Encode/Decode executable
Upon execution a file named T1140_calc_decoded.exe will be placed in the temp folder
",defense-evasion,T1140,Deobfuscate/Decode Files or Information
2e9acde621e7768a73c1b9a1157c444d,atomic,Uninstall Crowdstrike Falcon on Windows,"Uninstall Crowdstrike Falcon. If the WindowsSensor.exe path is not provided as an argument we need to search for it. Since the executable is located in a folder named with a random guid we need to identify it before invoking the uninstaller.
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
f7144396fff68187217107bf2bc39600,atomic,WMI Win32_Product Class - Execute Local MSI file with embedded VBScript,"Executes an MSI containing embedded VBScript code using the WMI Win32_Product class
",defense-evasion,T1218.007,Signed Binary Proxy Execution: Msiexec
e0946bc3b8b888d6c4cdf3f023fe3c0b,atomic,Tamper with Windows Defender Evade Scanning -Extension,"Malware can exclude specific extensions from being scanned and evading detection. 
Upon successful execution, the extension(s) should be on the list of excluded extensions.
To check the exclusion list using poweshell  (Get-MpPreference).ExclusionExtension.
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
51ddafefb92c9dfcb6ce3369e7316bf3,atomic,Install root CA on Windows,"Creates a root CA with Powershell
",defense-evasion,T1553.004,Subvert Trust Controls: Install Root Certificate
3939013428dfc0bc10825755685849c2,atomic,Add and delete UFW firewall rules,"Add and delete a rule on the Uncomplicated Firewall (UFW) if installed and enabled. 
",defense-evasion,T1562.004,Impair Defenses: Disable or Modify System Firewall
b97004a5d9c4283b6085ddf3ff0d6b4c,atomic,Disable Hypervisor-Enforced Code Integrity (HVCI),"This test disables Hypervisor-Enforced Code Integrity (HVCI) by setting the registry key HKLM:\SYSTEM\CurrentControlSet\Control\DeviceGuard\Scenarios\HypervisorEnforcedCodeIntegrity ""Enabled"" value to ""0"".
The pre-req needs to be ran in order to setup HVCI and have it enabled. 
We do not recommend running this in production.
[Black Lotus Campaign](https://www.microsoft.com/en-us/security/blog/2023/04/11/guidance-for-investigating-attacks-using-cve-2022-21894-the-blacklotus-campaign/)
[Microsoft](https://learn.microsoft.com/en-us/windows/security/threat-protection/device-guard/enable-virtualization-based-protection-of-code-integrity)
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
6e8a2c8f187fcca7926bfc95f72ee048,atomic,Windows Add Registry Value to Load Service in Safe Mode without Network,"Modify the registry to allow a driver, service, to persist in Safe Mode.
see https://redcanary.com/blog/tracking-driver-inventory-to-expose-rootkits/ and https://blog.didierstevens.com/2007/03/26/playing-with-safe-mode/ for further details.
Adding a subkey to Minimal with the name of your service and a default value set to Service, makes that your service will be started when you boot into Safe Mode without networking. The same applies for the Network subkey.
",defense-evasion,T1112,Modify Registry
ebd726fe1e5462434f28d632424f86e5,atomic,InstallUtil Uninstall method call - /U variant,"Executes the Uninstall Method. Upon execution, version information will be displayed the .NET framework install utility.
",defense-evasion,T1218.004,Signed Binary Proxy Execution: InstallUtil
cab7b85611a290c0769546bfa9d6f962,atomic,Activate Windows NoControlPanel Group Policy Feature,"Modify the registry of the currently logged in user using reg.exe via cmd console to Disable Control Panel Group Policy. 
Take note that some Group Policy changes might require a restart to take effect.
See how Trojan abuses this technique- https://www.sophos.com/de-de/threat-center/threat-analyses/viruses-and-spyware/Troj~Krotten-N/detailed-analysis
",defense-evasion,T1112,Modify Registry
b14f62dd9f3c6132609147710f4a55b3,atomic,manage-bde.wsf Signed Script Command Execution,"Executes the signed manage-bde.wsf script with options to execute an arbitrary command.
",defense-evasion,T1216,Signed Script Proxy Execution
bc456ce28da22e33b96257b6ae020391,atomic,System File Copied to Unusual Location,It may be suspicious seeing a file copy of an EXE in System32 or SysWOW64 to a non-system directory or executing from a non-system directory.,defense-evasion,T1036,Masquerading
cb6e6c7e18aba2207c696368f8edb23a,atomic,LockBit Black - Disable Privacy Settings Experience Using Registry -Powershell,"LockBit Black - Disable Privacy Settings Experience Using Registry
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
5091ad13565a0e0369be0998e2affd1d,atomic,DiskShadow Command Execution,"Emulates attack with a DiskShadow.exe (LOLBIN installed by default on Windows) being used to execute arbitrary commands Reference: https://bohops.com/2018/03/26/diskshadow-the-return-of-vss-evasion-persistence-and-active-directory-database-extraction/
",defense-evasion,T1218,Signed Binary Proxy Execution
0b3e89fa4ed4a3eabadd330b44c3ec3d,atomic,Execute LNK file from ISO,"Executes LNK file document.lnk from AllTheThings.iso. Link file executes cmd.exe and rundll32 to in order to load and execute AllTheThingsx64.dll from the ISO which spawns calc.exe.
",defense-evasion,T1553.005,Subvert Trust Controls: Mark-of-the-Web Bypass
f05e54049cfa10bc4018bf9e68676cc8,atomic,AWS - CloudTrail Logs Impairment Through S3 Lifecycle Rule using Stratus,"This Atomic test will use the Stratus Red Team will first setup a CloudTrail logging into an S3 bucket and will then make an API call to update the lifecycle rule on that S3 bucket with an expiration date of 1 day. This will essentially delete all the logs after one day. Adversaries often do this actiivity to evade detection. Stratus Red Team is a self-contained binary. You can use it to easily detonate offensive attack techniques against a live cloud environment. ref: https://stratus-red-team.cloud/attack-techniques/AWS/aws.defense-evasion.cloudtrail-lifecycle-rule/
",defense-evasion,T1562.008,Impair Defenses: Disable Cloud Logs
0c05ae67acce3a0130e88a69c075810f,atomic,Masquerading - wscript.exe running as svchost.exe,"Copies wscript.exe, renames it, and launches it to masquerade as an instance of svchost.exe.

Upon execution, no windows will remain open but wscript will have been renamed to svchost and ran out of the temp folder
",defense-evasion,T1036.003,Masquerading: Rename System Utilities
16e96b0f0c0021663b2f5dfafabee6f0,atomic,Execution of non-dll using rundll32.exe,"Rundll32.exe running non-dll 
",defense-evasion,T1218.011,Signed Binary Proxy Execution: Rundll32
f30d3e0b387703e1a2eafd31b9103434,atomic,InstallUtil Uninstall method call - '/installtype=notransaction /action=uninstall' variant,"Executes the Uninstall Method. Upon execution, version information will be displayed the .NET framework install utility.
",defense-evasion,T1218.004,Signed Binary Proxy Execution: InstallUtil
0962e6107fcfa0f5abe2c5880d31cf34,atomic,Makes Eventlog blind with Phant0m,"Use [Phant0m](https://github.com/hlldz/Phant0m) to disable Eventlog
",defense-evasion,T1562.002,Impair Defenses: Disable Windows Event Logging
81c44eaf44a1fd04ef7bde11f64ac8bc,atomic,Windows HideSCAHealth Group Policy Feature,"Modify the registry of the currently logged in user using reg.exe via cmd console to remove security and maintenance icon Group Policy. 
Take note that some Group Policy changes might require a restart to take effect.
See how ransomware abuses this technique- https://www.virustotal.com/gui/file/2d7855bf6470aa323edf2949b54ce2a04d9e38770f1322c3d0420c2303178d91/details
",defense-evasion,T1112,Modify Registry
02a5491f1c325b55303f34abb458b811,atomic,Reboot Linux Host via Kernel System Request,"reboot system via system request seen in Awfulshred wiper.
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
be62caa4ce347cdfc7122ada8ca9d513,atomic,Disable Defender with Defender Control,"Attempting to use Defender Control software to disable Windows Defender. Upon successful execution, Windows Defender will be turned off. 
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
5ecf2385ad32719a3cc72bed33c60b57,atomic,Rundll32 with Ordinal Value,"Rundll32.exe loading dll using ordinal value #2 to DLLRegisterServer. 
Upon successful execution, Calc.exe will spawn.
",defense-evasion,T1218.011,Signed Binary Proxy Execution: Rundll32
b2c83d7fbfb70861d13c2ba65ea483eb,atomic,Disable journal logging via systemctl utility,"The atomic test disables the journal logging using built-in systemctl utility
",defense-evasion,T1562,Impair Defenses
3acf5046708b8ad68ecb7aeacbdd8d14,atomic,Add Network Share,"Add a Network Share utilizing the command_prompt
",defense-evasion,T1070.005,Indicator Removal on Host: Network Share Connection Removal
3838447b079b302fe75b700a70163815,atomic,Clear Logs,"Upon execution this test will clear Windows Event Logs. Open the System.evtx logs at C:\Windows\System32\winevt\Logs and verify that it is now empty.
",defense-evasion,T1070.001,Indicator Removal on Host: Clear Windows Event Logs
e7fed022d1e3befe9ac5dbb086f75363,atomic,Create Hidden User using UniqueID < 500,"Add a hidden user on macOS using Unique ID < 500 (users with that ID are hidden by default)
",defense-evasion,T1564.002,Hide Artifacts: Hidden Users
e9129335265410ac1034c4f064853880,atomic,Hide Windows Clock Group Policy Feature,"Modify the registry of the currently logged in user using reg.exe via cmd console to Hide Clock Group Policy. 
Take note that some Group Policy changes might require a restart to take effect.
See how ransomware abuses this technique- https://www.virustotal.com/gui/file/2d7855bf6470aa323edf2949b54ce2a04d9e38770f1322c3d0420c2303178d91/details
",defense-evasion,T1112,Modify Registry
4c378a952a9235b7aba7f273f3cf4874,atomic,Invoke CHM Simulate Double click,Executes a CHM file simulating a user double click.,defense-evasion,T1218.001,Signed Binary Proxy Execution: Compiled HTML File
26ed797080bee3874bb18301a88f1be9,atomic,chmod - Change file or folder mode (symbolic mode),"Changes a file or folder's permissions using chmod and a specified symbolic mode.
",defense-evasion,T1222.002,File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification
5827b7a328cbb3c5068ee8477c8c9be3,atomic,Show all hidden files,"Show all hidden files on MacOS
",defense-evasion,T1564.001,Hide Artifacts: Hidden Files and Directories
bc55c3967731490dc44e0f05b55b250d,atomic,Stop Crowdstrike Falcon on Linux,"Stop and disable Crowdstrike Falcon on Linux
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
6f2d3770ffae12e3cbeb0c49d9a700ad,atomic,Regsvr32 local DLL execution,"Regsvr32.exe is a command-line program used to register and unregister OLE controls. Upon execution, calc.exe will be launched.
",defense-evasion,T1218.010,Signed Binary Proxy Execution: Regsvr32
b3f30f3fd6b58f412ca7f06c4408b6a1,atomic,Malware Masquerading and Execution from Zip File,"When the file is unzipped and the README.cmd file opened, it executes and changes the .pdf to .dll and executes the dll. This is a BazaLoader technique [as reported here](https://twitter.com/ffforward/status/1481672378639912960)",defense-evasion,T1036,Masquerading
683115a2ceeb045e6ffbf4487322b220,atomic,Edit UFW firewall sysctl.conf file,"Edit the Uncomplicated Firewall (UFW) configuration file for setting network 
variables /etc/ufw/sysctl.conf.
",defense-evasion,T1562.004,Impair Defenses: Disable or Modify System Firewall
986876c6024765475043100f9e080fc8,atomic,LockBit Black - Unusual Windows firewall registry modification -Powershell,"An adversary tries to modify the windows firewall registry.
",defense-evasion,T1562.004,Impair Defenses: Disable or Modify System Firewall
8ef0e743e8f073af665288aaf631a71a,atomic,Modify registry to store logon credentials,"Sets registry key that will tell windows to store plaintext passwords (making the system vulnerable to clear text / cleartext password dumping).
Upon execution, the message ""The operation completed successfully."" will be displayed.
Additionally, open Registry Editor to view the modified entry in HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest.
",defense-evasion,T1112,Modify Registry
eeffd7795c1a6eee8f164531ac80a0fd,atomic,Blackbit - Disable Windows Firewall using netsh firewall,"An adversary tries to modify the windows firewall configuration using the deprecated netsh firewall command (command still works).     
",defense-evasion,T1562.004,Impair Defenses: Disable or Modify System Firewall
12c0f2fbbae732e1deca4f23c8823a7a,atomic,Rundll32 with Control_RunDLL,"Rundll32.exe loading dll with 'control_rundll' within the command-line, loading a .cpl or another file type related to CVE-2021-40444. 
",defense-evasion,T1218.011,Signed Binary Proxy Execution: Rundll32
fe467fe47ac8270191a18d9811f734ce,atomic,Rundll32 syssetup.dll Execution,"Test execution of a command using rundll32.exe with syssetup.dll. Upon execution, a window saying ""installation failed"" will be opened

Reference: https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSLibraries/Syssetup.yml
",defense-evasion,T1218.011,Signed Binary Proxy Execution: Rundll32
6030515771f31561f2b87d5832743888,atomic,chattr - Remove immutable file attribute,"Remove's a file's `immutable` attribute using `chattr`.
This technique was used by the threat actor Rocke during the compromise of Linux web servers.
",defense-evasion,T1222.002,File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification
6004a80b66c4c3e30595f178d91e2051,atomic,Hex decoding with shell utilities,"Use common shell utilities to decode a hex-encoded text string and echo it to the console
",defense-evasion,T1140,Deobfuscate/Decode Files or Information
59fab1b89fc78dee4436f070209dd6df,atomic,Mimic Ransomware - Allow Multiple RDP Sessions per User,"This test emulates Mimic ransomware's ability to enable multiple RDP sessions per user by modifying the fSingleSessionPerUser value within the Terminal Server registry key. 
See [Mimic Ransomware Overview] (https://www.trendmicro.com/en_us/research/23/a/new-mimic-ransomware-abuses-everything-apis-for-its-encryption-p.html)
",defense-evasion,T1112,Modify Registry
eb9de85953f93fc247c48f1b236839fc,atomic,Office 365 - Exchange Audit Log Disabled,"You can use the Exchange Management Shell to enable or disable mailbox audit logging for a mailbox.
Unified or Admin Audit logs are disabled via the Exchange Powershell cmdline.
https://github.com/Azure/Azure-Sentinel/blob/master/Detections/OfficeActivity/exchange_auditlogdisabled.yaml
",defense-evasion,T1562.008,Impair Defenses: Disable Cloud Logs
ba862ef17f5b9e438915d1cf33abf60a,atomic,Disable Windows Registry Tool,"Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows registry tool to prevent user modifying registry entry.
See example how Agent Tesla malware abuses this technique: https://any.run/report/ea4ea08407d4ee72e009103a3b77e5a09412b722fdef67315ea63f22011152af/a866d7b1-c236-4f26-a391-5ae32213dfc4#registry
",defense-evasion,T1112,Modify Registry
6269167cf683e0a2062696a4b038217f,atomic,Delete system log files using Applescript,"This test deletes the system log file using applescript using osascript via Finder application
Note: The user may be prompted to grant access to the Finder application before the command can be executed successfully as part of TCC(Transparency, Consent, and Control) Framework.
Refer: https://www.rainforestqa.com/blog/macos-tcc-db-deep-dive
",defense-evasion,T1070.002,Indicator Removal on Host: Clear Linux or Mac System Logs
085858a8aa5ea8e6a810e59c75ea7f6a,atomic,Invoke-ATHRemoteFXvGPUDisablementCommand base test,"RemoteFXvGPUDisablement.exe is an abusable, signed PowerShell host executable that was introduced in Windows 10 and Server 2019 (OS Build 17763.1339).

One of the PowerShell functions called by RemoteFXvGPUDisablement.exe is Get-VMRemoteFXPhysicalVideoAdapter, a part of the Hyper-V module. This atomic test influences RemoteFXvGPUDisablement.exe to execute custom PowerShell code by using a technique referred to as ""PowerShell module load-order hijacking"" where a module containing, in this case, an implementation of the Get-VMRemoteFXPhysicalVideoAdapter is loaded first by way of introducing a temporary module into the first directory listed in the %PSModulePath% environment variable or within a user-specified module directory outside of %PSModulePath%. Upon execution the temporary module is deleted.

Invoke-ATHRemoteFXvGPUDisablementCommand is used in this test to demonstrate how a PowerShell host executable can be directed to user-supplied PowerShell code without needing to supply anything at the command-line. PowerShell code execution is triggered when supplying the ""Disable"" argument to RemoteFXvGPUDisablement.exe.

The Invoke-ATHRemoteFXvGPUDisablementCommand function outputs all relevant execution-related artifacts.

Reference: https://github.com/redcanaryco/AtomicTestHarnesses/blob/master/TestHarnesses/T1218_SignedBinaryProxyExecution/InvokeRemoteFXvGPUDisablementCommand.ps1
",defense-evasion,T1218,Signed Binary Proxy Execution
8fe59e288f10a486dc8b44bc872019ff,atomic,Disable Microsoft Defender Firewall via Registry,"Disables the Microsoft Defender Firewall for the public profile via registry
Caution if you access remotely the host where the test runs! Especially with the cleanup command which will re-enable firewall for the current profile...
",defense-evasion,T1562.004,Impair Defenses: Disable or Modify System Firewall
257313a3c93e3bb7dfb60d6753b09e34,atomic,Activate Windows NoFileMenu Group Policy Feature,"Modify the registry of the currently logged in user using reg.exe via cmd console to Remove File menu from Windows Explorer Group Policy. 
Take note that some Group Policy changes might require a restart to take effect.
See how Trojan abuses this technique- https://www.sophos.com/de-de/threat-center/threat-analyses/viruses-and-spyware/Troj~Krotten-N/detailed-analysis
",defense-evasion,T1112,Modify Registry
ae1510936a20ac31014eb86e5b4944ce,atomic,Invoke CHM Shortcut Command with ITS and Help Topic,"Executes a CHM file using the Shortcut Command method with a defined ITS Protocol Handler, and help topic extension.",defense-evasion,T1218.001,Signed Binary Proxy Execution: Compiled HTML File
8a60db80ab6f4a6b1db758c95bacfafa,atomic,Edit UFW firewall ufw.conf file,"Edit the Uncomplicated Firewall (UFW) configuration file /etc/ufw/ufw.conf 
which controls if the firewall starts on boot and its logging level.
",defense-evasion,T1562.004,Impair Defenses: Disable or Modify System Firewall
7a6e495200cd37c66f02e7bc070b61a9,atomic,Add domain to Trusted sites Zone,"Attackers may add a domain to the trusted site zone to bypass defenses. Doing this enables attacks such as c2 over office365.
Upon execution, details of the new registry entries will be displayed.
Additionally, open Registry Editor to view the modified entry in HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap\.

https://www.blackhat.com/docs/us-17/wednesday/us-17-Dods-Infecting-The-Enterprise-Abusing-Office365-Powershell-For-Covert-C2.pdf
",defense-evasion,T1112,Modify Registry
8beb34c915b17873e357c030d517be0a,atomic,Disable .NET Event Tracing for Windows Via Registry (powershell),Disables ETW for the .NET Framework using PowerShell to update the Windows registry,defense-evasion,T1562.006,Impair Defenses: Indicator Blocking
f4d3c5648b8d2fab9b061016eb91f478,atomic,Snake Malware Registry Blob,"The following Atomic Test creates a registry blob in HKLM:\SOFTWARE\Classes\.wav\OpenWithProgIds, which is related to Snake Malware. Per the report, upon execution, Snake's WerFault.exe will attempt to decrypt an encrypted blob within the Windows
registry that is typically found at HKLM:\SOFTWARE\Classes\.wav\OpenWithProgIds. The encrypted data includes the AES key, IV, and path that is used to find and decrypt the file containing Snake's kernel driver and kernel driver loader.
",defense-evasion,T1112,Modify Registry
96030a3a84fc75385362f617843bb1ef,atomic,Disable Windows Auto Reboot for current logon user,"Disable Windows Auto Reboot for current logon user. Redline is using this as part of its defense evasion.
",defense-evasion,T1112,Modify Registry
0f9a074d436196d0796e2cb3ecb964e8,atomic,Logging Configuration Changes on Linux Host,"Emulates modification of syslog configuration.
",defense-evasion,T1562.006,Impair Defenses: Indicator Blocking
f756cf55128c32328f50443164ecaea6,atomic,Disable Windows Shutdown Button,"Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows shutdown button.
See how ransomware abuses this technique- https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/ransom.msil.screenlocker.a/
",defense-evasion,T1112,Modify Registry
037e77f3c330580a9fce977cb308966b,atomic,Renamed Microsoft.Workflow.Compiler.exe Payload Executions,"Emulates attack with a renamed Microsoft.Workflow.Compiler.exe running a .Net assembly that launches calc.exe
",defense-evasion,T1218,Signed Binary Proxy Execution
c9bea46c8cb460a401d5167e9ee3bfe2,atomic,Regsvr32 remote COM scriptlet execution,"Regsvr32.exe is a command-line program used to register and unregister OLE controls. This test may be blocked by windows defender; disable
windows defender real-time protection to fix it. Upon execution, calc.exe will be launched.
",defense-evasion,T1218.010,Signed Binary Proxy Execution: Regsvr32
9d21f3b551b40fa40056af1244af56ee,atomic,Add Root Certificate to CurrentUser Certificate Store,"The following Atomic test simulates adding a generic non-malicious certificate to the CurrentUser certificate store. This behavior generates a registry modification that adds the cloned root CA certificate in the keys outlined in the blog.
Keys will look like - \SystemCertificates\CA\Certificates or \SystemCertificates\Root\Certificates
Reference: https://posts.specterops.io/code-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec
",defense-evasion,T1553.004,Subvert Trust Controls: Install Root Certificate
c71ae2939195beabaf5fe020c958978d,atomic,WMIC bypass using local XSL file,"Executes the code specified within a XSL script using a local payload.
",defense-evasion,T1220,XSL Script Processing
35200ef3d7ca094ae2208a1df03ede18,atomic,Invoke HTML Application - JScript Engine with Inline Protocol Handler,Executes an HTA Application with JScript Engine and Inline Protocol Handler.,defense-evasion,T1218.005,Signed Binary Proxy Execution: Mshta
bf9cc3d98c38f79c948a0f4a7f888034,atomic,Invoke HTML Application - Jscript Engine over Local UNC Simulating Lateral Movement,Executes an HTA Application using JScript script engine using local UNC path simulating lateral movement.,defense-evasion,T1218.005,Signed Binary Proxy Execution: Mshta
b0f287b8da3b5ad8619f8b7102cf4ee7,atomic,Msiexec.exe - Execute Local MSI file with embedded VBScript,"Executes an MSI containing embedded VBScript code using msiexec.exe
",defense-evasion,T1218.007,Signed Binary Proxy Execution: Msiexec
a04b2cbd5fa6ea93e8ba16793ec6dc3e,atomic,CMSTP Executing UAC Bypass,"Adversaries may invoke cmd.exe (or other malicious commands) by embedding them in the RunPreSetupCommandsSection of an INF file
",defense-evasion,T1218.003,Signed Binary Proxy Execution: CMSTP
2413b013bc82d152765e2ac34601a327,atomic,Delete Prefetch File,"Delete a single prefetch file.  Deletion of prefetch files is a known anti-forensic technique. To verify execution, Run ""(Get-ChildItem -Path ""$Env:SystemRoot\prefetch\*.pf"" | Measure-Object).Count""
before and after the test to verify that the number of prefetch files decreases by 1.
",defense-evasion,T1070.004,Indicator Removal on Host: File Deletion
5ce7021ba9047ccd38a91c3a99723e2e,atomic,Disable SELinux,"Disables SELinux enforcement
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
6401e9fc7007569199a38703f0aa0f0f,atomic,Setting the HISTFILE environment variable,"An Adversary may clear, unset or redirect the history environment variable HISTFILE to prevent logging of commands to the history file after they log out of the system.

Note: we don't wish to log out, so we are just confirming the value of HISTFILE. In this test we 1. echo HISTFILE 2. set it to /dev/null 3. confirm that HISTFILE is set to /dev/null.
",defense-evasion,T1562.003,Impair Defenses: HISTCONTROL
98ada74a54f1ac18e4201c372c0ef8ad,atomic,DLP Evasion via Sensitive Data in VBA Macro over email,"Upon successful execution, an excel containing VBA Macro containing sensitive data will be sent outside the network using email.
Sensitive data includes about around 20 odd simulated credit card numbers that passes the LUHN check.
",defense-evasion,T1027,Obfuscated Files or Information
6b79b62b7bc6508698502e822ed01c79,atomic,Regsvr32 Silent DLL Install Call DllRegisterServer,"Regsvr32.exe is a command-line program used to register and unregister OLE controls. Normally, an install is executed with /n to prevent calling DllRegisterServer.",defense-evasion,T1218.010,Signed Binary Proxy Execution: Regsvr32
7a0717485ca13c441d26bfaaa5c92535,atomic,Disable Windows IIS HTTP Logging via PowerShell,"Disables HTTP logging on a Windows IIS web server as seen by Threat Group 3390 (Bronze Union).
This action requires HTTP logging configurations in IIS to be unlocked.

Use the cleanup commands to restore some default auditpol settings (your original settings will be lost)
",defense-evasion,T1562.002,Impair Defenses: Disable Windows Event Logging
2f5cf8c3e8a3a3e6e5621e8f77c5bf65,atomic,"Binary packed by UPX, with modified headers","Copies and then runs a simple binary (just outputting ""the cake is a lie""), that was packed by UPX.

The UPX magic number (`0x55505821`, ""`UPX!`"") was changed to (`0x4c4f5452`, ""`LOTR`""). This prevents the binary from being detected
by some methods, and especially UPX is not able to uncompress it any more.
",defense-evasion,T1027.002,Obfuscated Files or Information: Software Packing
18348573c1f989a6cca9e9bf10809700,atomic,Malicious process Masquerading as LSM.exe,"Detect LSM running from an incorrect directory and an incorrect service account
This works by copying cmd.exe to a file, naming it lsm.exe, then copying a file to the C:\ folder.

Upon successful execution, cmd.exe will be renamed as lsm.exe and executed from non-standard path.
",defense-evasion,T1036.003,Masquerading: Rename System Utilities
f68c7284a0d5faf3fc9dfa8c67db0586,atomic,Lolbin Jsc.exe compile javascript to dll,"Use jsc.exe to compile javascript code stored in Library.js and output Library.dll.
https://lolbas-project.github.io/lolbas/Binaries/Jsc/
https://www.phpied.com/make-your-javascript-a-windows-exe/
",defense-evasion,T1127,Trusted Developer Utilities Proxy Execution
f1222384fe40cc71e7dea9d182014eaf,atomic,Hidden Window,"Launch PowerShell with the ""-WindowStyle Hidden"" argument to conceal PowerShell windows by setting the WindowStyle parameter to hidden.
Upon execution a hidden PowerShell window will launch calc.exe
",defense-evasion,T1564.003,Hide Artifacts: Hidden Window
c29edb8de0232248355c1911983620b1,atomic,Delete Windows Defender Scheduled Tasks,"The following atomic test will delete the Windows Defender scheduled tasks.

[Reference](https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/)
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
84457d914b35ebe7b506e70b66067f6b,atomic,Create Windows System File with Attrib,"Creates a file and marks it as a system file using the attrib.exe utility. Upon execution, open the file in file explorer then open Properties > Details
and observe that the Attributes are ""SA"" for System and Archive.
",defense-evasion,T1564.001,Hide Artifacts: Hidden Files and Directories
e2ef55e9867a99e2f056a73c041c1d7e,atomic,Windows - Modify file last access timestamp with PowerShell,"Modifies the last access timestamp of a specified file. This technique was seen in use by the Stitch RAT.
To verify execution, use File Explorer to view the Properties of the file and observe that the Accessed time is the year 1970.
",defense-evasion,T1070.006,Indicator Removal on Host: Timestomp
81f7dd9fd2c503588bbe15ea0a144294,atomic,AWS - CloudTrail Changes,"Creates a new cloudTrail in AWS, Upon successful creation it will Update,Stop and Delete the cloudTrail
",defense-evasion,T1562.008,Impair Defenses: Disable Cloud Logs
8b71e899ab6e719d4ce6e0f7c9ac85ca,atomic,Disable Arbitrary Security Windows Service,"With administrative rights, an adversary can disable Windows Services related to security products. This test requires McAfeeDLPAgentService to be installed.
Change the service_name input argument for your AV solution. Upon exeuction, infomration will be displayed stating the status of the service.
To verify that the service has stopped, run ""sc query McAfeeDLPAgentService""
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
627f499ceb32e74b95494141bc680e08,atomic,Invoke CHM with Script Engine and Help Topic,"Executes a CHM file with a defined script engine, ITS Protocol Handler, and help topic extension.",defense-evasion,T1218.001,Signed Binary Proxy Execution: Compiled HTML File
f86efd3fbbde634b600d0c5bbd2bd2fe,atomic,Setting the HISTIGNORE environment variable,"An Adversary may take advantage of the HISTIGNORE environment variable either to ignore particular commands or all commands. 

In this test we 1. set HISTIGNORE to ignore ls, rm and ssh commands 2. clear this history cache 3..4 execute ls commands 5. confirm that the ls commands are not in the history cache 6. unset HISTIGNORE variable 7.. same again, but ignoring ALL commands.
",defense-evasion,T1562.003,Impair Defenses: HISTCONTROL
bd5ee87126c38b409c12f823ec4469c2,atomic,Opening ports for proxy - HARDRAIN,"This test creates a listening interface on a victim device. This tactic was used by HARDRAIN for proxying.

reference: https://www.us-cert.gov/sites/default/files/publications/MAR-10135536-F.pdf
",defense-evasion,T1562.004,Impair Defenses: Disable or Modify System Firewall
486d482ab75183d12a011b1adea22a4a,atomic,Delete Filesystem - Linux,"This test deletes the entire root filesystem of a Linux system. This technique was used by Amnesia IoT malware to avoid analysis. This test is dangerous and destructive, do NOT use on production equipment.
",defense-evasion,T1070.004,Indicator Removal on Host: File Deletion
6fdc9037290299164d52b65219d628ef,atomic,Masquerading - non-windows exe running as windows exe,"Copies an exe, renames it as a windows exe, and launches it to masquerade as a real windows exe

Upon successful execution, powershell will execute T1036.003.exe as svchost.exe from on a non-standard path.
",defense-evasion,T1036.003,Masquerading: Rename System Utilities
d7c027c49b9819c836e9533c8d96eaaa,atomic,Remove Network Share,"Removes a Network Share utilizing the command_prompt
",defense-evasion,T1070.005,Indicator Removal on Host: Network Share Connection Removal
5b0527d3382ac91860501cccc9595348,atomic,Create and start Hyper-V virtual machine,"Create a simple Hyper-V VM (Windows native hypervisor) and start up the machine
Cleanup command stops and deletes the newly created VM
https://docs.microsoft.com/en-us/virtualization/hyper-v-on-windows/quick-start/enable-hyper-v
https://embracethered.com/blog/posts/2020/shadowbunny-virtual-machine-red-teaming-technique/
https://attack.mitre.org/techniques/T1564/006/
",defense-evasion,T1564.006,Run Virtual Instance
eca315e7b5064744f5bf5ffa39a7560c,atomic,Rundll32 execute VBscript command using Ordinal number,"Test execution of a command using rundll32.exe and VBscript in a similar manner to the JavaScript test.
Technique documented by Hexacorn- http://www.hexacorn.com/blog/2019/10/29/rundll32-with-a-vbscript-protocol/
Upon execution calc.exe will be launched
",defense-evasion,T1218.011,Signed Binary Proxy Execution: Rundll32
e5ca57d20f8608e2acc0808b8dd8726c,atomic,Mshta executes VBScript to execute malicious command,"Run a local VB script to run local user enumeration powershell command.
This attempts to emulate what FIN7 does with this technique which is using mshta.exe to execute VBScript to execute malicious code on victim systems.
Upon execution, a new PowerShell windows will be opened that displays user information.
",defense-evasion,T1218.005,Signed Binary Proxy Execution: Mshta
dff11c1e8340bbae0245b866917889af,atomic,Msiexec.exe - Execute Remote MSI file,"Execute arbitrary MSI file retrieved remotely. Less commonly seen in application installation, commonly seen in malware execution. The MSI executes a built-in JScript payload that launches powershell.exe.
",defense-evasion,T1218.007,Signed Binary Proxy Execution: Msiexec
ddc68247897068b0e9afb5e1ecd254d1,atomic,Install root CA on CentOS/RHEL,"Creates a root CA with openssl
",defense-evasion,T1553.004,Subvert Trust Controls: Install Root Certificate
7e4a00e15142a1c5edb9dd0ecc86f1d3,atomic,Masquerading - cscript.exe running as notepad.exe,"Copies cscript.exe, renames it, and launches it to masquerade as an instance of notepad.exe.

Upon successful execution, cscript.exe is renamed as notepad.exe and executed from non-standard path.
",defense-evasion,T1036.003,Masquerading: Rename System Utilities
647e4465558374490275ec1e6892902a,atomic,AWS - Disable CloudTrail Logging Through Event Selectors using Stratus,"Update event selectors in AWS CloudTrail to disable the logging of certain management events to evade defense. This Atomic test leverages a tool called Stratus-Red-Team built by DataDog (https://github.com/DataDog/stratus-red-team). Stratus Red Team is a self-contained binary. You can use it to easily detonate offensive attack techniques against a live cloud environment. Ref: https://stratus-red-team.cloud/attack-techniques/AWS/aws.defense-evasion.cloudtrail-event-selectors/
",defense-evasion,T1562.008,Impair Defenses: Disable Cloud Logs
a981a99ef7c8ad9d1960a8bcb413bc51,atomic,Disable OpenDNS Umbrella,"Disables OpenDNS Umbrella
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
18d69a8fd988d6b63f5307ce857723c9,atomic,Set Custom AddToHistoryHandler to Avoid History File Logging,"The ""AddToHistoryHandler"" receives the current command as the $line variable and then returns $true if 
the line should be written to the history file. Here we simply return $false so nothing gets added to 
the history file for the current session. 
",defense-evasion,T1070.003,Indicator Removal on Host: Clear Command History
40c845837d06a51ff93c3449d6e00648,atomic,MSBuild Bypass Using Inline Tasks (VB),"Executes the code in a project file using msbuild.exe. The default Visual Basic example file (vb.xml) will simply print ""Hello from a Visual Basic inline task!"" to the screen.
",defense-evasion,T1127.001,Trusted Developer Utilities Proxy Execution: MSBuild
197a322f46033d8c1e5011967a0bce41,atomic,Remove Windows Defender Definition Files,"Removing definition files would cause ATP to not fire for AntiMalware. Check MpCmdRun.exe man page for info on all arguments.
On later viersions of windows (1909+) this command fails even with admin due to inusfficient privelages. On older versions of windows the
command will say completed.

https://unit42.paloaltonetworks.com/unit42-gorgon-group-slithering-nation-state-cybercrime/
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
87820d29cb755efb41e0b9543ab0f649,atomic,Disable LittleSnitch,"Disables LittleSnitch
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
caba55db8a5579c5244fd6cc7e3574df,atomic,Do Not Connect To Win Update,"Do Not Connect To Win Update. Redline is using this as part of its defense evasion.
",defense-evasion,T1112,Modify Registry
c01780a26cb87c321879cb4b8527ee6f,atomic,Turn off UFW logging,"Turn off the Uncomplicated Firewall (UFW) logging. 
",defense-evasion,T1562.004,Impair Defenses: Disable or Modify System Firewall
7b7c4e56566e5c917c5e0bbaaef4f1c5,atomic,Disable Event Logging with wevtutil,"Wevtutil can be used to disable logs. 
NOTE: RansomEXX ransomware uses this to disable Security logs post-encryption.
",defense-evasion,T1562.002,Impair Defenses: Disable Windows Event Logging
689b764ccd17d8c4b587ce1a6f73cd65,atomic,chown - Change file or folder mode ownership only,"Changes a file or folder's ownership only using chown.
",defense-evasion,T1222.002,File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification
0b70a0fd3c25e63253ad773c36cb00f2,atomic,Loadable Kernel Module based Rootkit,"Loadable Kernel Module based Rootkit
",defense-evasion,T1014,Rootkit
d7bfcab15b9612dd53a15a4d8fc73633,atomic,CMSTP Executing Remote Scriptlet,"Adversaries may supply CMSTP.exe with INF files infected with malicious commands
",defense-evasion,T1218.003,Signed Binary Proxy Execution: CMSTP
b3f5118a34b5aa8eee17a0344e815b77,atomic,Disable history collection,"Disables history collection in shells
",defense-evasion,T1562.003,Impair Defenses: HISTCONTROL
b8a4225aa3022f4bde3d812c250f7217,atomic,Loadable Kernel Module based Rootkit (Diamorphine),"Loads Diamorphine kernel module, which hides itself and a processes.
",defense-evasion,T1014,Rootkit
7de3d7b4922a7b996d8df36fb22bb118,atomic,Creating W32Time similar named service using schtasks,"Creating W32Time similar named service (win32times) using schtasks just like threat actor dubbed ""Operation Wocao""",defense-evasion,T1036.004,Masquerading: Masquerade Task or Service
6621c3d77cfc40676e5ff46af37ceb4e,atomic,Lolbas ie4uinit.exe use as proxy,"Executes commands from a specially prepared ie4uinit.inf file.
Poc from : https://bohops.com/2018/03/10/leveraging-inf-sct-fetch-execute-techniques-for-bypass-evasion-persistence-part-2/
Reference: https://lolbas-project.github.io/lolbas/Binaries/Ie4uinit/
",defense-evasion,T1218,Signed Binary Proxy Execution
5b1aea789aa50c07bb5555dcff5d42a6,atomic,Invoke CHM with InfoTech Storage Protocol Handler,Executes a CHM file with the ITS protocol handler.,defense-evasion,T1218.001,Signed Binary Proxy Execution: Compiled HTML File
8e7c28877a9c7826fece190f185b534c,atomic,Use Space Before Command to Avoid Logging to History,"Using a space before a command causes the command to not be logged in the Bash History file
",defense-evasion,T1070.003,Indicator Removal on Host: Clear Command History
6fa417fb183d6c20a67e617c0249f04f,atomic,Delete System Logs Using Clear-EventLog,"Clear event logs using built-in PowerShell commands.
Upon successful execution, you should see the list of deleted event logs
Upon execution, open the Security.evtx logs at C:\Windows\System32\winevt\Logs and verify that it is now empty or has very few logs in it.
",defense-evasion,T1070.001,Indicator Removal on Host: Clear Windows Event Logs
e0edd5aef59c72e31fb14e12a26a5066,atomic,InstallUtil Install method call,"Executes the Install Method. Upon execution, version information will be displayed the .NET framework install utility.
",defense-evasion,T1218.004,Signed Binary Proxy Execution: InstallUtil
6b01af3fd822ab73c2e84ad51a4be6cb,atomic,Enabling Remote Desktop Protocol via Remote Registry,"Enabling RDP through remote registry.
",defense-evasion,T1112,Modify Registry
3f465c72d351789eda3a553334fa43f3,atomic,Clear bash history,"An attacker may clear the bash history cache and the history file as their last act before logging off to remove the record of their command line activities. 

In this test we use the $HISTFILE variable throughout to 1. confirms the $HISTFILE variable is set 2. echo """" into it 3..5 confirm the file is empty 6 clear the history cache 7. confirm the history cache is empty. This is when the attacker would logoff.
",defense-evasion,T1562.003,Impair Defenses: HISTCONTROL
290cb263b74af11c6be2e7345072f05b,atomic,DLP Evasion via Sensitive Data in VBA Macro over HTTP,"Upon successful execution, an excel containing VBA Macro containing sensitive data will be sent outside the network using HTTP.
Sensitive data includes about around 20 odd simulated credit card numbers that passes the LUHN check.
",defense-evasion,T1027,Obfuscated Files or Information
5b93df032e230056c21a3e57334f77d1,atomic,Disable Microsoft Defender Firewall,"Disables the Microsoft Defender Firewall for the current profile.
Caution if you access remotely the host where the test runs! Especially with the cleanup command which will re-enable firewall for the current profile...
",defense-evasion,T1562.004,Impair Defenses: Disable or Modify System Firewall
80e752c5fc69a56ccb86bc90efc5eff6,atomic,Read volume boot sector via DOS device path (PowerShell),"This test uses PowerShell to open a handle on the drive volume via the `\\.\` [DOS device path specifier](https://docs.microsoft.com/en-us/dotnet/standard/io/file-path-formats#dos-device-paths) and perform direct access read of the first few bytes of the volume.
On success, a hex dump of the first 11 bytes of the volume is displayed.

For a NTFS volume, it should correspond to the following sequence ([NTFS partition boot sector](https://en.wikipedia.org/wiki/NTFS#Partition_Boot_Sector_(VBR))):
```
           00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F

00000000   EB 52 90 4E 54 46 53 20 20 20 20                 ëR?NTFS
```",defense-evasion,T1006,Direct Volume Access
1a35d5a1ced99d3e5e764ac6f5ba727f,atomic,dynamic-linker based rootkit (libprocesshider),"Uses libprocesshider to simulate rootkit behavior by hiding a specific process name via ld.so.preload (see also T1574.006).
",defense-evasion,T1014,Rootkit
2cef8bdaa82b0487e8e8456867a9decf,atomic,Take ownership using takeown utility,"Modifies the filesystem permissions of the specified file or folder to take ownership of the object. Upon execution, ""SUCCESS"" will
be displayed for the folder and each file inside of it.
",defense-evasion,T1222.001,File and Directory Permissions Modification: Windows File and Directory Permissions Modification
c0d2e758c07d1ecb991ac940c3b6db73,atomic,Windows Auto Update Option to Notify before download,"Windows Auto Update Option to Notify before download. Redline is using this as part of its defense evasion.
",defense-evasion,T1112,Modify Registry
c228f0926d39e1ed5cfe8343adc1e684,atomic,Windows Add Registry Value to Load Service in Safe Mode with Network,"Modify the registry to allow a driver, service, to persist in Safe Mode with networking.
see https://redcanary.com/blog/tracking-driver-inventory-to-expose-rootkits/ and https://blog.didierstevens.com/2007/03/26/playing-with-safe-mode/ for further details.
Adding a subkey to Netowrk with the name of your service and a default value set to Service, makes that your service will be started when you boot into Safe Mode with networking.
",defense-evasion,T1112,Modify Registry
5e4bd19a25040d3b9f7ecb61bec62f22,atomic,Windows - Modify file creation timestamp with PowerShell,"Modifies the file creation timestamp of a specified file. This technique was seen in use by the Stitch RAT.
To verify execution, use File Explorer to view the Properties of the file and observe that the Created time is the year 1970.
",defense-evasion,T1070.006,Indicator Removal on Host: Timestomp
fc919667b226b75eafa70b29f8f5e4f7,atomic,Msiexec.exe - Execute Local MSI file with embedded JScript,"Executes an MSI containing embedded JScript code using msiexec.exe
",defense-evasion,T1218.007,Signed Binary Proxy Execution: Msiexec
bab3a50e36d534d94b648d47a9d67e11,atomic,Copy and Modify Mailbox Data on Linux,"Copies and modifies mail data on Linux
",defense-evasion,T1070.008,Email Collection: Mailbox Manipulation
7a0e720d1f695b05af9f1b9cfb83d481,atomic,Overwrite macOS system log via echo utility,"This test overwrites the contents of system log file with an empty string using echo utility
",defense-evasion,T1070.002,Indicator Removal on Host: Clear Linux or Mac System Logs
6a8261d005f99ebd1de200d3cb11cef5,atomic,HTML Smuggling Remote Payload,"The HTML file will download an ISO file from [T1553.005](https://github.com/redcanaryco/atomic-red-team/blob/d0dad62dbcae9c60c519368e82c196a3db577055/atomics/T1553.005/bin/FeelTheBurn.iso) without userinteraction. 
The HTML file is based off of the work from [Stan Hegt](https://outflank.nl/blog/2018/08/14/html-smuggling-explained/)
",defense-evasion,T1027.006,HTML Smuggling
57c937f19b6539e983cb807ad74e9cd8,atomic,Tail the UFW firewall log file,"Print  the last 10 lines of the Uncomplicated Firewall (UFW) log file 
/var/log/ufw.log.
",defense-evasion,T1562.004,Impair Defenses: Disable or Modify System Firewall
379509c4b83f252bc779446f0512e936,atomic,Create a hidden file in a hidden directory,"Creates a hidden file inside a hidden directory
",defense-evasion,T1564.001,Hide Artifacts: Hidden Files and Directories
1c4576eb8d4cea58c18e4b087d9c9ac0,atomic,Microsoft.Workflow.Compiler.exe Payload Execution,"Emulates attack with Microsoft.Workflow.Compiler.exe running a .Net assembly that launches calc.exe
",defense-evasion,T1218,Signed Binary Proxy Execution
4ac711084ed7c8c6594c680874eaf931,atomic,Disable journal logging via sed utility,"The atomic test disables the journal logging by searching and replacing the ""Storage"" parameter to ""none"" within the journald.conf file, thus any new journal entries will only be temporarily available in memory and not written to disk
",defense-evasion,T1562,Impair Defenses
728053b8e56bf06f4d19ceac871fcb6c,atomic,Msiexec.exe - Execute Local MSI file with an embedded EXE,"Executes an MSI containing an embedded EXE using msiexec.exe
",defense-evasion,T1218.007,Signed Binary Proxy Execution: Msiexec
9e1fc72961c8e98bc89feeac0b6652e2,atomic,Overwrite Linux Mail Spool,"This test overwrites the Linux mail spool of a specified user. This technique was used by threat actor Rocke during the exploitation of Linux web servers.
",defense-evasion,T1070.002,Indicator Removal on Host: Clear Linux or Mac System Logs
392e12d6a466407e28d1bb51cf0729bb,atomic,AMSI Bypass - Remove AMSI Provider Reg Key,"With administrative rights, an adversary can remove the AMSI Provider registry key in HKLM\Software\Microsoft\AMSI to disable AMSI inspection.
This test removes the Windows Defender provider registry key. Upon execution, no output is displayed.
Open Registry Editor and navigate to ""HKLM:\SOFTWARE\Microsoft\AMSI\Providers\"" to verify that it is gone.
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
e6db40aa05312412b84b482ed2bad92d,atomic,Delete log files via cat utility by appending /dev/null or /dev/zero,"The first sub-test truncates the log file to zero bytes via /dev/null and the second sub-test fills the log file with null bytes(zeroes) via /dev/zero, using cat utility
",defense-evasion,T1070.002,Indicator Removal on Host: Clear Linux or Mac System Logs
c6d6e157f9ff496abfed129dda16fe13,atomic,office-365-Disable-AntiPhishRule,"Using the Disable-AntiPhishRule cmdlet to disable antiphish rules in your office-365 organization.
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
2ecf1916a791a659495a9b8a9367b996,atomic,Windows Modify Show Compress Color And Info Tip Registry,"Modify the registry of the currently logged in user using reg.exe via cmd console to show compress color and show tips feature. 
See how hermeticwiper uses this technique - https://www.splunk.com/en_us/blog/security/detecting-hermeticwiper.html
",defense-evasion,T1112,Modify Registry
53fc12696bbc0d92d0311e8b40858735,atomic,Delete log files using built-in log utility,"This test deletes main log datastore, inflight log data, time-to-live data(TTL), fault and error content
",defense-evasion,T1070.002,Indicator Removal on Host: Clear Linux or Mac System Logs
c1bbc29a5415bbc59d16c6959b421c65,atomic,Enabling Restricted Admin Mode via Command_Prompt,"Enabling Restricted Admin Mode via Command_Prompt,enables an attacker to perform a pass-the-hash attack using RDP.

See [Passing the Hash with Remote Desktop](https://www.kali.org/blog/passing-hash-remote-desktop/)
",defense-evasion,T1112,Modify Registry
fe79f112d59b556ca99033eedcadbf77,atomic,Copy and Delete Mailbox Data on Linux,"Copies and deletes mail data on Linux
",defense-evasion,T1070.008,Email Collection: Mailbox Manipulation
609ae2466dfa661ac22a8d3a1c15d16a,atomic,Disable Win Defender Notification,"Disable Win Defender Notification. Redline is using this to disable this win defender feature.
",defense-evasion,T1112,Modify Registry
58ef43e598c111afc81ba9a22c6af108,atomic,Base64 decoding with Python,"Use Python to decode a base64-encoded text string and echo it to the console
",defense-evasion,T1140,Deobfuscate/Decode Files or Information
c0b42b65828121e95e34a7bbf1a004ce,atomic,mavinject - Inject DLL into running process,"Injects arbitrary DLL into running process specified by process ID. Requires Windows 10.
",defense-evasion,T1218,Signed Binary Proxy Execution
fcbaf10bb84ae47998ae094c053bdef8,atomic,Execution from Compressed File,"Mimic execution of compressed executable. When successfully executed, calculator.exe will open.
",defense-evasion,T1027,Obfuscated Files or Information
2801e38623f5a07972c9b2b0562ebc83,atomic,Setting the HISTCONTROL environment variable,"An attacker may exploit the space before a command (e.g. "" ls"") or the duplicate command suppression feature in Bash history to prevent their commands from being recorded in the history file or to obscure the order of commands used. 

In this test we 1. sets $HISTCONTROL to ignoreboth 2. clears the history cache 3. executes ls -la with a space in-front of it 4. confirms that ls -la is not in the history cache 5. sets $HISTCONTROL to erasedups 6. clears the history cache 7..9 executes ls -la $HISTFILE 3 times 10. confirms that their is only one command in history
",defense-evasion,T1562.003,Impair Defenses: HISTCONTROL
77d396b6c029a11722969cb578f591d3,atomic,Delete a single file - Windows cmd,"Delete a single file from the temporary directory using cmd.exe.
Upon execution, no output will be displayed. Use File Explorer to verify the file was deleted.
",defense-evasion,T1070.004,Indicator Removal on Host: File Deletion
aa758d17faffeeb69c56481340891859,atomic,WinPwn - Reflectively load Mimik@tz into memory,Reflectively load Mimik@tz into memory technique via function of WinPwn,defense-evasion,T1620,Reflective Code Loading
3ac22c2973506d82eae54d914e69b193,atomic,Windows HideSCAPower Group Policy Feature,"Modify the registry of the currently logged in user using reg.exe via cmd console to remove the battery icon Group Policy. 
Take note that some Group Policy changes might require a restart to take effect.
See how ransomware abuses this technique- https://www.virustotal.com/gui/file/2d7855bf6470aa323edf2949b54ce2a04d9e38770f1322c3d0420c2303178d91/details
",defense-evasion,T1112,Modify Registry
e30d392a79640eb86ee5fedd78416a33,atomic,Execution of HTA and VBS Files using Rundll32 and URL.dll,"IcedID uses this TTP as follows:
  rundll32.exe url.dll,OpenURL %PUBLIC%\index.hta
Trickbot uses this TTP as follows:
  rundll32.exe URL.dll,FileProtocolHandler C:\\..\\Detail\\akteullen.vbs

In this atomic, the sample hta file opens the calculator and the vbs file shows a message dialog with ""rundll32 spawned wscript""
",defense-evasion,T1218.011,Signed Binary Proxy Execution: Rundll32
d38cba2905e62b4c1a7e5c88137ce485,atomic,Linux Base64 Encoded Shebang in CLI,"Using Linux Base64 Encoded shell scripts that have Shebang in them. This is commonly how attackers obfuscate passing and executing a shell script. Seen [here](https://www.trendmicro.com/pl_pl/research/20/i/the-evolution-of-malicious-shell-scripts.html) by TrendMicro, as well as [LinPEAS](https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS). Also a there is a great Sigma rule [here](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/process_creation/proc_creation_lnx_base64_shebang_cli.yml) for it. 
",defense-evasion,T1140,Deobfuscate/Decode Files or Information
f01d06af8bd1a70684c2bbb341f90eb3,atomic,WMI Win32_Product Class - Execute Local MSI file with an embedded EXE,"Executes an MSI containing an embedded EXE using the WMI Win32_Product class
",defense-evasion,T1218.007,Signed Binary Proxy Execution: Msiexec
0e0bf52a7d3c64d3b9c8a6106bf92926,atomic,rm -rf,"Delete system and audit logs
",defense-evasion,T1070.002,Indicator Removal on Host: Clear Linux or Mac System Logs
d2f6cb279552f1b65a9805d63eed1689,atomic,BlackByte Ransomware Registry Changes - Powershell,"This task recreates the steps taken by BlackByte ransomware before it worms to other machines via Powershell.  See ""Preparing to Worm"" section: https://redcanary.com/blog/blackbyte-ransomware/
The steps are as follows:
<ol>
    <li>1. Elevate Local Privilege by disabling UAC Remote Restrictions</li>
    <li>2. Enable OS to share network connections between different privilege levels</li>
    <li>3. Enable long path values for file paths, names, and namespaces to ensure encryption of all file names and paths</li>
</ol>
The registry keys and their respective values will be created upon successful execution.
",defense-evasion,T1112,Modify Registry
cee5c12d61e0f0e4f6614d23330f2384,atomic,Decompile Local CHM File,"Uses hh.exe to decompile a local compiled HTML Help file.
Upon successful execution the chm file will decompile to disk.
Reference:https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new/
",defense-evasion,T1218.001,Signed Binary Proxy Execution: Compiled HTML File
e7a987cbef27263e666e5b096488dc55,atomic,BlackByte Ransomware Registry Changes - CMD,"This task recreates the steps taken by BlackByte ransomware before it worms to other machines.  See ""Preparing to Worm"" section: https://redcanary.com/blog/blackbyte-ransomware/
The steps are as follows:
<ol>
    <li>1. Elevate Local Privilege by disabling UAC Remote Restrictions</li>
    <li>2. Enable OS to share network connections between different privilege levels</li>
    <li>3. Enable long path values for file paths, names, and namespaces to ensure encryption of all file names and paths</li>
</ol>
The registry keys and their respective values will be created upon successful execution.
",defense-evasion,T1112,Modify Registry
40480323b4f54b0d1f0b814771ec5776,atomic,LockBit Black - Use Registry Editor to turn on automatic logon -cmd,"LockBit Black - Use Registry Editor to turn on automatic logon
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
492807a41cd2991f59acf9d615e46682,atomic,InstallUtil class constructor method call,"Executes the installer assembly class constructor. Upon execution, version information will be displayed the .NET framework install utility.
",defense-evasion,T1218.004,Signed Binary Proxy Execution: InstallUtil
0fdc205a9f53455b1a14eb367a2d6ab7,atomic,MSBuild Bypass Using Inline Tasks (C#),"Executes the code in a project file using msbuild.exe. The default C# project example file (T1127.001.csproj) will simply print ""Hello From a Code Fragment"" and ""Hello From a Class."" to the screen.
",defense-evasion,T1127.001,Trusted Developer Utilities Proxy Execution: MSBuild
02e52d5a90c23e35b321e471c78c7823,atomic,Delete an entire folder - Windows cmd,"Recursively delete a folder in the temporary directory using cmd.exe.
Upon execution, no output will be displayed. Use File Explorer to verify the folder was deleted.
",defense-evasion,T1070.004,Indicator Removal on Host: File Deletion
cf9f1e588dbaa2fe7062287bcb2315d6,atomic,SyncAppvPublishingServer Signed Script PowerShell Command Execution,"Executes the signed SyncAppvPublishingServer script with options to execute an arbitrary PowerShell command.
Upon execution, calc.exe will be launched.
",defense-evasion,T1216,Signed Script Proxy Execution
1d3d67824a72ebdf9811b3bbcec481a0,atomic,Space After Filename,"Space after filename.
",defense-evasion,T1036.006,Masquerading: Space after Filename
838f5d289636e22c8aa2b36d8462622a,atomic,Event Viewer Registry Modification - Redirection URL,"Modify event viewer registry values to alter the behavior of the online help redirection. Upon opening an event in event viewer and attempting to view the help page for the event, it will open the URL or execute the program defined in the redirection URL registry entry.",defense-evasion,T1112,Modify Registry
0dd0e92f8334f31545e8545065a059da,atomic,Uninstall Sysmon,"Uninstall Sysinternals Sysmon for Defense Evasion
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
8da7c7a6e9a5b3bf95107b38230b09f6,atomic,Store file in Alternate Data Stream (ADS),"Storing files in Alternate Data Stream (ADS) similar to Astaroth malware.
Upon execution cmd will run and attempt to launch desktop.ini. No windows remain open after the test
",defense-evasion,T1564.004,Hide Artifacts: NTFS File Attributes
e3f2eac83f7f8148e53b9f2213830e44,atomic,Disable Windows Lock Workstation Feature,"Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows Lock workstation feature.
See how ransomware abuses this technique- https://www.bleepingcomputer.com/news/security/in-dev-ransomware-forces-you-do-to-survey-before-unlocking-computer/
",defense-evasion,T1112,Modify Registry
ae21aefd2d9933df45a4e55485fbc333,atomic,Rundll32 setupapi.dll Execution,"Test execution of a command using rundll32.exe with setupapi.dll. Upon execution, a windows saying ""installation failed"" will be opened

Reference: https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSLibraries/Setupapi.yml
",defense-evasion,T1218.011,Signed Binary Proxy Execution: Rundll32
0b3075a32ff077d5e0c8212ff796ec36,atomic,Clear Bash history (rm),"Clears bash history via rm
",defense-evasion,T1070.003,Indicator Removal on Host: Clear Command History
a148e685a0a83fb45ee1c4a722905e7c,atomic,Mac Hidden file,"Hide a file on MacOS
",defense-evasion,T1564.001,Hide Artifacts: Hidden Files and Directories
347554800d9fecf541670235a8ec31d9,atomic,Install root CA on macOS,"Creates a root CA with openssl
",defense-evasion,T1553.004,Subvert Trust Controls: Install Root Certificate
791086a91572971cf5462ebdb2c82007,atomic,chown - Change file or folder ownership recursively,"Changes a file or folder's ownership only recursively using chown.
",defense-evasion,T1222.002,File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification
d5bb3cda05ddba230c90c1afb2640379,atomic,WinPwn - Kill the event log services for stealth,Kill the event log services for stealth via function of WinPwn,defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
68158bd952ed22af53a8dbfae9647839,atomic,Disable Memory Swap,"disable swapping of device paging that impaire the compromised host to swap data if the RAM is full. Awfulshred wiper used this technique as an additional 
payload to the compromised host and to make sure that there will be no recoverable data due to swap feature of linux.
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
a8413387ed0d47a4fbd1bdf21359ebc6,atomic,Disable Windows Notification Center,"Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows notification center.
See how remcos rat abuses this technique- https://tccontre.blogspot.com/2020/01/remcos-rat-evading-windows-defender-av.html
",defense-evasion,T1112,Modify Registry
f241bda59261f9930621f38d5ed42abf,atomic,WMIC bypass using remote XSL file,"Executes the code specified within a XSL script using a remote payload. Open Calculator.exe when test successfully executed, while AV turned off.
",defense-evasion,T1220,XSL Script Processing
e74d2fb4ef5fa6c766a4151554033697,atomic,Activate Windows NoDesktop Group Policy Feature,"Modify the registry of the currently logged in user using reg.exe via cmd console to hide all icons on Desktop Group Policy. 
Take note that some Group Policy changes might require a restart to take effect.
See how Trojan abuses this technique- https://www.sophos.com/de-de/threat-center/threat-analyses/viruses-and-spyware/Troj~Krotten-N/detailed-analysis
",defense-evasion,T1112,Modify Registry
c9c5e0ffc0a02e309f7bdf4e2a3e5a65,atomic,Clear history of a bunch of shells,"Clears the history of a bunch of different shell types by setting the history size to zero
",defense-evasion,T1070.003,Indicator Removal on Host: Clear Command History
9d03b18c922b94ebba44d25c430e6e95,atomic,Copy and Delete Mailbox Data on Windows,"Copies and deletes mail data on Windows
",defense-evasion,T1070.008,Email Collection: Mailbox Manipulation
8478297ebb155b34c412a0fde335eccd,atomic,Stop/Start UFW firewall,"Stop the Uncomplicated Firewall (UFW) if installed.
",defense-evasion,T1562.004,Impair Defenses: Disable or Modify System Firewall
e572cf6ff4a756e5549353ca96bed1d6,atomic,Create and start VirtualBox virtual machine,"Create a simple VirtualBox VM and start up the machine
Cleanup command stops and deletes the newly created VM and associated files
https://www.virtualbox.org/manual/ch08.html#vboxmanage-startvm
https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/
https://attack.mitre.org/techniques/T1564/006/
",defense-evasion,T1564.006,Run Virtual Instance
df94858e92a23d274ac1d70133d9150f,atomic,Prevent Powershell History Logging,"Prevents Powershell history
",defense-evasion,T1070.003,Indicator Removal on Host: Clear Command History
1a48502ebf2881017284650f0efec2ba,atomic,Delete system log files using srm utility,"This test securely deletes the system log files individually and recursively using the srm utility.
Install srm using Homebrew with the command: brew install khell/homebrew-srm/srm
Refer: https://github.com/khell/homebrew-srm/issues/1 for installation
",defense-evasion,T1070.002,Indicator Removal on Host: Clear Linux or Mac System Logs
9e45dba442d5aa5c977f2086a09c2d0c,atomic,Ursnif Malware Registry Key Creation,"Ursnif downloads additional modules from the C&C server and saves these in the registry folder HKEY_CURRENT_USER\Software\AppDataLow\Software\Microsoft\
More information - https://blog.trendmicro.com/trendlabs-security-intelligence/phishing-campaign-uses-hijacked-emails-to-deliver-ursnif-by-replying-to-ongoing-threads/
",defense-evasion,T1112,Modify Registry
29b7a018dce0877b3d2292286a0f512f,atomic,Tamper with Windows Defender Command Prompt,"Attempting to disable scheduled scanning and other parts of windows defender atp. These commands must be run as System, so they still fail as administrator.
However, adversaries do attempt to perform this action so monitoring for these command lines can help alert to other bad things going on. Upon execution, ""Access Denied""
will be displayed twice and the WinDefend service status will be displayed.
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
faa0f322531905d388c33f66d6c6a286,atomic,Tamper Win Defender Protection,"Tamper Win Defender Protection. RedLine Stealer is executing another component file to modify this win defender feature in registry. 
Take note that this modification might not be enough to disable this feature but can be a good indicator of malicious process that 
tries to tamper this Win Defender feature settings.
",defense-evasion,T1112,Modify Registry
ec7c28b75e9af98aecb33ce5ae14e8c2,atomic,C compile,"Compile a c file with either gcc or clang on Linux or Macos.
",defense-evasion,,
4bfb5f265a5ce07af6bf10da113af7db,atomic,Activate Windows NoTrayContextMenu Group Policy Feature,"Modify the registry of the currently logged in user using reg.exe via cmd console to Disable context menu for taskbar Group Policy. 
Take note that some Group Policy changes might require a restart to take effect.
See how ransomware abuses this technique- https://www.virustotal.com/gui/file/2d7855bf6470aa323edf2949b54ce2a04d9e38770f1322c3d0420c2303178d91/details
",defense-evasion,T1112,Modify Registry
132984234ad769f2b2a36e2b2e36c97f,atomic,Clear History,"Clear Shell History. This technique only affect the bash shell application. 
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
cfdcd33e3213f9c5a150b8b620d9d0f4,atomic,Allow Executable Through Firewall Located in Non-Standard Location,This test will attempt to allow an executable through the system firewall located in the Users directory,defense-evasion,T1562.004,Impair Defenses: Disable or Modify System Firewall
58e980270c575e1e3b3c782976efa93d,atomic,WMIC Tamper with Windows Defender Evade Scanning Folder,"The following Atomic will attempt to exclude a folder within Defender leveraging WMI
Reference: https://www.bleepingcomputer.com/news/security/gootkit-malware-bypasses-windows-defender-by-setting-path-exclusions/
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
fa93e59e1418d91ce03418913ca80fa7,atomic,Disable Administrative Share Creation at Startup,"Administrative shares are hidden network shares created by Microsoft’s Windows NT operating systems that grant system administrators 
remote access to every disk volume on a network-connected system. These shares are automatically created at started unless they have been
purposefully disabled as is done in this Atomic test. As Microsoft puts it, ""Missing administrative shares typically 
indicate that the computer in question has been compromised by malicious software.""
https://threatpost.com/conti-ransomware-gang-has-full-log4shell-attack-chain/177173/
",defense-evasion,T1070.005,Indicator Removal on Host: Network Share Connection Removal
7736f529851c0c391f598cdeddb5d787,atomic,System log file deletion via find utility,"This test finds and deletes the system log files within /var/log/ directory using various executions(rm, shred, unlink)
",defense-evasion,T1070.002,Indicator Removal on Host: Clear Linux or Mac System Logs
78024e1da21332fdcad99a6f93170d41,atomic,Mount ISO image,"Mounts ISO image downloaded from internet to evade Mark-of-the-Web. Upon successful execution, powershell will download the .iso from the Atomic Red Team repo, and mount the image. The provided sample ISO simply has a Reports shortcut file in it. Reference: https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/
",defense-evasion,T1553.005,Subvert Trust Controls: Mark-of-the-Web Bypass
3a39bf7d2f51a48b68241bcfaaa0ac6a,atomic,Binary simply packed by UPX (linux),"Copies and then runs a simple binary (just outputting ""the cake is a lie""), that was packed by UPX.
No other protection/compression were applied.
",defense-evasion,T1027.002,Obfuscated Files or Information: Software Packing
95828bbf041dab6f9743339122c4b7e1,atomic,MSXSL Bypass using local files,"Executes the code specified within a XSL script tag during XSL transformation using a local payload. 
Requires download of MSXSL. No longer available from Microsoft.
(Available via Internet Archive https://web.archive.org/web/20200825011623/https://www.microsoft.com/en-us/download/details.aspx?id=21714 ) 
Open Calculator.exe when test successfully executed, while AV turned off.
",defense-evasion,T1220,XSL Script Processing
b090e40b24bc742cb16c0224e7ec7065,atomic,Loadable Kernel Module based Rootkit,"Loadable Kernel Module based Rootkit
",defense-evasion,T1014,Rootkit
fa212cd328e284d55b0c4d439b29caa3,atomic,Indirect Command Execution - conhost.exe,"conhost.exe refers to a host process for the console window. It provide an interface between command prompt and Windows explorer.
Executing it through command line can create process ancestry anomalies
[Reference] (http://www.hexacorn.com/blog/2020/05/25/how-to-con-your-host/)
",defense-evasion,T1202,Indirect Command Execution
64099c73cfd2e72b45bf167e755e414c,atomic,Clear and Disable Bash History Logging,"Clears the history and disable bash history logging of the current shell and future shell sessions
",defense-evasion,,
6b895fe897f459d889a8506746095cf7,atomic,Overwrite Linux Log,"This test overwrites the specified log. This technique was used by threat actor Rocke during the exploitation of Linux web servers.
",defense-evasion,,
3dcf8448a2a037af9d52abdc4199094f,atomic,Windows HideSCANetwork Group Policy Feature,"Modify the registry of the currently logged in user using reg.exe via cmd console to remove the networking icon Group Policy. 
Take note that some Group Policy changes might require a restart to take effect.
See how ransomware abuses this technique- https://www.virustotal.com/gui/file/2d7855bf6470aa323edf2949b54ce2a04d9e38770f1322c3d0420c2303178d91/details
",defense-evasion,T1112,Modify Registry
10a8f500acd733bb4732b9a5236d50b2,atomic,InstallUtil evasive invocation,"Executes an InstallUtil assembly by renaming InstallUtil.exe and using a nonstandard extension for the assembly. Upon execution, ""Running a transacted installation.""
will be displayed, along with other information about the opperation. ""The transacted install has completed."" will be displayed upon completion.
",defense-evasion,T1218.004,Signed Binary Proxy Execution: InstallUtil
ba6f6214dbd17c54001e0a163b60f151,atomic,Activate Windows NoSetTaskbar Group Policy Feature,"Modify the registry of the currently logged in user using reg.exe via cmd console to Disable changes to Taskbar and Start Menu Settings Group Policy. 
Take note that some Group Policy changes might require a restart to take effect.
See how ransomware abuses this technique- https://www.virustotal.com/gui/file/2d7855bf6470aa323edf2949b54ce2a04d9e38770f1322c3d0420c2303178d91/details
",defense-evasion,T1112,Modify Registry
bdc2a80d621d3361ea727008644b1d15,atomic,Copy and Modify Mailbox Data on Windows,"Copies and modifies mail data on Windows
",defense-evasion,T1070.008,Email Collection: Mailbox Manipulation
7f0f5471543a6f188b0fbdc436c49fd9,atomic,Remove the Zone.Identifier alternate data stream,"Remove the Zone.Identifier alternate data stream which identifies the file as downloaded from the internet.
Removing this allows more freedom in executing scripts in PowerShell and avoids opening files in protected view.
",defense-evasion,T1553.005,Subvert Trust Controls: Mark-of-the-Web Bypass
b66a6eed7d46ab2ca4c3bf1ae3b61f44,atomic,Disable Microsoft Office Security Features,"Gorgon group may disable Office security features so that their code can run. Upon execution, an external document will not
show any warning before editing the document.


https://unit42.paloaltonetworks.com/unit42-gorgon-group-slithering-nation-state-cybercrime/
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
5c4ea84c2b050f1f8b6f880755ccbc62,atomic,Tamper with Windows Defender Evade Scanning -Folder,"Malware can exclude a specific path from being scanned and evading detection. 
Upon successul execution, the file provided should be on the list of excluded path. 
To check the exclusion list using poweshell (Get-MpPreference).ExclusionPath 
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
d143172642328567d9d0951cb116e3a2,atomic,Invoke HTML Application - Jscript Engine Simulating Double Click,Executes an HTA Application using JScript script engine simulating double click.,defense-evasion,T1218.005,Signed Binary Proxy Execution: Mshta
2fae8daf5c8d30455c0055c26248c661,atomic,Odbcconf.exe - Load Response File,"Execute arbitrary response file that will spawn PowerShell.exe.
Source files: https://github.com/woanware/application-restriction-bypasses
",defense-evasion,T1218.008,Signed Binary Proxy Execution: Odbcconf
478df50001947bbbc38d109b90b1710e,atomic,Regsvcs Uninstall Method Call Test,"Executes the Uninstall Method, No Admin Rights Required, Requires SNK. Upon execution, ""I shouldn't really execute"" will be displayed
along with other information about the assembly being installed.
",defense-evasion,T1218.009,Signed Binary Proxy Execution: Regsvcs/Regasm
f82efa1ac00819fe5260af67800cbdcb,atomic,Masquerading - powershell.exe running as taskhostw.exe,"Copies powershell.exe, renames it, and launches it to masquerade as an instance of taskhostw.exe.

Upon successful execution, powershell.exe is renamed as taskhostw.exe and executed from non-standard path.
",defense-evasion,T1036.003,Masquerading: Rename System Utilities
f0fde90a3d59061b226197974e7dcbaa,atomic,Tamper with Windows Defender ATP PowerShell,"Attempting to disable scheduled scanning and other parts of windows defender atp. Upon execution Virus and Threat Protection will show as disabled
in Windows settings.
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
ad3da5b8a3ced63d5b6374b7aa6adac5,atomic,Modify Registry of Local Machine - cmd,"Modify the Local Machine registry RUN key to change Windows Defender executable that should be ran on startup.  This should only be possible when
CMD is ran as Administrative rights. Upon execution, the message ""The operation completed successfully.""
will be displayed. Additionally, open Registry Editor to view the modified entry in HKLM\Software\Microsoft\Windows\CurrentVersion\Run.
",defense-evasion,T1112,Modify Registry
50fa843f5f6995bbc50ee3c45ec480a2,atomic,Disable Bash History Logging with SSH -T,"Keeps history clear and stays out of lastlog,wtmp,btmp ssh -T keeps the ssh client from catching a proper TTY, which is what usually gets logged on lastlog
",defense-evasion,T1070.003,Indicator Removal on Host: Clear Command History
b7f89af9214876eae185527350ca034f,atomic,Extract binary files via VBA,"This module extracts a binary (calc.exe) from inside of another binary. 

In the wild maldoc authors will use this technique to hide binaries inside of files stored 
within the office document itself. An example of this technique can be seen in sample

f986040c7dd75b012e7dfd876acb33a158abf651033563ab068800f07f508226

This sample contains a document inside of itself. Document 1 is the actual maldoc itself, document 2
is the same document without all the malicious code. Document 1 will copy Document 2 to the file system
and then ""peek"" inside of this document and pull out the oleObject.bin file. Contained inside of this
oleObject.bin file is a payload that is parsed out and executed on the file system.
",defense-evasion,T1564,Hide Artifacts
337c07ce279b747827679ffb226e5d9c,atomic,Mshta Executes Remote HTML Application (HTA),"Execute an arbitrary remote HTA. Upon execution calc.exe will be launched.
",defense-evasion,T1218.005,Signed Binary Proxy Execution: Mshta
94ee9c0fda97e9e5131d6661348650d0,atomic,Indirect Command Execution - pcalua.exe,"The Program Compatibility Assistant (pcalua.exe) may invoke the execution of programs and commands from a Command-Line Interface.
[Reference](https://twitter.com/KyleHanslovan/status/912659279806640128)
Upon execution, calc.exe should open
",defense-evasion,T1202,Indirect Command Execution
4df316c222125fe7372723c5b3434977,atomic,Lockbit Black - Use Registry Editor to turn on automatic logon -Powershell,"Lockbit Black - Use Registry Editor to turn on automatic logon
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
0bc2cabb6dbb0a6be7e9436f0107b574,atomic,DisallowRun Execution Of Certain Applications,"Modify the registry of the currently logged in user using reg.exe via cmd console to prevent user running specific computer programs that could aid them in manually removing malware or detecting it 
using security product.
",defense-evasion,T1112,Modify Registry
748882eaad1b31e8f90d9b31692200fe,atomic,Invoke HTML Application - Direct download from URI,Executes an HTA Application by directly downloading from remote URI.,defense-evasion,T1218.005,Signed Binary Proxy Execution: Mshta
90ac777137516d90df82cb4a18864f93,atomic,Copy and Delete Mailbox Data on macOS,"Copies and deletes mail data on macOS
",defense-evasion,T1070.008,Email Collection: Mailbox Manipulation
6722535bf5a14b87b5772b739f53321f,atomic,Javascript in registry,"Upon execution, a javascript block will be placed in the registry for persistence.
Additionally, open Registry Editor to view the modified entry in HKCU:\Software\Microsoft\Windows\CurrentVersion\Internet Settings.
",defense-evasion,T1112,Modify Registry
68c56ff768d196958e92ebbcb91bc759,atomic,Truncate system log files via truncate utility,"This test truncates the system log files using the truncate utility with (-s 0 or --size=0) parameter which sets file size to zero, thus emptying the file content
",defense-evasion,T1070.002,Indicator Removal on Host: Clear Linux or Mac System Logs
2a450a37a8601a2131ad0ecdb8188b54,atomic,Impair Windows Audit Log Policy,"Disables the windows audit policy to prevent key host based telemetry being written into the event logs.
[Solarigate example](https://www.microsoft.com/security/blog/2021/01/20/deep-dive-into-the-solorigate-second-stage-activation-from-sunburst-to-teardrop-and-raindrop/)",defense-evasion,T1562.002,Impair Defenses: Disable Windows Event Logging
288a78bcbdc978bf78ee6d4f43b98442,atomic,Disable Windows LogOff Button,"Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows logoff button.
See how ransomware abuses this technique- https://www.trendmicro.com/vinfo/be/threat-encyclopedia/search/js_noclose.e/2
",defense-evasion,T1112,Modify Registry
2ebcdf9d130bd9f0c4493c9e2d211413,atomic,Suppress Win Defender Notifications,"Modify the registry of the currently logged in user using reg.exe via cmd console to suppress the windows defender notification.
See how azorult malware abuses this technique- https://app.any.run/tasks/a6f2ffe2-e6e2-4396-ae2e-04ea0143f2d8/
",defense-evasion,T1112,Modify Registry
a514c64de95ade525a68116e442af1bd,atomic,Msiexec.exe - Execute the DllRegisterServer function of a DLL,"Loads a DLL into msiexec.exe and calls its DllRegisterServer function. Note: the DLL included in the ""bin"" folder is only built for 64-bit, so this won't work on a 32-bit OS.
",defense-evasion,T1218.007,Signed Binary Proxy Execution: Msiexec
dbf9c5b79204dfba72c1c55c3b32f63c,atomic,Delete system log files via unlink utility,"This test deletes the system log file using unlink utility
",defense-evasion,T1070.002,Indicator Removal on Host: Clear Linux or Mac System Logs
9378f5d52c7f94cd08f407f8c0a5fbd7,atomic,Open a local port through Windows Firewall to any profile,This test will attempt to open a local port defined by input arguments to any profile,defense-evasion,T1562.004,Impair Defenses: Disable or Modify System Firewall
b2aeb3ccd1d9eec56e86854868b67d38,atomic,Real-time system log clearance/deletion,"This test reads real-time system log file and writes empty string to it, thus clearing the log file without tampering with the logging process
",defense-evasion,T1070.002,Indicator Removal on Host: Clear Linux or Mac System Logs
1a11245acd65695bbb3d7c4920337a6c,atomic,Delete system log files using shred utility,"This test overwrites the contents of the log file with zero bytes(-z) using three passes(-n 3) of data, and then delete the file(-u) securely
",defense-evasion,T1070.002,Indicator Removal on Host: Clear Linux or Mac System Logs
237eeedec47b5899d497fa1803ae4028,atomic,Disable Windows Task Manager application,"Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows task manager application.
See example how Agent Tesla malware abuses this technique: https://any.run/report/ea4ea08407d4ee72e009103a3b77e5a09412b722fdef67315ea63f22011152af/a866d7b1-c236-4f26-a391-5ae32213dfc4#registry
",defense-evasion,T1112,Modify Registry
f97de07a3b9e3b132f7bc42680151d81,atomic,Edit UFW firewall main configuration file,"Edit the Uncomplicated Firewall (UFW) main configuration file for setting 
default policies /etc/default/ufw.
",defense-evasion,T1562.004,Impair Defenses: Disable or Modify System Firewall
6584f399fa2dfc9f34f8b53476b36282,atomic,Msiexec.exe - Execute the DllUnregisterServer function of a DLL,"Loads a DLL into msiexec.exe and calls its DllUnregisterServer function. Note: the DLL included in the ""bin"" folder is only built for 64-bit, so this won't work on a 32-bit OS.
",defense-evasion,T1218.007,Signed Binary Proxy Execution: Msiexec
bc5d26cf7201f1504b495ca2c1758ebf,atomic,Disable Windows IIS HTTP Logging,"Disables HTTP logging on a Windows IIS web server as seen by Threat Group 3390 (Bronze Union).
This action requires HTTP logging configurations in IIS to be unlocked.

Use the cleanup commands to restore some default auditpol settings (your original settings will be lost)
",defense-evasion,T1562.002,Impair Defenses: Disable Windows Event Logging
7fe6a66d03f4dbfc022609ba311c2b11,atomic,Activate Windows NoPropertiesMyDocuments Group Policy Feature,"Modify the registry of the currently logged in user using reg.exe via cmd console to hide Properties from ""My Documents icon"" Group Policy. 
Take note that some Group Policy changes might require a restart to take effect.
See how ransomware abuses this technique- https://www.virustotal.com/gui/file/2d7855bf6470aa323edf2949b54ce2a04d9e38770f1322c3d0420c2303178d91/details
",defense-evasion,T1112,Modify Registry
e56b118fad900831f15bd550b5a5914a,atomic,Disable Windows Error Reporting Settings,"Modify the registry of the currently logged in user using reg.exe via cmd console to disable windows error reporting settings. This Windows feature allow the use to report bug, errors, failure or problems 
encounter in specific application or process.
See how azorult malware abuses this technique- https://app.any.run/tasks/a6f2ffe2-e6e2-4396-ae2e-04ea0143f2d8/
",defense-evasion,T1112,Modify Registry
fe3840e48a28eda88466867b6bb7dbea,atomic,Auditing Configuration Changes on Linux Host,"Emulates modification of auditd configuration files
",defense-evasion,T1562.006,Impair Defenses: Indicator Blocking
6d5da876fe45a933257a96c14c3132f0,atomic,Compiled HTML Help Remote Payload,"Uses hh.exe to execute a remote compiled HTML Help payload.
Upon execution displays an error saying the file cannot be open
",defense-evasion,T1218.001,Signed Binary Proxy Execution: Compiled HTML File
fcc9496cb4228dd4221f3562da1b49a4,atomic,"Binary packed by UPX, with modified headers (linux)","Copies and then runs a simple binary (just outputting ""the cake is a lie""), that was packed by UPX.

The UPX magic number (`0x55505821`, ""`UPX!`"") was changed to (`0x4c4f5452`, ""`LOTR`""). This prevents the binary from being detected
by some methods, and especially UPX is not able to uncompress it any more.
",defense-evasion,T1027.002,Obfuscated Files or Information: Software Packing
7950c18da2779fa38c0bddeb6d470466,atomic,Alternate Data Streams (ADS),"Execute from Alternate Streams

[Reference - 1](https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f)

[Reference - 2](https://oddvar.moe/2018/01/14/putting-data-in-alternate-data-streams-and-how-to-execute-it/)
",defense-evasion,T1564.004,Hide Artifacts: NTFS File Attributes
b6382bbeb9bd52e48ca7249d30507c9a,atomic,Base64 decoding with Perl,"Use Perl to decode a base64-encoded text string and echo it to the console
",defense-evasion,T1140,Deobfuscate/Decode Files or Information
a1aca621b607efe3540988a30307fb13,atomic,Indirect Command Execution - forfiles.exe,"forfiles.exe may invoke the execution of programs and commands from a Command-Line Interface.
[Reference](https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Forfiles.yml)
""This is basically saying for each occurrence of notepad.exe in c:\windows\system32 run calc.exe""
Upon execution calc.exe will be opened.
",defense-evasion,T1202,Indirect Command Execution
83a5ad479c9e313e60f34380e193102a,atomic,"Create an ""Administrator "" user (with a space on the end)",Creating a user with a username containing with a space on the end,defense-evasion,T1564,Hide Artifacts
b5d829c249e3577bebb081b82cb4edcf,atomic,chmod - Change file or folder mode (numeric mode),"Changes a file or folder's permissions using chmod and a specified numeric mode.
",defense-evasion,T1222.002,File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification
2d74c884d1e0b55f41542ef64bc8fe4b,atomic,LockBit Black - Disable Privacy Settings Experience Using Registry -cmd,"LockBit Black - Disable Privacy Settings Experience Using Registry
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
efc033332057f4957e3e190bf4061070,atomic,Control Panel Items,"This test simulates an adversary leveraging control.exe
Upon execution calc.exe will be launched
",defense-evasion,T1218.002,Signed Binary Proxy Execution: Control Panel
ff78708e0e18d31c0be7a2be295158ec,atomic,File Extension Masquerading,"download and execute a file masquerading as images or Office files. Upon execution 3 calc instances and 3 vbs windows will be launched.

e.g SOME_LEGIT_NAME.[doc,docx,xls,xlsx,pdf,rtf,png,jpg,etc.].[exe,vbs,js,ps1,etc] (Quartelyreport.docx.exe)
",defense-evasion,T1036.003,Masquerading: Rename System Utilities
43e3334362b140924f001b256b229ee5,atomic,Tamper with Windows Defender Registry,"Disable Windows Defender from starting after a reboot. Upen execution, if the computer is rebooted the entire Virus and Threat protection window in Settings will be
grayed out and have no info.
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
89a4fca013d3d39fc4effb1f6c8a8d74,atomic,Execute base64-encoded PowerShell from Windows Registry,"Stores base64-encoded PowerShell code in the Windows Registry and deobfuscates it for execution. This is used by numerous adversaries and malicious tools.

Upon successful execution, powershell will execute encoded command and read/write from the registry.
",defense-evasion,T1027,Obfuscated Files or Information
826e5c82d8f99a94ae96472dca89de03,atomic,Mshta executes JavaScript Scheme Fetch Remote Payload With GetObject,"Test execution of a remote script using mshta.exe. Upon execution calc.exe will be launched.
",defense-evasion,T1218.005,Signed Binary Proxy Execution: Mshta
4166b6cb546ee537c916c1f864f1294b,atomic,Disable Defender Using NirSoft AdvancedRun,"Information on NirSoft AdvancedRun and its creators found here: http://www.nirsoft.net/utils/advanced_run.html
This Atomic will run AdvancedRun.exe with similar behavior identified during the WhisperGate campaign.
See https://medium.com/s2wblog/analysis-of-destructive-malware-whispergate-targeting-ukraine-9d5d158f19f3
Upon successful execution, AdvancedRun.exe will attempt to run and stop Defender, and optionally attempt to delete the Defender folder on disk. 
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
8b5fb5a437fad691a2764514f0c022ee,atomic,Stop and unload Crowdstrike Falcon on macOS,"Stop and unload Crowdstrike Falcon daemons falcond and userdaemon on macOS
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
029770bd7c3a403daeab3af692af0046,atomic,Masquerade as a built-in system executable,"Launch an executable that attempts to masquerade as a legitimate executable.
",defense-evasion,T1036.005,Masquerading: Match Legitimate Name or Location
280003641a5cddf916c4f2bf605a71d3,atomic,Allow SMB and RDP on Microsoft Defender Firewall,"Allow all SMB and RDP rules on the Microsoft Defender Firewall for all profiles.
Caution if you access remotely the host where the test runs! Especially with the cleanup command which will reset the firewall and risk disabling those services...
",defense-evasion,T1562.004,Impair Defenses: Disable or Modify System Firewall
8bb400c4a8398ff27df5fff189aca59b,atomic,NetWire RAT Registry Key Creation,"NetWire continues to create its home key (HKCU\SOFTWARE\NetWire) as well as adding it into the auto-run group in the victim’s registry.
See how NetWire malware - https://app.any.run/tasks/41ecdbde-4997-4301-a350-0270448b4c8f/
",defense-evasion,T1112,Modify Registry
2cdcf1010a524231a26b5f3c6025eb91,atomic,Install root CA on Windows with certutil,"Creates a root CA with certutil
",defense-evasion,T1553.004,Subvert Trust Controls: Install Root Certificate
efe119524cf6e6b760c6e9ebe83bf107,atomic,Disable Powershell ETW Provider - Windows,"This test was created to disable the Microsoft Powershell ETW provider by using the built-in Windows tool, logman.exe. This provider is used as a common source of telemetry in AV/EDR solutions.",defense-evasion,T1562.006,Impair Defenses: Indicator Blocking
f5b48f9f8e01db3edd487c05580a0e90,atomic,Stop and Remove Arbitrary Security Windows Service,"Beginning with Powershell 6.0, the Stop-Service cmdlet sends a stop message to the Windows Service Controller for each of the specified services. The Remove-Service cmdlet removes a Windows service in the registry and in the service database.
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
123d761fda64a5dd8535ac0ab95d4f25,atomic,Register-CimProvider - Execute evil dll,"Execute arbitrary dll. Requires at least Windows 8/2012. Also note this dll can be served up via SMB
",defense-evasion,T1218,Signed Binary Proxy Execution
a1e9351c7799d884d29a5e61712ab58e,atomic,Edit UFW firewall user.rules file,"Edit the Uncomplicated Firewall (UFW) rules file /etc/ufw/user.rules.
",defense-evasion,T1562.004,Impair Defenses: Disable or Modify System Firewall
bc90f2994ce850e89f5ffc6101369329,atomic,Rundll32 execute VBscript command,"Test execution of a command using rundll32.exe and VBscript in a similar manner to the JavaScript test.
Technique documented by Hexacorn- http://www.hexacorn.com/blog/2019/10/29/rundll32-with-a-vbscript-protocol/
Upon execution calc.exe will be launched
",defense-evasion,T1218.011,Signed Binary Proxy Execution: Rundll32
b0026f9a57639c049490a43d623d7695,atomic,Delete TeamViewer Log Files,"Adversaries may delete TeamViewer log files to hide activity. This should provide a high true-positive alert ration.
This test just places the files in a non-TeamViewer folder, a detection would just check for a deletion event matching the TeamViewer
log file format of TeamViewer_##.log. Upon execution, no output will be displayed. Use File Explorer to verify the folder was deleted.

https://twitter.com/SBousseaden/status/1197524463304290305?s=20
",defense-evasion,T1070.004,Indicator Removal on Host: File Deletion
0bb6fa90a458e6512a19d246cfae8843,atomic,Invoke HTML Application - JScript Engine with Rundll32 and Inline Protocol Handler,"Executes an HTA Application with JScript Engine, Rundll32 and Inline Protocol Handler.",defense-evasion,T1218.005,Signed Binary Proxy Execution: Mshta
d68bca253560877e22685a3dd3ff4dd4,atomic,Rundll32 execute JavaScript Remote Payload With GetObject,"Test execution of a remote script using rundll32.exe. Upon execution notepad.exe will be opened. 
This has been used by Win32/Poweliks malware and works as described [here](https://www.stormshield.com/news/poweliks-command-line-confusion/)

Note: The GetObject function is no longer supported in Internet Explorer v9 (2011) and later so this technique would only work where very old versions of IE are installed. 
",defense-evasion,T1218.011,Signed Binary Proxy Execution: Rundll32
fd4ca8f12c6d3a9af55be0211878509b,atomic,Snake Malware Encrypted crmlog file,"The following Atomic Test will create a file with a specific name and sets its attributes to Hidden, System, and Archive. This was related to the Snake Malware campaign and is later decrypted by Snake's kernel driver.
[Snake Malware - CISA](https://media.defense.gov/2023/May/09/2003218554/-1/-1/0/JOINT_CSA_HUNTING_RU_INTEL_SNAKE_MALWARE_20230509.PDF)  
",defense-evasion,T1027,Obfuscated Files or Information
0556cba95bf8acdff3c9c7b5e13443ce,atomic,Rundll32 ieadvpack.dll Execution,"Test execution of a command using rundll32.exe with ieadvpack.dll.
Upon execution calc.exe will be launched

Reference: https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSLibraries/Ieadvpack.yml
",defense-evasion,T1218.011,Signed Binary Proxy Execution: Rundll32
8546aa1934a705574c7591af340e0251,atomic,InstallUtil HelpText method call,"Executes the Uninstall Method. Upon execution, help information will be displayed for InstallUtil.
",defense-evasion,T1218.004,Signed Binary Proxy Execution: InstallUtil
36aa805044ab4f4d7f6f372a46c8bab2,atomic,Delete an entire folder - Windows PowerShell,"Recursively delete a folder in the temporary directory using Powershell. Upon execution, no output will be displayed. Use File Explorer to verify the folder was deleted.
",defense-evasion,T1070.004,Indicator Removal on Host: File Deletion
f7e29cdc63759d523fca9d6a8178daa0,atomic,Compile After Delivery using csc.exe,"Compile C# code using csc.exe binary used by .NET
Upon execution an exe named T1027.004.exe will be placed in the temp folder
",defense-evasion,T1027.004,Obfuscated Files or Information: Compile After Delivery
015623df4f8517d933e4edd65deb97ed,atomic,Register Portable Virtualbox,"ransomware payloads via virtual machines (VM). 
[Maze ransomware](https://threatpost.com/maze-ransomware-ragnar-locker-virtual-machine/159350/)
",defense-evasion,T1564.006,Run Virtual Instance
da03142f3c859db6a08d57accc7d2aa8,atomic,Stop/Start UFW firewall systemctl,"Stop the Uncomplicated Firewall (UFW) if installed, using systemctl. 
",defense-evasion,T1562.004,Impair Defenses: Disable or Modify System Firewall
2c276ef775e39925256bff68ce6ba19f,atomic,ProtocolHandler.exe Downloaded a Suspicious File,"Emulates attack via documents through protocol handler in Microsoft Office.  On successful execution you should see Microsoft Word launch a blank file.
",defense-evasion,T1218,Signed Binary Proxy Execution
1f0614ea5c4af6faf1b44570f5f22f8a,atomic,Creating W32Time similar named service using sc,"Creating W32Time similar named service (win32times) using sc just like threat actor dubbed ""Operation Wocao""",defense-evasion,T1036.004,Masquerading: Masquerade Task or Service
dedfa0a54c9c13ce5714a0dc2e1f5d1a,atomic,"Create a Hidden User Called ""$""","Creating a user with a username containing ""$""",defense-evasion,T1564,Hide Artifacts
86993ae14d75a6da421c0d98c3facd61,atomic,Disable Windows CMD application,"Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows CMD application.
See example how Agent Tesla malware abuses this technique: https://any.run/report/ea4ea08407d4ee72e009103a3b77e5a09412b722fdef67315ea63f22011152af/a866d7b1-c236-4f26-a391-5ae32213dfc4#registry
",defense-evasion,T1112,Modify Registry
6ac8f48413127289ac42b76a0785b08f,atomic,Hide Files Through Registry,"Disable Show Hidden files switch in registry. This technique was abused by several malware to hide their files from normal user.
See how this trojan abuses this technique - https://www.sophos.com/en-us/threat-center/threat-analyses/viruses-and-spyware/W32~Tiotua-P/detailed-analysis.aspx 
",defense-evasion,T1564.001,Hide Artifacts: Hidden Files and Directories
ef55deab0893319b07802b4d4bd1f38c,atomic,Disable Windows Security Center Notifications,"Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows security center notification.
See how azorult malware abuses this technique- https://app.any.run/tasks/a6f2ffe2-e6e2-4396-ae2e-04ea0143f2d8/
",defense-evasion,T1112,Modify Registry
35a47c6fdbc5e6756664a2b7ecc1f90b,atomic,PubPrn.vbs Signed Script Bypass,"Executes the signed PubPrn.vbs script with options to download and execute an arbitrary payload.
",defense-evasion,T1216.001,Signed Script Proxy Execution: Pubprn
d8f4e4e10f4d6da1b174bb18cb859e6c,atomic,Clear Bash history (truncate),"Clears bash history via truncate
",defense-evasion,T1070.003,Indicator Removal on Host: Clear Command History
6940ffd670787cd1c410997e66629573,atomic,Remove Network Share PowerShell,"Removes a Network Share utilizing PowerShell
",defense-evasion,T1070.005,Indicator Removal on Host: Network Share Connection Removal
6ee56fbf12b8fe3df6bb96aa4abcbe01,atomic,Clear Bash history (ln dev/null),"Clears bash history via a symlink to /dev/null
",defense-evasion,T1070.003,Indicator Removal on Host: Clear Command History
04858322bc6cd08282f2ce96cab5ee7c,atomic,Delete a single file - Windows PowerShell,"Delete a single file from the temporary directory using Powershell. Upon execution, no output will be displayed. Use File Explorer to verify the file was deleted.
",defense-evasion,T1070.004,Indicator Removal on Host: File Deletion
69a1361f277efe9bade299f0c0a01b7a,atomic,cacls - Grant permission to specified user or group recursively,"Modifies the filesystem permissions of the specified folder and contents to allow the specified user or group Full Control. If ""Access is denied""
is displayed it may be because the file or folder doesn't exit. Run the prereq command to create it. Upon successfull execution, ""Successfully processed 3 files""
will be displayed.
",defense-evasion,T1222.001,File and Directory Permissions Modification: Windows File and Directory Permissions Modification
6a4f5aca52680eef33a8285782936333,atomic,Kill antimalware protected processes using Backstab,"Backstab loads Process Explorer driver which is signed by Microsoft and use it to terminate running processes protected by antimalware software such as MsSense.exe or MsMpEng.exe, which is otherwise not possible to kill.
https://github.com/Yaxser/Backstab",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
cb09dc16561713bc4558c54d42c6d513,atomic,Disable Windows OS Auto Update,"Disable Auto Update Windows OS feature. Redline is using this as part of its defense evasion.
",defense-evasion,T1112,Modify Registry
32047c4f30d4e65ebc9b22b9b8368bca,atomic,Tamper with Windows Defender ATP using Aliases - PowerShell,"Attempting to disable scheduled scanning and other parts of Windows Defender ATP using set-MpPreference aliases. Upon execution Virus and Threat Protection will show as disabled
in Windows settings.
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
3e78ff779dd7bfc558ae0e4d5319efcc,atomic,Windows - Timestomp a File,"Timestomp kxwn.lock.

Successful execution will include the placement of kxwn.lock in #{file_path} and execution of timestomp.ps1 to modify the time of the .lock file. 

[Mitre ATT&CK Evals](https://github.com/mitre-attack/attack-arsenal/blob/master/adversary_emulation/APT29/CALDERA_DIY/evals/data/abilities/defensive-evasion/4a2ad84e-a93a-4b2e-b1f0-c354d6a41278.yml)
",defense-evasion,T1070.006,Indicator Removal on Host: Timestomp
8725359f7529791717634d8fdd8948e6,atomic,LockBit Black - Disable the ETW Provider of Windows Defender -cmd,"An adversary can disable the ETW Provider of Windows Defender,
so nothing would be logged to Microsoft-Windows-Windows-Defender/Operational anymore.
",defense-evasion,T1562.006,Impair Defenses: Indicator Blocking
0503af9fd6d1fbc9ddc632c91e32d2de,atomic,Chown through c script,"chowns a file to root using a c script
",defense-evasion,T1222.002,File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification
2929fac2296bf1041ba33c86d42d9a5a,atomic,Clear Pagging Cache,"clear pagging cache via system request. This is a temporary change in the system to clear paging cache. This technique seen in Awfulshred wiper as part
of its malicious payload on the compromised host. added reference link for this technique: https://www.tecmint.com/clear-ram-memory-cache-buffer-and-swap-space-on-linux/
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
0bacba34be276136d07781079e912090,atomic,Modify Registry of Current User Profile - cmd,"Modify the registry of the currently logged in user using reg.exe via cmd console. Upon execution, the message ""The operation completed successfully.""
will be displayed. Additionally, open Registry Editor to view the new entry in HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced.
",defense-evasion,T1112,Modify Registry
db2ffa8a52a76704b0cf6944e8383b36,atomic,DCShadow (Active Directory),"Use Mimikatz DCShadow method to simulate behavior of an Active Directory Domain Controller and edit protected attribute.

[DCShadow](https://www.dcshadow.com/)
[Additional Reference](http://www.labofapenetrationtester.com/2018/04/dcshadow.html)

It will set the badPwdCount attribute of the target user (user/machine account) to 9999. You can check after with:
Get-ADObject -LDAPFilter '(samaccountname=<user>)' -Properties badpwdcount | select-object -ExpandProperty badpwdcount

Need SYSTEM privileges locally (automatically obtained via PsExec, so running as admin is sufficient), and Domain Admin remotely.
The easiest is to run elevated and as a Domain Admin user.
",defense-evasion,T1207,Rogue Domain Controller
05f8b752dbccff102ef530103bd8e550,atomic,Clear Event Logs via VBA,"This module utilizes WMI via VBA to clear the Security and Backup eventlogs from the system. 

Elevation is required for this module to execute properly, otherwise WINWORD will throw an ""Access Denied"" error
",defense-evasion,T1070.001,Indicator Removal on Host: Clear Windows Event Logs
5f92451000354bf26a40f5c817b5846d,atomic,Load Arbitrary DLL via Wuauclt (Windows Update Client),"This test uses Wuauclt to load an arbitrary DLL. Upon execution with the default inputs, calculator.exe will be launched. 
See https://dtm.uk/wuauclt/
",defense-evasion,T1218,Signed Binary Proxy Execution
47c89ca1bebf31127217a582c1ef8661,atomic,LockBit Black - Unusual Windows firewall registry modification -cmd,"An adversary tries to modify the windows firewall registry
",defense-evasion,T1562.004,Impair Defenses: Disable or Modify System Firewall
11a7fa65413753907dc69ac37db54798,atomic,Disable Windows Toast Notifications,"Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows toast notification.
See how azorult malware abuses this technique- https://app.any.run/tasks/a6f2ffe2-e6e2-4396-ae2e-04ea0143f2d8/
",defense-evasion,T1112,Modify Registry
06d6ac81dae5c0f49dd3d5641eb2c81e,atomic,Grant Full Access to folder for Everyone - Ryuk Ransomware Style,"Invokes the command line similar to that used by Ryuk Ransomware to grant full access to the entire C:\ drive for Everyone.
**icacls ""C:\*"" /grant Everyone:F /T /C /Q**
However, for this atomic we set the permission on C:\Users\Public so it completes faster and doesn't irreversibly affect the host.
You can set your own path variable to ""C:\*"" if you prefer.
",defense-evasion,T1222.001,File and Directory Permissions Modification: Windows File and Directory Permissions Modification
560a1774602fdd048fe593bf31052ef4,atomic,chown - Change file or folder ownership and group,"Changes a file or folder's ownership and group information using chown.
",defense-evasion,T1222.002,File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification
e1ae0c45990c70e3d7651c2c355f7bf9,atomic,InfDefaultInstall.exe .inf Execution,"Test execution of a .inf using InfDefaultInstall.exe

Reference: https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Infdefaultinstall.yml
",defense-evasion,T1218,Signed Binary Proxy Execution
4cbe4aebe95c5729526b5d0325c4de0b,atomic,Go compile,"Compile a c file with either gcc or clang on Linux or Macos.
",defense-evasion,T1027.004,Obfuscated Files or Information: Compile After Delivery
c407315583b3a00d9a2e0c3c510f2c96,atomic,Tamper with Windows Defender Evade Scanning -Process,"Malware can exclude specific processes from being scanned and evading detection.
Upon successful execution, the process(es) should be on the list of excluded processes. 
To check the exclusion list using poweshell  (Get-MpPreference).ExclusionProcess.""
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
b62ae2359c40c2f5cd25881ad9b16008,atomic,Build Image On Host,"Adversaries may build a container image directly on a host to bypass defenses that monitor for the retrieval of malicious images from a public registry. An adversary may take advantage of that build API to build a custom image on the host that includes malware downloaded from their C2 server, and then they then may utilize Deploy Container using that custom image.",defense-evasion,T1612,Build Image on Host
6a8d25d65a7d481dc479f89c62af1e6a,atomic,Clear Windows Audit Policy Config,Clear the Windows audit policy using auditpol utility. This action would stop certain audit events from being recorded in the security log.,defense-evasion,T1562.002,Impair Defenses: Disable Windows Event Logging
9a413f933aa7381d0e1f3f89001f6717,atomic,Event Viewer Registry Modification - Redirection Program,"Modify event viewer registry values to alter the behavior of the online help redirection. Upon opening an event in event viewer and attempting to view the help page for the event, it will execute the program defined in the redirection program registry entry.",defense-evasion,T1112,Modify Registry
9d2e91b9241ae43b517be2be98bddfd9,atomic,Indicator Removal using FSUtil,"Manages the update sequence number (USN) change journal, which provides a persistent log of all changes made to files on the volume. Upon execution, no output
will be displayed. More information about fsutil can be found at https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/fsutil-usn
",defense-evasion,T1070,Indicator Removal on Host
bc4acf1b832d3e26002c7155453a4b4d,atomic,Rundll32 advpack.dll Execution,"Test execution of a command using rundll32.exe with advpack.dll.
Reference: https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSLibraries/Advpack.yml
Upon execution calc.exe will be launched
",defense-evasion,T1218.011,Signed Binary Proxy Execution: Rundll32
3de595bb54ec62ed3f18531ccee1da3f,atomic,Gatekeeper Bypass,"Gatekeeper Bypass via command line
",defense-evasion,T1553.001,Subvert Trust Controls: Gatekeeper Bypass
14ca1cfcf0455a15ae48b907f07d6599,atomic,Mimic Ransomware - Enable Multiple User Sessions,"This test emulates Mimic ransomware's ability to enable multiple user sessions by modifying the AllowMultipleTSSessions value within the Winlogon registry key. 
See [Mimic Ransomware Overview] (https://www.trendmicro.com/en_us/research/23/a/new-mimic-ransomware-abuses-everything-apis-for-its-encryption-p.html)
",defense-evasion,T1112,Modify Registry
20277ce46ffe7d08083f8b5ca524b317,atomic,Create Windows Hidden File with Attrib,"Creates a file and marks it as hidden using the attrib.exe utility.Upon execution, open File Epxplorer and enable View > Hidden Items. Then, open Properties > Details on the file
and observe that the Attributes are ""SH"" for System and Hidden.
",defense-evasion,T1564.001,Hide Artifacts: Hidden Files and Directories
21a279cb142da9bc65cd4a19bef7a2d2,atomic,Disable .NET Event Tracing for Windows Via Registry (cmd),Disables ETW for the .NET Framework using the reg.exe utility to update the Windows registry,defense-evasion,T1562.006,Impair Defenses: Indicator Blocking
d26a4798efaecdb29af1b400aa847ef3,atomic,attrib - hide file,"Attackers leverage an existing Windows binary, attrib.exe, to mark specific files or folder as hidden by using specific flags so that
the victim does not see the file.
",defense-evasion,T1222.001,File and Directory Permissions Modification: Windows File and Directory Permissions Modification
c3a04ce292bc3f8615d56af548c8dec0,atomic,CheckIfInstallable method call,"Executes the CheckIfInstallable class constructor runner instead of executing InstallUtil. Upon execution, the InstallUtil test harness will be executed.
If no output is displayed the test executed successfuly.
",defense-evasion,T1218.004,Signed Binary Proxy Execution: InstallUtil
844536fbe408f7127f6739462ca73668,atomic,Setting the HISTFILESIZE environment variable,"An Adversary may set the bash history files size environment variable (HISTFILESIZE) to zero to prevent the logging of commands to the history file after they log out of the system.

Note: we don't wish to log out, so we are just confirming the value of HISTFILESIZE. In this test we 1. echo HISTFILESIZE 2. set it to zero 3. confirm that HISTFILESIZE is set to zero.
",defense-evasion,T1562.003,Impair Defenses: HISTCONTROL
b0994d3924347a714de2bbfb269f3fbd,atomic,Unload Sysmon Filter Driver,"Unloads the Sysinternals Sysmon filter driver without stopping the Sysmon service. To verify successful execution, o verify successful execution,
run the prereq_command's and it should fail with an error of ""sysmon filter must be loaded"".
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
a26601ea01296a3a01c3854340d1c396,atomic,AWS - Remove VPC Flow Logs using Stratus,"This Atomic will attempt to remove AWS VPC Flow Logs configuration. Stratus Red Team is a self-contained binary. You can use it to easily detonate offensive attack techniques against a live cloud environment. Ref: https://stratus-red-team.cloud/attack-techniques/AWS/aws.defense-evasion.vpc-remove-flow-logs/
",defense-evasion,T1562.008,Impair Defenses: Disable Cloud Logs
47ba984c0c40a7c41b4797156c1a5f96,atomic,Kill Event Log Service Threads,Kill Windows Event Log Service Threads using Invoke-Phant0m. WARNING you will need to restart PC to return to normal state with Log Service. https://artofpwn.com/phant0m-killing-windows-event-log.html,defense-evasion,T1562.002,Impair Defenses: Disable Windows Event Logging
1003589b9e99d9edbd22cdcd56394f53,atomic,Pad Binary to Change Hash - Linux/macOS dd,"Uses dd to add a zero byte, high-quality random data, and low-quality random data to the binary to change the hash.

Upon successful execution, dd will modify `/tmp/evil-binary`, therefore the expected hash will change.
",defense-evasion,T1027.001,Obfuscated Files or Information: Binary Padding
37ec8aa96775f561e02a954dae1b56bc,atomic,CC compile,"Compile a c file with either gcc or clang on Linux or Macos.
",defense-evasion,,
c7ec84be7b5a6e587c6a227da1e7b6c7,atomic,Windows Disable LSA Protection,"The following Atomic adds a registry entry to disable LSA Protection.

The LSA controls and manages user rights information, password hashes and other important bits of information in memory. Attacker tools, such as mimikatz, rely on accessing this content to scrape password hashes or clear-text passwords. Enabling LSA Protection configures Windows to control the information stored in memory in a more secure fashion - specifically, to prevent non-protected processes from accessing that data.
Upon successful execution, the registry will be modified and RunAsPPL will be set to 0, disabling Lsass protection.
https://learn.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/configuring-additional-lsa-protection#how-to-disable-lsa-protection
https://blog.netwrix.com/2022/01/11/understanding-lsa-protection/
https://thedfirreport.com/2022/03/21/phosphorus-automates-initial-access-using-proxyshell/  
",defense-evasion,T1562,Impair Defenses
54a7ac8fc8991511de9993983d3d3215,atomic,Mshta used to Execute PowerShell,"Use Mshta to execute arbitrary PowerShell. Example is from the 2021 Threat Detection Report by Red Canary.
",defense-evasion,T1218.005,Signed Binary Proxy Execution: Mshta
94ada6941f651b12c2a7fbba310a4bde,atomic,Create Hidden User in Registry,"Adversaries may similarly hide user accounts in Windows. Adversaries can set the HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserList Registry key value to 0 for a specific user to prevent that user from being listed on the logon screen.
Reference https://attack.mitre.org/techniques/T1564/002/ and https://thedfirreport.com/2022/07/11/select-xmrig-from-sqlserver/
",defense-evasion,T1564.002,Hide Artifacts: Hidden Users
26bd72e1fe309c1cf45fa9a36de63fcd,atomic,Disable Cb Response,"Disable the Cb Response service
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
71f3968aa7bf30baa94c3e1ac1e2ebf1,atomic,Copy and Modify Mailbox Data on macOS,"Copies and modifies mail data on macOS
",defense-evasion,T1070.008,Email Collection: Mailbox Manipulation
d415783a94a4134fc3b5a99c531cbb74,atomic,Regsvr32 local COM scriptlet execution,"Regsvr32.exe is a command-line program used to register and unregister OLE controls. Upon execution, calc.exe will be launched.
",defense-evasion,T1218.010,Signed Binary Proxy Execution: Regsvr32
ed172018f897dab90147a47995ce197d,atomic,Obfuscated Command in PowerShell,"This is an obfuscated PowerShell command which when executed prints ""Hello, from PowerShell!"". Example is from the 2021 Threat Detection Report by Red Canary.
",defense-evasion,T1027,Obfuscated Files or Information
209d25131d45ef2d76e3bf69d200173f,atomic,Lolbin Gpscript startup option,"Executes startup scripts configured in Group Policy
https://lolbas-project.github.io/lolbas/Binaries/Gpscript/
https://oddvar.moe/2018/04/27/gpscript-exe-another-lolbin-to-the-list/
",defense-evasion,T1218,Signed Binary Proxy Execution
2a971043ed3c06eac6b8cf496f706b46,atomic,WMI Win32_Product Class - Execute Local MSI file with embedded JScript,"Executes an MSI containing embedded JScript code using the WMI Win32_Product class
",defense-evasion,T1218.007,Signed Binary Proxy Execution: Msiexec
1532b3faf25ad1e6f4fba4ada643b253,atomic,Create ADS PowerShell,"Create an Alternate Data Stream with PowerShell. Write access is required. To verify execution, the the command ""ls -Recurse | %{ gi $_.Fullname -stream *} | where stream -ne ':$Data' | Select-Object pschildname""
in the %temp% direcotry to view all files with hidden data streams. To view the data in the alternate data stream, run ""notepad.exe T1564.004_has_ads_powershell.txt:adstest.txt"" in the %temp% folder.
",defense-evasion,T1564.004,Hide Artifacts: NTFS File Attributes
c129aca94d1d22aad238ee07f5db7813,atomic,InstallHelper method call,"Executes the InstallHelper class constructor runner instead of executing InstallUtil. Upon execution, no output will be displayed if the test
executed successfuly.
",defense-evasion,T1218.004,Signed Binary Proxy Execution: InstallUtil
34041639e6e501856ecaf5969ee29c76,atomic,Activate Windows NoFind Group Policy Feature,"Modify the registry of the currently logged in user using reg.exe via cmd console to Remove Search menu from Start Menu Group Policy.
Take note that some Group Policy changes might require a restart to take effect.
See how Trojan abuses this technique- https://www.sophos.com/de-de/threat-center/threat-analyses/viruses-and-spyware/Troj~Krotten-N/detailed-analysis
",defense-evasion,T1112,Modify Registry
86ab6d7ecc05b7dabc7699a9e6a0a173,atomic,Decode base64 Data into Script,"Creates a base64-encoded data file and decodes it into an executable shell script

Upon successful execution, sh will execute art.sh, which is a base64 encoded command, that echoes `Hello from the Atomic Red Team` 
and uname -v
",defense-evasion,T1027,Obfuscated Files or Information
61af21e36eb366eb7321e2a43053eeb1,atomic,Regsvr32 Registering Non DLL,"Replicating observed Gozi maldoc behavior registering a dll with an altered extension
",defense-evasion,T1218.010,Signed Binary Proxy Execution: Regsvr32
27b1c45ca84b25f3b97e298a7f2ca9c3,atomic,chmod - Change file or folder mode (symbolic mode) recursively,"Changes a file or folder's permissions recursively using chmod and a specified symbolic mode.
",defense-evasion,T1222.002,File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification
515c4806970b4836b9a3c251515a6147,atomic,Hidden files,"Requires Apple Dev Tools
",defense-evasion,T1564.001,Hide Artifacts: Hidden Files and Directories
53be764b84e99052c6c0099ab4968be5,atomic,Create ADS command prompt,"Create an Alternate Data Stream with the command prompt. Write access is required. Upon execution, run ""dir /a-d /s /r | find "":$DATA"""" in the %temp%
folder to view that the alternate data stream exists. To view the data in the alternate data stream, run ""notepad T1564.004_has_ads.txt:adstest.txt""
",defense-evasion,T1564.004,Hide Artifacts: NTFS File Attributes
6a411cadf7c87edcb445422ce6785550,atomic,Launches an executable using Rundll32 and pcwutl.dll,"Executes the LaunchApplication function in pcwutl.dll to proxy execution of an executable.
",defense-evasion,T1218.011,Signed Binary Proxy Execution: Rundll32
91531bc5832f6753d924bae901932cb5,atomic,Create and Hide a Service with sc.exe,"The following technique utilizes sc.exe and sdset to change the security descriptor of a service and ""hide"" it from Get-Service or sc query.

Upon successful execution, sc.exe creates a new service changes the security descriptor.

https://twitter.com/Alh4zr3d/status/1580925761996828672
https://learn.microsoft.com/en-us/windows/win32/secauthz/security-descriptor-string-format
",defense-evasion,T1564,Hide Artifacts
be9d436d25abc40a95d31dd28ca7b0cf,atomic,LockBit Black - Disable the ETW Provider of Windows Defender -Powershell,"An adversary can disable the ETW Provider of Windows Defender,
so nothing would be logged to Microsoft-Windows-Windows-Defender/Operational anymore.
",defense-evasion,T1562.006,Impair Defenses: Indicator Blocking
3e29fb41fe9d7dd07fbe9adadee8b1da,atomic,WMI Win32_Product Class - Execute Local MSI file with an embedded DLL,"Executes an MSI containing an embedded DLL using the WMI Win32_Product class
",defense-evasion,T1218.007,Signed Binary Proxy Execution: Msiexec
3a68db58e75f8887944e846f0455f758,atomic,Disable syslog,"Disables syslog collection
",defense-evasion,T1562.001,Impair Defenses: Disable or Modify Tools
a8cbe77b7a99330611885fbb85c0dc70,atomic,Linux VM Check via Hardware,"Identify virtual machine hardware. This technique is used by the Pupy RAT and other malware.
",discovery,T1082,System Information Discovery
10a0f4f8efdae71f3e88b3e20560798a,atomic,Enumerate Active Directory for Unconstrained Delegation,"Attackers may attempt to query for computer objects with the UserAccountControl property
'TRUSTED_FOR_DELEGATION' (0x80000;524288) set
More Information - https://shenaniganslabs.io/2019/01/28/Wagging-the-Dog.html#when-the-stars-align-unconstrained-delegation-leads-to-rce
Prerequisite: AD RSAT PowerShell module is needed and it must run under a domain user
",discovery,T1087.002,Account Discovery: Domain Account
f5b4c02bae169cb3a62ac26bb80321d6,atomic,Permission Groups Discovery PowerShell (Local),"Permission Groups Discovery utilizing PowerShell. This test will display some errors if run on a computer not connected to a domain. Upon execution, domain
information will be displayed.
",discovery,T1069.001,Permission Groups Discovery: Local Groups
f8de05d1741dcc468f772ab0ff4dac72,atomic,Process Discovery - tasklist,"Utilize tasklist to identify processes.

Upon successful execution, cmd.exe will execute tasklist.exe to list processes. Output will be via stdout. 
",discovery,T1057,Process Discovery
4712f45e41760276d20885bbc885a2ef,atomic,Enumerate all accounts via PowerShell (Domain),"Enumerate all accounts via PowerShell. Upon execution, lots of user account and group information will be displayed.
",discovery,T1087.002,Account Discovery: Domain Account
8ddfaf982ab359cda13626b870ccb339,atomic,Find and Display Internet Explorer Browser Version,"Query the registry to determine the version of internet explorer installed on the system.
Upon execution, version information about internet explorer will be displayed.
",discovery,T1518,Software Discovery
d6d77e5399e89ad6557bd40defef7217,atomic,Port Scan NMap for Windows,Scan ports to check for listening ports for the local host 127.0.0.1,discovery,T1046,Network Service Discovery
453b8d81c6118310308fb5b22de12235,atomic,Process Discovery - ps,"Utilize ps to identify processes.

Upon successful execution, sh will execute ps and output to /tmp/loot.txt.
",discovery,T1057,Process Discovery
0142dca15d1eaabd3333bae002d1e15a,atomic,List Google Chrome Bookmark JSON Files on macOS,"Searches for Google Chrome's Bookmark file (on macOS) that contains bookmarks in JSON format and lists any found instances to a text file.
",discovery,T1217,Browser Bookmark Discovery
334d0a8f48017677533913505003a8fc,atomic,System Network Configuration Discovery,"Identify network configuration information.

Upon successful execution, sh will spawn multiple commands and output will be via stdout.
",discovery,,
e541c2b62c3259680863a6f3b410e59a,atomic,WMIObject Group Discovery,"Utilizing PowerShell cmdlet - get-wmiobject, to enumerate local groups on the endpoint. Upon execution, Upon execution, information will be displayed of local groups on system.
",discovery,T1069.001,Permission Groups Discovery: Local Groups
aaeee9107989a507f526b0cef1cb274f,atomic,Get-DomainController with PowerView,"Utilizing PowerView, run Get-DomainController to identify the Domain Controller. Upon execution, information about the domain controller within the domain will be displayed.
",discovery,T1018,Remote System Discovery
b45cb08e24877077d98421393bce079a,atomic,Enumerate Active Directory Groups with ADSISearcher,"The following Atomic test will utilize ADSISearcher to enumerate groups within Active Directory.
Upon successful execution a listing of groups will output with their paths in AD.
Reference: https://devblogs.microsoft.com/scripting/use-the-powershell-adsisearcher-type-accelerator-to-search-active-directory/
",discovery,T1069.002,Permission Groups Discovery: Domain Groups
043e9d0185322f75cfcecd7ff48b9814,atomic,Show System Integrity Protection status (MacOS),"Read and Display System Intergrety Protection status. csrutil is commonly used by malware and post-exploitation tools to determine whether certain files and directories on the system are writable or not.
",discovery,T1082,System Information Discovery
b5fe84fa9fb8216512867a039a61db20,atomic,Applications Installed,"Query the registry to determine software and versions installed on the system. Upon execution a table of
software name and version information will be displayed.
",discovery,T1518,Software Discovery
fb8568a6da66d194ab39409de52be4ff,atomic,List Process Main Windows - C# .NET,"Compiles and executes C# code to list main window titles associated with each process.

Upon successful execution, powershell will download the .cs from the Atomic Red Team repo, and cmd.exe will compile and execute T1010.exe. Upon T1010.exe execution, expected output will be via stdout.
",discovery,T1010,Application Window Discovery
b57491a5e201a3575d6b63ca7700a18b,atomic,Qakbot Recon,A list of commands known to be performed by Qakbot for recon purposes,discovery,T1016,System Network Configuration Discovery
c93306256db4e763315631b158c37d78,atomic,Show if a user account has ever logged in remotely,"Show if a user account has ever logged in remotely
",discovery,T1087.001,Account Discovery: Local Account
c58ba91431b9d73d726ccdd7d030a694,atomic,WinPwn - General privesc checks,General privesc checks using the otherchecks function of WinPwn,discovery,T1082,System Information Discovery
28533078a7bb86154fcb6d2236fe59b4,atomic,Adfind - Enumerate Active Directory Exchange AD Objects,"Adfind tool can be used for reconnaissance in an Active directory environment. This example has been documented by ransomware actors enumerating Active Directory Exchange Objects
reference- http://www.joeware.net/freetools/tools/adfind/, https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html
",discovery,T1087.002,Account Discovery: Domain Account
71b3d2945679566b9d94d8cb11df4b70,atomic,List Windows Firewall Rules,"Enumerates Windows Firewall Rules using netsh.

Upon successful execution, cmd.exe will spawn netsh.exe to list firewall rules. Output will be via stdout.
",discovery,T1016,System Network Configuration Discovery
ff603d97a57715d3c2a1de941419d661,atomic,View sudoers access,"(requires root)
",discovery,T1087.001,Account Discovery: Local Account
4f978da47c3dfb3fbf98ecc3cc99c92b,atomic,Discover System Language by Registry Query,"Identify System language by querying the registry on an endpoint. 

Upon successful execution, result in number format can be looked up to correlate the language.
",discovery,T1614.001,System Location Discovery: System Language Discovery
f3d8f2ef5a4cbe2e39f093f31c62f38f,atomic,Griffon Recon,"This script emulates the reconnaissance script seen in used by Griffon and was modified by security researcher Kirk Sayre 
in order simply print the recon results to the screen as opposed to exfiltrating them. [Script](https://gist.github.com/kirk-sayre-work/7cb5bf4e2c7c77fa5684ddc17053f1e5).  
For more information see also [https://malpedia.caad.fkie.fraunhofer.de/details/js.griffon](https://malpedia.caad.fkie.fraunhofer.de/details/js.griffon) and [https://attack.mitre.org/software/S0417/](https://attack.mitre.org/software/S0417/)",discovery,T1082,System Information Discovery
01a25d2158c216cd645bbadf09015abf,atomic,System Time Discovery,"Identify the system time. Upon execution, the local computer system time and timezone will be displayed.
",discovery,T1124,System Time Discovery
958ef3f865356e682d569ff36cbf88de,atomic,List opened files by user,"List opened files by user
",discovery,T1087.001,Account Discovery: Local Account
01f95fd0213aeb1eb07fca8dc548f5ce,atomic,WinPwn - fruit,Search for potentially vulnerable web apps (low hanging fruits) using fruit function of WinPwn,discovery,T1046,Network Service Discovery
02f9ca082a6b35c0a753ce362dfea6f2,atomic,Adfind - Enumerate Active Directory Computer Objects,"Adfind tool can be used for reconnaissance in an Active directory environment. This example has been documented by ransomware actors enumerating Active Directory Computer Objects
reference- http://www.joeware.net/freetools/tools/adfind/, https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html
",discovery,T1018,Remote System Discovery
a2946687ae1138d23b0dc040e43d0eb5,atomic,Enumerate Default Domain Admin Details (Domain),"This test will enumerate the details of the built-in domain admin account
",discovery,T1087.002,Account Discovery: Domain Account
efc8346315601012db4a1f9afd7436a4,atomic,Display group policy information via gpresult,"Uses the built-in Windows utility gpresult to display the Resultant Set of Policy (RSoP) information for a remote user and computer
The /z parameter displays all available information about Group Policy. More parameters can be found in the linked Microsoft documentation
https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/gpresult
https://unit42.paloaltonetworks.com/emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve/
Turla has used the /z and /v parameters: https://www.welivesecurity.com/wp-content/uploads/2020/05/ESET_Turla_ComRAT.pdf
",discovery,T1615,Group Policy Discovery
9b5a0a6644a9cccc3dc3aa8be490430e,atomic,System Network Configuration Discovery (TrickBot Style),"Identify network configuration information as seen by Trickbot and described here https://www.sneakymonkey.net/2019/10/29/trickbot-analysis-part-ii/

Upon successful execution, cmd.exe will spawn `ipconfig /all`, `net config workstation`, `net view /all /domain`, `nltest /domain_trusts`. Output will be via stdout.
",discovery,T1016,System Network Configuration Discovery
743517fa2f3b55455ac00bf5278dfb67,atomic,Network Share Discovery command prompt,"Network Share Discovery utilizing the command prompt. The computer name variable may need to be modified to point to a different host
Upon execution avalaible network shares will be displayed in the powershell session
",discovery,T1135,Network Share Discovery
413fc5fa7ac34f8a42183217d7f3ec90,atomic,WinPwn - PowerSharpPack - Sharpup checking common Privesc vectors,PowerSharpPack - Sharpup checking common Privesc vectors technique via function of WinPwn - Takes several minutes to complete.,discovery,T1082,System Information Discovery
e6a9fe7e91030f05ad87b75ad4fd4a3a,atomic,WinPwn - winPEAS,Discover Local Privilege Escalation possibilities using winPEAS function of WinPwn,discovery,T1082,System Information Discovery
ef70c2665d6e37720964fcd4f38c5ec8,atomic,Adfind - Enumerate Active Directory OUs,"Adfind tool can be used for reconnaissance in an Active directory environment. This example has been documented by ransomware actors enumerating Active Directory OUs
reference- http://www.joeware.net/freetools/tools/adfind/, https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html
",discovery,T1482,Domain Trust Discovery
3c73b47eb1df2065b8f45449b754c859,atomic,Remote System Discovery - ip route,"Use the ip route command to display the kernels routing tables. 
",discovery,T1018,Remote System Discovery
57296a2ddbeb7423c05feef2fe972111,atomic,Examine local password policy - Windows,"Lists the local password policy to console on Windows.
",discovery,T1201,Password Policy Discovery
942316dc6a362e44b248a872e5f42c92,atomic,System Owner/User Discovery,"Identify System owner or users on an endpoint.

Upon successful execution, cmd.exe will spawn multiple commands against a target host to identify usernames. Output will be via stdout. 
Additionally, two files will be written to disk - computers.txt and usernames.txt.
",discovery,T1033,System Owner/User Discovery
e1f9618acc7e0232967e78b6274251da,atomic,AWS - EC2 Enumeration from Cloud Instance,"This atomic runs several API calls (sts:GetCallerIdentity, s3:ListBuckets, iam:GetAccountSummary, iam:ListRoles, iam:ListUsers, iam:GetAccountAuthorizationDetails, ec2:DescribeSnapshots, cloudtrail:DescribeTrails, guardduty:ListDetectors) from the context of an EC2 instance role. This simulates an attacker compromising an EC2 instance and running initial discovery commands on it. This atomic test leverages a tool called stratus-red-team built by DataDog (https://github.com/DataDog/stratus-red-team). Stratus Red Team is a self-contained binary. You can use it to easily detonate offensive attack techniques against a live cloud environment. Ref: https://stratus-red-team.cloud/attack-techniques/AWS/aws.discovery.ec2-enumerate-from-instance/
",discovery,T1580,Cloud Infrastructure Discovery
dca8b042fcdffcc1f5cddcff4122c434,atomic,System Information Discovery,"Identify System Info. Upon execution, system info and time info will be displayed.
",discovery,T1082,System Information Discovery
4f4b640f1cc25b1ecc03690327517411,atomic,System Service Discovery - systemctl,"Enumerates system service using systemctl
",discovery,T1007,System Service Discovery
159b2830fb32d9c87cd3abed764fcdf4,atomic,Examine AWS Password Policy,"This atomic test will display details about the password policy for the current AWS account.
",discovery,T1201,Password Policy Discovery
8be175eb24a31c5765554a8d8f70fc9a,atomic,Get-wmiobject to Enumerate Domain Controllers,"The following Atomic test will utilize get-wmiobject to enumerate Active Directory for Domain Controllers.
Upon successful execution a listing of Systems from AD will output with their paths.
Reference: https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-wmiobject?view=powershell-5.1
",discovery,T1018,Remote System Discovery
feb9647c55185e3b6045293fd26f6a5b,atomic,Get-ForestTrust with PowerView,"Utilizing PowerView, run Get-ForestTrust to identify forest trusts. Upon execution, progress and info about forest trusts within the domain being scanned will be displayed.
",discovery,T1482,Domain Trust Discovery
a088eb8a2130689fa774ec2653f79db1,atomic,System Service Discovery - net.exe,"Enumerates started system services using net.exe and writes them to a file. This technique has been used by multiple threat actors.

Upon successful execution, net.exe will run from cmd.exe that queries services. Expected output is to a txt file in in the temp directory called service-list.txt.
",discovery,T1007,System Service Discovery
6103e503cb444bc7b4187704f2035708,atomic,Basic Permission Groups Discovery Windows (Domain),"Basic Permission Groups Discovery for Windows. This test will display some errors if run on a computer not connected to a domain. Upon execution, domain
information will be displayed.
",discovery,T1069.002,Permission Groups Discovery: Domain Groups
b5b9bf30b09bf2f3367effa3022e7aa7,atomic,Environment variables discovery on windows,"Identify all environment variables. Upon execution, environments variables and your path info will be displayed.
",discovery,T1082,System Information Discovery
8ed60dceb98746f1da6214f4f6af7164,atomic,System Network Connections Discovery with PowerShell,"Get a listing of network connections.

Upon successful execution, powershell.exe will execute `get-NetTCPConnection`. Results will output via stdout.
",discovery,T1049,System Network Connections Discovery
009e7a7118b5a182b2a5b65150e5cc6f,atomic,WinPwn - Powersploits privesc checks,Powersploits privesc checks using oldchecks function of WinPwn,discovery,T1082,System Information Discovery
b71736aec5f0386d81a9d711a948e86b,atomic,List Open Egress Ports,"This is to test for what ports are open outbound.  The technique used was taken from the following blog:
https://www.blackhillsinfosec.com/poking-holes-in-the-firewall-egress-testing-with-allports-exposed/

Upon successful execution, powershell will read top-128.txt (ports) and contact each port to confirm if open or not. Output will be to Desktop\open-ports.txt.
",discovery,T1016,System Network Configuration Discovery
26d3702887944abcc64b406baf8f8e43,atomic,Enumerate users and groups,"Utilize groups and id to enumerate users and groups
",discovery,T1087.001,Account Discovery: Local Account
e2b2740289f34f77d74720f5c9edce3b,atomic,Adfind -Listing password policy,"Adfind tool can be used for reconnaissance in an Active directory environment. The example chosen illustrates adfind used to query the local password policy.
reference- http://www.joeware.net/freetools/tools/adfind/, https://social.technet.microsoft.com/wiki/contents/articles/7535.adfind-command-examples.aspx
",discovery,T1087.002,Account Discovery: Domain Account
d29305a9be37f6892e33f7ee7c06b880,atomic,Remote System Discovery - ip tcp_metrics,"Use the ip tcp_metrics command to display the recent cached entries for IPv4 and IPv6 source and destination addresses. 
",discovery,,
bf4dc95d64c15935ed1db8c98bb21133,atomic,Remote System Discovery - ping sweep,"Identify remote systems via ping sweep.

Upon successful execution, cmd.exe will perform a for loop against the 192.168.1.1/24 network. Output will be via stdout.
",discovery,T1018,Remote System Discovery
c094dbd7b13ef134c59b6c211c4bb5ba,atomic,Discover System Language by Environment Variable Query,"Identify System language by checking the environment variables

Upon successful execution, the 5 character locale result can be looked up to
correlate the language and territory. Environment query commands are likely
to run with a pattern match command e.g. `env | grep LANG`

Note: `env` and `printenv` will usually provide the same results. `set` is
also used as a builtin command that does not generate syscall telemetry but
does provide a list of the environment variables.
",discovery,T1614.001,System Location Discovery: System Language Discovery
40e77f5ee2d3d426ec1a7eb624df6f2f,atomic,Discover System Language by locale file,"Identify System language with the by reading the locale configuration file.

The locale configuration file contains the `LANG` environment variable which
will contain the 5 character locale that can be looked up to correlate the
language and territory.
",discovery,T1614.001,System Location Discovery: System Language Discovery
54f95564a265f67159d1f8ff907cd156,atomic,Enumerate COM Objects in Registry with Powershell,"This test is designed to enumerate the COM objects listed in HKCR, then output their methods and CLSIDs to a text file.
An adversary could then use this information to identify COM objects that might be vulnerable to abuse, such as using them to spawn arbitrary processes. 
See: https://www.mandiant.com/resources/hunting-com-objects",discovery,T1012,Query Registry
d6bb2a19da7246731ed9c44831b135f8,atomic,System Service Discovery,"Identify system services.

Upon successful execution, cmd.exe will execute service commands with expected result to stdout.
",discovery,T1007,System Service Discovery
d3305a715918c2d6b60c42e9071247b1,atomic,Enumerate logged on users via CMD (Domain),"Enumerate logged on users. Upon exeuction, logged on users will be displayed.
",discovery,T1087.002,Account Discovery: Domain Account
f3c05269abfec53a1ea9b6d75dcce176,atomic,Remote System Discovery - net,"Identify remote systems with net.exe.

Upon successful execution, cmd.exe will execute `net.exe view` and display results of local systems on the network that have file and print sharing enabled.
",discovery,T1018,Remote System Discovery
bc34d6834bdf568e206627f7809a556f,atomic,WinPwn - spoolvulnscan,Start MS-RPRN RPC Service Scan using spoolvulnscan function of WinPwn,discovery,T1046,Network Service Discovery
b7e7e9eb804006a78cdd75940f7b7c3e,atomic,WinPwn - GeneralRecon,Collect general computer informations via GeneralRecon function of WinPwn,discovery,T1082,System Information Discovery
c8fa438e6b9728cf7fa05dfd4a80b2f3,atomic,Adfind - Enumerate Active Directory Domain Controller Objects,"Adfind tool can be used for reconnaissance in an Active directory environment. This example has been documented by ransomware actors enumerating Active Directory Domain Controller Objects
reference- http://www.joeware.net/freetools/tools/adfind/, https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html
",discovery,T1018,Remote System Discovery
157278cc77e4503c58945cec5129f566,atomic,Adfind - Enumerate Active Directory User Objects,"Adfind tool can be used for reconnaissance in an Active directory environment. This example has been documented by ransomware actors enumerating Active Directory User Objects
reference- http://www.joeware.net/freetools/tools/adfind/, https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html
",discovery,T1087.002,Account Discovery: Domain Account
ebc55b8de493510344b6a0e6d34387a3,atomic,Use of SecEdit.exe to export the local security policy (including the password policy),"SecEdit.exe can be used to export the current local security policy applied to a host.
[Reference](https://blueteamops.medium.com/secedit-and-i-know-it-595056dee53d)
",discovery,T1201,Password Policy Discovery
8afbf7b71eb22ce8a3d64218f6a8128f,atomic,List Safari Bookmarks on MacOS,"This test searches for Safari's Bookmarks file (on macOS) and lists any found instances to a text file.
",discovery,T1217,Browser Bookmark Discovery
d84a4fab3739f1dca177364e5c4b02a4,atomic,Port Scan Nmap,"Scan ports to check for listening ports with Nmap.

Upon successful execution, sh will utilize nmap, telnet, and nc to contact a single or range of adresseses on port 80 to determine if listening. Results will be via stdout.
",discovery,T1046,Network Service Discovery
2bf75f949823305d3ea815c8e94e9ee3,atomic,User Discovery With Env Vars PowerShell Script,Use the PowerShell environment variables to identify the current logged user.,discovery,T1033,System Owner/User Discovery
53571e9988b92014f9d71888936d3878,atomic,Get-DomainTrust with PowerView,"Utilizing PowerView, run Get-DomainTrust to identify domain trusts. Upon execution, progress and info about trusts within the domain being scanned will be displayed.
",discovery,T1482,Domain Trust Discovery
6e5ddcde678698ef20f1a9d90d81cf23,atomic,SharpHound3 - LocalAdmin,"This module runs the Windows executable of SharpHound in order to remotely list members of the local Administrators group (SAMR)
",discovery,T1069.001,Permission Groups Discovery: Local Groups
ee41528024c63881b53302e996a79020,atomic,Enumerate all accounts (Domain),"Enumerate all accounts
Upon exection, multiple enumeration commands will be run and their output displayed in the PowerShell session
",discovery,T1087.002,Account Discovery: Domain Account
0954576f69ca8e140f2cdc9e58b36ff9,atomic,WinPwn - DotNet,Search for .NET Service-Binaries on this system via winpwn dotnet function of WinPwn.,discovery,T1518,Software Discovery
e528524d6a3cddaaddc89fcc719e2a3f,atomic,Enumerate all accounts via PowerShell (Local),"Enumerate all accounts via PowerShell. Upon execution, lots of user account and group information will be displayed.
",discovery,T1087.001,Account Discovery: Local Account
278b4cdafa0ddc90b98bc2ce8df2c05f,atomic,List OS Information,"Identify System Info
",discovery,T1082,System Information Discovery
130bbfbbd1c09a723a3ad848f0ef8da5,atomic,TruffleSnout - Listing AD Infrastructure,"Iterative AD discovery toolkit for offensive operators. Situational awareness and targeted low noise enumeration. Preference for OpSec.- https://github.com/dsnezhkov/TruffleSnout
",discovery,T1482,Domain Trust Discovery
90cac81169ebb96b4bfdc0c17a507b67,atomic,List Mozilla Firefox Bookmark Database Files on Linux,"Searches for Mozilla Firefox's places.sqlite file (on Linux distributions) that contains bookmarks and lists any found instances to a text file.
",discovery,T1217,Browser Bookmark Discovery
1d3cb1429f530cb89f41c65e57f03db4,atomic,Query Registry,"Query Windows Registry.
Upon successful execution, cmd.exe will perform multiple reg queries. Some will succeed and others will fail (dependent upon OS).
References:
https://blog.cylance.com/windows-registry-persistence-part-2-the-run-keys-and-search-order
https://blog.cylance.com/windows-registry-persistence-part-1-introduction-attack-phases-and-windows-services
http://www.handgrep.se/repository/cheatsheets/postexploitation/WindowsPost-Exploitation.pdf
https://www.offensive-security.com/wp-content/uploads/2015/04/wp.Registry_Quick_Find_Chart.en_us.pdf
",discovery,T1012,Query Registry
725f6e03f3e2098c4303861566f18894,atomic,System Discovery - SocGholish whoami,"SocGholish performs whoami discovery commands and outputs the results to a tmp file. 
The test will generate a filename similar to the random one generated during execution and write the file to AppData\Temp.

Reference: https://redcanary.com/threat-detection-report/threats/socgholish/
",discovery,T1033,System Owner/User Discovery
7a5ceaef032a7b9696c9e032574e2476,atomic,DNS Server Discovery Using nslookup,"Identify System domain dns controller on an endpoint using nslookup ldap query. This tool is being abused by qakbot malware to gather information on the domain
controller of the targeted or compromised host. reference https://securelist.com/qakbot-technical-analysis/103931/
",discovery,T1016,System Network Configuration Discovery
fcb5b04ee56a74c73f29b9eecb6d4b17,atomic,Remote System Discovery - nltest,"Identify domain controllers for specified domain.

Upon successful execution, cmd.exe will execute nltest.exe against a target domain to retrieve a list of domain controllers. Output will be via stdout.
",discovery,T1018,Remote System Discovery
9a19a8680e50aacc850e0dea64bd57dc,atomic,Network Service Discovery for Containers,"Attackers may try to obtain a list of services that are operating on remote hosts and local network infrastructure devices, in order to identify potential vulnerabilities that can be exploited through remote software attacks. They typically use tools to conduct port and vulnerability scans in order to obtain this information.",discovery,T1046,Network Service Discovery
eaf91088bebfec0863a94bbee470f9f2,atomic,System Time Discovery in macOS,"Identify system time. Upon execution, the local computer system time and timezone will be displayed. 
",discovery,T1124,System Time Discovery
7f1915b1e29069b2d91dfabf4177f13c,atomic,List Mozilla Firefox Bookmark Database Files on macOS,"Searches for Mozilla Firefox's places.sqlite file (on macOS) that contains bookmarks and lists any found instances to a text file.
",discovery,T1217,Browser Bookmark Discovery
6913e132cdd2d9c29294490c2fbef2eb,atomic,System Time Discovery - PowerShell,"Identify the system time via PowerShell. Upon execution, the system time will be displayed.
",discovery,T1124,System Time Discovery
d2b459d6fa4aa8fa31e745e1b3d737c3,atomic,System Time Discovery W32tm as a Delay,"identifies DCRat delay time tactics using w32tm.
https://research.splunk.com/endpoint/b2cc69e7-11ba-42dc-a269-59c069a48870/
https://blogs.blackberry.com/en/2022/05/dirty-deeds-done-dirt-cheap-russian-rat-offers-backdoor-bargains
",discovery,T1124,System Time Discovery
a9faa0d792d6bc2660b05e7650d2736d,atomic,WinPwn - Morerecon,Gathers local system information using the Morerecon function of WinPwn,discovery,T1082,System Information Discovery
0a96ef5851da1be487cebdd9a1f86b7a,atomic,Find Local Admins via Group Policy (PowerView),"takes a computer and determines who has admin rights over it through GPO enumeration. Upon execution, information about the machine will be displayed.
",discovery,T1069.002,Permission Groups Discovery: Domain Groups
25bbb222a91d007fa29ace7c586b418c,atomic,Kerbrute - userenum,Enumerates active directory usernames using the userenum function of Kerbrute,discovery,T1087.002,Account Discovery: Domain Account
518cee20267133203fc5d92cdc38af8c,atomic,Port Scan using python,"Scan ports to check for listening ports with python
",discovery,T1046,Network Service Discovery
856ccc398377c9404685983bc04dabb2,atomic,Adfind - Query Active Directory Groups,"Adfind tool can be used for reconnaissance in an Active directory environment. This example has been documented by ransomware actors enumerating Active Directory Groups
reference- http://www.joeware.net/freetools/tools/adfind/, https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html
",discovery,T1069.002,Permission Groups Discovery: Domain Groups
a700a94fea368d729fc80dee172fb09a,atomic,Examine password complexity policy - CentOS/RHEL 7.x,"Lists the password complexity policy to console on CentOS/RHEL 7.x Linux.
",discovery,T1201,Password Policy Discovery
f5dd56d901db9f95668988426326bc3a,atomic,Enumerate Users Not Requiring Pre Auth (ASRepRoast),"When successful, accounts that do not require kerberos pre-auth will be returned
",discovery,T1069.002,Permission Groups Discovery: Domain Groups
5a1dc4ce41e376e1928d3a399ccadff3,atomic,MSFT Get-GPO Cmdlet,The Get-GPO cmdlet gets one Group Policy Object (GPO) or all the GPOs in a domain. Tested on Windows Server 2019 as a domain user with computer joined to domain. Reference: https://docs.microsoft.com/en-us/powershell/module/grouppolicy/get-gpo?view=windowsserver2022-ps,discovery,T1615,Group Policy Discovery
25b475e94dd2d70fcc66b2ce43c8f718,atomic,Network Share Discovery PowerShell,"Network Share Discovery utilizing PowerShell. The computer name variable may need to be modified to point to a different host
Upon execution, avalaible network shares will be displayed in the powershell session
",discovery,T1135,Network Share Discovery
f247309a5f934b32f2e510eb50409d3b,atomic,View available share drives,"View information about all of the resources that are shared on the local computer Upon execution, avalaible share drives will be displayed in the powershell session",discovery,T1135,Network Share Discovery
278255b5ed85eebe3eab6c0a3d3d135b,atomic,Environment variables discovery on macos and linux,"Identify all environment variables. Upon execution, environments variables and your path info will be displayed.
",discovery,T1082,System Information Discovery
214be4092770061080ef0781c26bab3e,atomic,Get-DomainPolicy with PowerView,"Utilizing PowerView, run Get-DomainPolicy to return the default domain policy or the domain controller policy for the current domain or a specified domain/domain controller.
",discovery,T1201,Password Policy Discovery
abc25aecd2ed0524af31e79add29cc43,atomic,List Google Chrome / Opera Bookmarks on Windows with powershell,"Searches for Google Chrome's and Opera's Bookmarks file (on Windows distributions) that contains bookmarks.
Upon execution, paths that contain bookmark files will be displayed.
",discovery,T1217,Browser Bookmark Discovery
f3e078e1df8bd7b934236b5d82f012de,atomic,System Time with Windows time Command,"Displays the current system time via the Windows builtin time command: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/time
Recently observed in use in the wild during an incident involving Ursnif malware:
https://github.com/The-DFIR-Report/Sigma-Rules/blob/dc72f0b557fc63347379be0a33439788256761c8/rules/windows/process_creation/proc_creation_win_system_time_lookup.yml
https://thedfirreport.com/2023/01/09/unwrapping-ursnifs-gifts/
",discovery,T1124,System Time Discovery
6334877e8e3ba48f7835d4856d90a282,atomic,Enumerate all accounts on Windows (Local),"Enumerate all accounts
Upon execution, multiple enumeration commands will be run and their output displayed in the PowerShell session
",discovery,T1087.001,Account Discovery: Local Account
ade7be51b815cbf8908ec931256374b6,atomic,Remote System Discovery - arp nix,"Identify remote systems via arp.

Upon successful execution, sh will execute arp to list out the arp cache. Output will be via stdout.
",discovery,,
628181210e822588b5d90e1e256d775a,atomic,WinPwn - itm4nprivesc,Discover Local Privilege Escalation possibilities using itm4nprivesc function of WinPwn,discovery,T1082,System Information Discovery
fcef063a231fb18e8a4b87f96a97fd5b,atomic,Adfind - Enumerate Active Directory Admins,"Adfind tool can be used for reconnaissance in an Active directory environment. This example has been documented by ransomware actors enumerating Active Directory Admin accounts
reference- http://www.joeware.net/freetools/tools/adfind/, https://stealthbits.com/blog/fun-with-active-directorys-admincount-attribute/
",discovery,T1087.002,Account Discovery: Domain Account
4bf4facd1dad540d4b17ebe0db235707,atomic,WinPwn - generaldomaininfo,Gathers general domain information using the generaldomaininfo function of WinPwn,discovery,T1087.002,Account Discovery: Domain Account
6f56fb95b173768d748414faf2db6588,atomic,Remote System Discovery - net group Domain Controller,"Identify remote systems with net.exe querying the Active Directory Domain Controller.
Upon successful execution, cmd.exe will execute cmd.exe against Active Directory to list the ""Domain Controller"" in the domain. Output will be via stdout.
",discovery,T1018,Remote System Discovery
7d8ee68f0e9731db82964f558f614608,atomic,System Network Configuration Discovery on Windows,"Identify network configuration information

Upon successful execution, cmd.exe will spawn multiple commands to list network configuration settings. Output will be via stdout.
",discovery,T1016,System Network Configuration Discovery
38714562d32f33dc32bd7aef553771d9,atomic,Get-DomainGPO to display group policy information via PowerView,Use PowerView to Get-DomainGPO This will only work on Windows 10 Enterprise and A DC Windows 2019.,discovery,T1615,Group Policy Discovery
69bbe2183fa09c00ccaac62d48e214f8,atomic,List Internet Explorer Bookmarks using the command prompt,This test will list the bookmarks for Internet Explorer that are found in the Favorites folder,discovery,T1217,Browser Bookmark Discovery
e60171028e1c0f57bc9ceebfd32dcd64,atomic,Container and ResourceDiscovery,Adversaries may attempt to discover containers and other resources that are available within a containers environment.,discovery,T1613,Container and Resource Discovery
8f17c5e3ca9e2db88111d002c811ddac,atomic,PowerView ShareFinder,PowerView is a PowerShell tool to gain network situational awareness on Windows domains. ShareFinder finds (non-standard) shares on machines in the domain.,discovery,T1135,Network Share Discovery
e7d023dfcc77f4b701b6cdce79e9c3c2,atomic,Hostname Discovery (Windows),"Identify system hostname for Windows. Upon execution, the hostname of the device will be displayed.
",discovery,T1082,System Information Discovery
4b325a29e936cd1ccac2292bc92a31b5,atomic,Share Discovery with PowerView,"Enumerate Domain Shares the current user has access. Upon execution, progress info about each share being scanned will be displayed.
",discovery,T1135,Network Share Discovery
57548b3eefc3c3d3eaf8c3b51380921a,atomic,WinPwn - powerSQL,Start PowerUpSQL Checks using powerSQL function of WinPwn,discovery,T1518,Software Discovery
099c4e98d840c7fba1724e8015b88a20,atomic,Find and Display Safari Browser Version,"Adversaries may attempt to get a listing of non-security related software that is installed on the system. Adversaries may use the information from Software Discovery during automated discovery to shape follow-on behaviors
",discovery,T1518,Software Discovery
ced42979f76b8fc19c1afffad66beed5,atomic,Permission Groups Discovery (Local),"Permission Groups Discovery
",discovery,T1069.001,Permission Groups Discovery: Local Groups
196263c4c1f42138866d958193ad2ad4,atomic,Enumerate Linked Policies In ADSISearcher Discovery,"The following Atomic test will utilize ADSISearcher to enumerate organizational unit within Active Directory.
Upon successful execution a listing of users will output with their paths in AD.
Reference: https://medium.com/@pentesttas/discover-hidden-gpo-s-on-active-directory-using-ps-adsi-a284b6814c81
",discovery,T1087.002,Account Discovery: Domain Account
5c010088084e0d6cc72f2632b021dc4d,atomic,Linux VM Check via Kernel Modules,"Identify virtual machine guest kernel modules. This technique is used by the Pupy RAT and other malware.
",discovery,T1082,System Information Discovery
62b88a98e32cac28c744db4fcad3a0dd,atomic,Port Scan,"Scan ports to check for listening ports.

Upon successful execution, sh will perform a network connection against a single host (192.168.1.1) and determine what ports are open in the range of 1-65535. Results will be via stdout.
",discovery,,
ffe23675b3b68eb6d2b6e771451de3af,atomic,Wevtutil - Discover NTLM Users Remote,"This test discovers users who have authenticated against a Domain Controller via NTLM. 
This is done remotely via wmic and captures the event code 4776 from the domain controller and stores the ouput in C:\temp. [Reference](https://www.reliaquest.com/blog/socgholish-fakeupdates/)
",discovery,T1087.002,Account Discovery: Domain Account
1cac00896661be81f2dd242c94bb84be,atomic,Remote System Discovery - sweep,"Identify remote systems via ping sweep.

Upon successful execution, sh will perform a ping sweep on the 192.168.1.1/24 and echo via stdout if an IP is active.
",discovery,T1018,Remote System Discovery
8f85d74c3e78c652a9162dcf1296b404,atomic,Enumerate logged on users via CMD (Local),"Enumerate logged on users. Upon execution, logged on users will be displayed.
",discovery,T1087.001,Account Discovery: Local Account
cfcf66cc85109ad2ebdb301d619fa41f,atomic,Find computers where user has session - Stealth mode (PowerView),"Find existing user session on other computers. Upon execution, information about any sessions discovered will be displayed.",discovery,T1033,System Owner/User Discovery
03c8721619373b6c18a55721a33cad2c,atomic,Find machines where user has local admin access (PowerView),"Find machines where user has local admin access (PowerView). Upon execution, progress and info about each host in the domain being scanned will be displayed.
",discovery,T1069.002,Permission Groups Discovery: Domain Groups
109b73cd939f52db23f842589138d79c,atomic,Powershell enumerate domains and forests,"Use powershell to enumerate AD information.
Requires the installation of PowerShell AD admin cmdlets via Windows RSAT or the Windows Server AD DS role.
",discovery,T1482,Domain Trust Discovery
e958169f1efe85a5a5ea7a77eba8c29e,atomic,WinPwn - MS17-10,Search for MS17-10 vulnerable Windows Servers in the domain using powerSQL function of WinPwn,discovery,T1046,Network Service Discovery
eba68ea18bc9ac93808fffbdcf7c3a3f,atomic,Discover Specific Process - tasklist,"Adversaries may use command line tools to discover specific processes in preparation of further attacks. 
Examples of this could be discovering the PID of lsass.exe to dump its memory or discovering whether specific security processes (e.g. AV or EDR) are running.
",discovery,T1057,Process Discovery
44705da4b28c8fa57fc2a2940b34565a,atomic,System Information Discovery,"Identify System Info
",discovery,T1082,System Information Discovery
fc5dd23fbe8b66fdfc6501a601ba9b86,atomic,Examine password complexity policy - CentOS/RHEL 6.x,"Lists the password complexity policy to console on CentOS/RHEL 6.x Linux.
",discovery,T1201,Password Policy Discovery
4370001012f5f0df001269627b4737e9,atomic,System Owner/User Discovery,"Identify System owner or users on an endpoint

Upon successful execution, sh will stdout list of usernames.
",discovery,T1033,System Owner/User Discovery
61b75b3c87d87f8f1983ebf9c6e3f960,atomic,Security Software Discovery - ps (Linux),"Methods to identify Security Software on an endpoint
when sucessfully executed, command shell  is going to display AV/Security software it is running.
",discovery,T1518.001,Software Discovery: Security Software Discovery
7d07e97d0fb537914ab52056b230eb35,atomic,Nix File and Directory Discovery,"Find or discover files on the file system

References:

http://osxdaily.com/2013/01/29/list-all-files-subdirectory-contents-recursively/

https://perishablepress.com/list-files-folders-recursively-terminal/
",discovery,T1083,File and Directory Discovery
57781057e51ffecf21e38fd31c9d2f79,atomic,Get-DomainGroup with PowerView,"Utilizing PowerView, run Get-DomainGroup to identify the domain groups. Upon execution, Groups within the domain will be listed.
",discovery,T1069.002,Permission Groups Discovery: Domain Groups
9381d0e0efbf5bf89a9e512f8b3745f4,atomic,WinPwn - bluekeep,Search for bluekeep vulnerable Windows Systems in the domain using bluekeep function of WinPwn. Can take many minutes to complete (~600 seconds in testing on a small domain).,discovery,T1046,Network Service Discovery
f071213a29669283eeb8ab07ddffdbfb,atomic,Enumerate Active Directory Groups with Get-AdGroup,"The following Atomic test will utilize Get-AdGroup to enumerate groups within Active Directory.
Upon successful execution a listing of groups will output with their paths in AD.
Reference: https://docs.microsoft.com/en-us/powershell/module/activedirectory/get-adgroup?view=windowsserver2022-ps
",discovery,T1069.002,Permission Groups Discovery: Domain Groups
286916316d725933021d57fb5620d644,atomic,WinPwn - PowerSharpPack - Watson searching for missing windows patches,PowerSharpPack - Watson searching for missing windows patches  technique via function of WinPwn,discovery,T1082,System Information Discovery
0869b5ecbbe4324d7858ba54addfd9b0,atomic,System Discovery using SharpView,"Get a listing of network connections, domains, domain users, and etc.  
sharpview.exe located in the bin folder, an opensource red-team tool.
Upon successful execution, cmd.exe will execute sharpview.exe <method>. Results will output via stdout.
",discovery,T1049,System Network Connections Discovery
75393d8dae4e8777283b12eacdf63ba0,atomic,Network Share Discovery - linux,"Network Share Discovery using smbstatus
",discovery,T1135,Network Share Discovery
834e861bba95b87d066e84c5c6b056a0,atomic,WinPwn - GPORemoteAccessPolicy,Enumerate remote access policies through group policy using GPORemoteAccessPolicy function of WinPwn,discovery,T1615,Group Policy Discovery
ee12056a74be07c381877d47531429b6,atomic,List Google Chrome / Edge Chromium Bookmarks on Windows with command prompt,"Searches for Google Chromes's and Edge Chromium's Bookmarks file (on Windows distributions) that contains bookmarks.
Upon execution, paths that contain bookmark files will be displayed.
",discovery,T1217,Browser Bookmark Discovery
566b2f5743d88edb44ad1d9d450e921c,atomic,WinPwn - RBCD-Check,Search for Resource-Based Constrained Delegation attack paths using RBCD-Check function of WinPwn,discovery,T1082,System Information Discovery
9a014cd2d5b303f8e26bf8d92bb33877,atomic,Azure Security Scan with SkyArk,"Upon successful execution, this test will utilize a valid read-only Azure AD user's credentials to conduct a security scan and determine what users exist in a given tenant, as well as identify any admin users. 
Once the test is complete, a folder will be output to the temp directory that contains 3 csv files which provide info on the discovered users. 
See https://github.com/cyberark/SkyArk 
",discovery,T1082,System Information Discovery
a44bb43474728496276d5d73aa14588f,atomic,Remote System Discovery - arp,"Identify remote systems via arp. 

Upon successful execution, cmd.exe will execute arp to list out the arp cache. Output will be via stdout.
",discovery,T1018,Remote System Discovery
f32d25602b6c142d321b9a0965316916,atomic,Enumerate Active Directory Computers with Get-AdComputer,"The following Atomic test will utilize Get-AdComputer to enumerate Computers within Active Directory.
Upon successful execution a listing of Computers will output with their paths in AD.
Reference: https://github.com/MicrosoftDocs/windows-powershell-docs/blob/main/docset/winserver2022-ps/activedirectory/Get-ADComputer.md
",discovery,T1018,Remote System Discovery
16481dec717301784f90d52477f685a2,atomic,Examine password policy - macOS,"Lists the password policy to console on macOS.
",discovery,T1201,Password Policy Discovery
691d489fe77afbfe8646419fce6759fd,atomic,Query Registry with Powershell cmdlets,"Query Windows Registry with Powershell cmdlets, i.e., Get-Item and Get-ChildItem. The results from above can also be achieved with Get-Item and Get-ChildItem.
Unlike using ""reg query"" which then executes reg.exe, using cmdlets won't generate new processes, which may evade detection systems monitoring process generation. 
",discovery,T1012,Query Registry
5fdbb087d71613a73117423ef56c68ab,atomic,Examine password complexity policy - Ubuntu,"Lists the password complexity policy to console on Ubuntu Linux.
",discovery,T1201,Password Policy Discovery
97f08c0a2e89b3710d38bf6e4a6b2cbb,atomic,List macOS Firewall Rules,"""This will test if the macOS firewall is enabled and/or show what rules are configured. Must be run with elevated privileges. Upon successful execution, these commands will output various information about the firewall configuration, including status and specific port/protocol blocks or allows. 

Using `defaults`, additional arguments can be added to see filtered details, such as `globalstate` for global configuration (\""Is it on or off?\""), `firewall` for common application allow rules, and `explicitauths` for specific rules configured by the user. 

Using `socketfilterfw`, flags such as --getglobalstate or --listapps can be used for similar filtering. At least one flag is required to send parseable output to standard out. 
",discovery,T1016,System Network Configuration Discovery
c668e2597e8c0ebf1709f85d253995ab,atomic,System Network Connections Discovery Linux & MacOS,"Get a listing of network connections.

Upon successful execution, sh will execute `netstat` and `who -a`. Results will output via stdout.
",discovery,T1049,System Network Connections Discovery
0cb4473bdec66e428f811235aff1b620,atomic,Azure - Dump Subscription Data with MicroBurst,"Upon successful execution, this test will enumerate all resources that are contained within a valid Azure subscription. 
The resources enumerated will display on screen, as well as several csv files and folders will be output to a specified directory, listing what resources were discovered by the script. 
See https://dev.to/cheahengsoon/enumerating-subscription-information-with-microburst-35a1
",discovery,T1526,Cloud Service Discovery
4fffde1941bd17fed24ac68fd5e354aa,atomic,Remote System Discovery - adidnsdump,"This tool enables enumeration and exporting of all DNS records in the zone for recon purposes of internal networks
Python 3 and adidnsdump must be installed, use the get_prereq_command's to meet the prerequisites for this test.
Successful execution of this test will list dns zones in the terminal.
",discovery,T1018,Remote System Discovery
301c21998e9aac686942a33d328248e7,atomic,Security Software Discovery,"Methods to identify Security Software on an endpoint

when sucessfully executed, the test is going to display running processes, firewall configuration on network profiles
and specific security software.
",discovery,T1518.001,Software Discovery: Security Software Discovery
b1ddc060c050bb98d81abf4070818a10,atomic,Examine password expiration policy - All Linux,"Lists the password expiration policy to console on CentOS/RHEL/Ubuntu.
",discovery,T1201,Password Policy Discovery
a14392d713dffba6a397682ff83259a0,atomic,System Network Connections Discovery,"Get a listing of network connections.

Upon successful execution, cmd.exe will execute `netstat`, `net use` and `net sessions`. Results will output via stdout.
",discovery,T1049,System Network Connections Discovery
4a37cc5d05b6ce7a7287247ecf1aa404,atomic,Hostname Discovery,"Identify system hostname for Linux and macOS systems.
",discovery,T1082,System Information Discovery
8c4228fa7e1c015590d1f13d935e5bb8,atomic,Enumerate Active Directory Password Policy with get-addefaultdomainpasswordpolicy,"The following Atomic test will utilize get-addefaultdomainpasswordpolicy to enumerate domain password policy.
Upon successful execution a listing of the policy implemented will display.
Reference: https://docs.microsoft.com/en-us/powershell/module/activedirectory/get-addefaultdomainpasswordpolicy?view=windowsserver2022-ps
",discovery,T1201,Password Policy Discovery
f25fb8543b8e49af2aba023985234d1e,atomic,Windows - Discover domain trusts with dsquery,"Uses the dsquery command to discover domain trusts.
Requires the installation of dsquery via Windows RSAT or the Windows Server AD DS role.
",discovery,T1482,Domain Trust Discovery
7b9c7afaefa59aab759b49af0d699ac1,atomic,Win32_PnPEntity Hardware Inventory,Perform peripheral device discovery using Get-WMIObject Win32_PnPEntity,discovery,T1120,Peripheral Device Discovery
d7967a23c8c030c698893f242e622be1,atomic,File and Directory Discovery (PowerShell),"Find or discover files on the file system. Upon execution, file and folder information will be displayed.
",discovery,T1083,File and Directory Discovery
681fd384d66be9e180a74e5fecdc4ab6,atomic,Enumerate domain computers within Active Directory using DirectorySearcher,"This test is a Powershell script that enumerates Active Directory to determine computers that are joined to the domain. 
This test is designed to mimic how SessionGopher can determine the additional systems within a domain, which has been used before by threat actors to aid in lateral movement. 
Reference: [Head Fake: Tackling Disruptive Ransomware Attacks](https://www.mandiant.com/resources/head-fake-tackling-disruptive-ransomware-attacks). 
Upon successful execution, this test will output the names of the computers that reside on the domain to the console window. 
",discovery,T1018,Remote System Discovery
b2a1e430ca6d36eb5af2fe666e769847,atomic,Process Discovery - wmic process,"Utilize windows management instrumentation to identify processes.

Upon successful execution, WMIC will execute process to list processes. Output will be via stdout. 
",discovery,T1057,Process Discovery
2594698a8e38a85b0d98468d87b49821,atomic,Get-DomainGroupMember with PowerView,"Utilizing PowerView, run Get-DomainGroupMember to identify domain users. Upon execution, progress and info about groups within the domain being scanned will be displayed.
",discovery,T1069.002,Permission Groups Discovery: Domain Groups
53f5c5712bf6c008a24c38fe60700d2e,atomic,Wmic Group Discovery,"Utilizing wmic.exe to enumerate groups on the local system. Upon execution, information will be displayed of local groups on system.
",discovery,T1069.001,Permission Groups Discovery: Local Groups
b8e136dad1af7b29939e86be6d7ecefa,atomic,WinPwn - PowerSharpPack - Seatbelt,"PowerSharpPack - Seatbelt technique via function of WinPwn.

[Seatbelt](https://github.com/GhostPack/Seatbelt) is a C# project that performs a number of security oriented host-survey ""safety checks"" relevant from both offensive and defensive security perspectives.",discovery,T1082,System Information Discovery
1d48fc4147a7bcd47bdf60db7dde9640,atomic,Process Discovery - Get-Process,"Utilize Get-Process PowerShell cmdlet to identify processes.

Upon successful execution, powershell.exe will execute Get-Process to list processes. Output will be via stdout. 
",discovery,T1057,Process Discovery
59703a9c143cdc58377b103a1c7acc59,atomic,View accounts with UID 0,"View accounts with UID 0
",discovery,T1087.001,Account Discovery: Local Account
72089a2bd4a6a6f792f996d39e6b9366,atomic,Permission Groups Discovery PowerShell (Domain),"Permission Groups Discovery utilizing PowerShell. This test will display some errors if run on a computer not connected to a domain. Upon execution, domain
information will be displayed.
",discovery,T1069.002,Permission Groups Discovery: Domain Groups
38f6f0e50a6b196140ec40d3dc9cc9e6,atomic,Examine domain password policy - Windows,"Lists the domain password policy to console on Windows.
",discovery,T1201,Password Policy Discovery
d8fedd81fc35099a5a3f1a8f5d2082dd,atomic,Remote System Discovery - net group Domain Computers,"Identify remote systems with net.exe querying the Active Directory Domain Computers group.

Upon successful execution, cmd.exe will execute cmd.exe against Active Directory to list the ""Domain Computers"" group. Output will be via stdout.
",discovery,T1018,Remote System Discovery
f489321f31b6ef36304294562d3d4645,atomic,Remote System Discovery - ip neighbour,"Use the ip neighbour command to display the known link layer (ARP table) addresses for hosts sharing the same network segment. 
",discovery,T1018,Remote System Discovery
42102f01777d40a7db982282c4c791e9,atomic,Get-ADUser Enumeration using UserAccountControl flags (AS-REP Roasting),"When successful, accounts that do not require kerberos pre-auth will be returned.
Reference: https://m0chan.github.io/2019/07/31/How-To-Attack-Kerberos-101.html
",discovery,T1069.002,Permission Groups Discovery: Domain Groups
613dc87cebac339d20973268e0bb1c0b,atomic,Enumerate Root Domain linked policies Discovery,"The following Atomic test will utilize ADSISearcher to enumerate root domain unit within Active Directory.
Upon successful execution a listing of users will output with their paths in AD.
Reference: https://medium.com/@pentesttas/discover-hidden-gpo-s-on-active-directory-using-ps-adsi-a284b6814c81
",discovery,T1087.002,Account Discovery: Domain Account
84a93e5157b690ee0f585cd55c15b0cb,atomic,Find local admins on all machines in domain (PowerView),"Enumerates members of the local Administrators groups across all machines in the domain. Upon execution, information about each machine will be displayed.
",discovery,T1069.002,Permission Groups Discovery: Domain Groups
76155f331bfb00e581a61edbeeafc661,atomic,Automated AD Recon (ADRecon),"ADRecon extracts and combines information about an AD environement into a report. Upon execution, an Excel file with all of the data will be generated and its
path will be displayed.
",discovery,T1087.002,Account Discovery: Domain Account
beafe61e6874eb9eec2119bd12255193,atomic,WinPwn - Dotnetsearch,Search for any .NET binary file in a share using the Dotnetsearch function of WinPwn,discovery,T1518,Software Discovery
fb491bb831fbb5d3dcd96c92a1aa1700,atomic,Adfind - Enumerate Active Directory Subnet Objects,"Adfind tool can be used for reconnaissance in an Active directory environment. This example has been documented by ransomware actors enumerating Active Directory Subnet Objects
reference- http://www.joeware.net/freetools/tools/adfind/, https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html
",discovery,T1016,System Network Configuration Discovery
548dc737f7e316338a51a0860bd9a89a,atomic,Elevated group enumeration using net group (Domain),"Runs ""net group"" command including command aliases and loose typing to simulate enumeration/discovery of high value domain groups. This
test will display some errors if run on a computer not connected to a domain. Upon execution, domain information will be displayed.
",discovery,T1069.002,Permission Groups Discovery: Domain Groups
a3c8fba61f02a7b96306b87121b2ac4b,atomic,WinPwn - GPOAudit,Check domain Group policies for common misconfigurations using Grouper2 via GPOAudit function of WinPwn,discovery,T1615,Group Policy Discovery
1ddf2b8ee6a56ce9f9132a168947653e,atomic,Process Discovery - get-wmiObject,"Utilize get-wmiObject PowerShell cmdlet to identify processes.

Upon successful execution, powershell.exe will execute get-wmiObject to list processes. Output will be via stdout. 
",discovery,T1057,Process Discovery
941eb886a05444e588fd6c17d992df98,atomic,WinPwn - printercheck,Search for printers / potential vulns using printercheck function of WinPwn,discovery,T1120,Peripheral Device Discovery
1d87f5f8838a166e5035179c33e3d615,atomic,Discover System Language with localectl,"Identify System language with the `localectl` command.

Upon successful execution, the key `System Locale` from the output will contain the
`LANG` environment variable that has the 5 character locale result that can be looked
up to correlate the language and territory.
",discovery,T1614.001,System Location Discovery: System Language Discovery
a09dd05a4de1fd52c13deada3209e4aa,atomic,File and Directory Discovery (cmd.exe),"Find or discover files on the file system.  Upon successful execution, this test will output the results of all the data discovery commands to a specified file.
",discovery,T1083,File and Directory Discovery
3ca47fba752a36e5492a747e16dd2311,atomic,System Information Discovery with WMIC,"Identify system information with the WMI command-line (WMIC) utility. Upon execution, various system information will be displayed, including: OS, CPU, GPU, and disk drive names; memory capacity; display resolution; and baseboard, BIOS, and GPU driver products/versions.
https://nwgat.ninja/getting-system-information-with-wmic-on-windows/
Elements of this test were observed in the wild used by Aurora Stealer in late 2022 and early 2023, as highlighted in public reporting:
https://blog.sekoia.io/aurora-a-rising-stealer-flying-under-the-radar
https://blog.cyble.com/2023/01/18/aurora-a-stealer-using-shapeshifting-tactics/
",discovery,T1082,System Information Discovery
5a33c31395b6ef3ee38097b327c8b79d,atomic,Enumerate Active Directory Users with ADSISearcher,"The following Atomic test will utilize ADSISearcher to enumerate users within Active Directory.
Upon successful execution a listing of users will output with their paths in AD.
Reference: https://devblogs.microsoft.com/scripting/use-the-powershell-adsisearcher-type-accelerator-to-search-active-directory/
",discovery,T1087.002,Account Discovery: Domain Account
8acfd16975bca1d9a7d03473196f38b5,atomic,Enumerate all accounts (Local),"Enumerate all accounts by copying /etc/passwd to another file
",discovery,T1087.001,Account Discovery: Local Account
98c8abc9362d5a3da76d23980572b5e2,atomic,Windows MachineGUID Discovery,"Identify the Windows MachineGUID value for a system. Upon execution, the machine GUID will be displayed from registry.
",discovery,T1082,System Information Discovery
0475abc9998e42d07d67958f96697eec,atomic,Discover System Language with locale,"Identify System language with the `locale` command.

Upon successful execution, the output will contain the environment variables that indicate
the 5 character locale that can be looked up to correlate the language and territory.
",discovery,T1614.001,System Location Discovery: System Language Discovery
41498c1be5b92133cb9df50bd84211a4,atomic,Windows - Discover domain trusts with nltest,"Uses the nltest command to discover domain trusts.
Requires the installation of nltest via Windows RSAT or the Windows Server AD DS role.
This technique has been used by the Trickbot malware family.
",discovery,T1482,Domain Trust Discovery
13a0c78dbd8d3645db69540bfe7cd038,atomic,Remote System Discovery - nslookup,"Powershell script that runs nslookup on cmd.exe against the local /24 network of the first network adaptor listed in ipconfig.

Upon successful execution, powershell will identify the ip range (via ipconfig) and perform a for loop and execute nslookup against that IP range. Output will be via stdout.
",discovery,T1018,Remote System Discovery
f92a238fc446f89dc01f73b6c30264c3,atomic,Discover System Language with chcp,"Identify System language with the chcp command.

Upon successful execution, result in number format can be looked up to correlate the language.
",discovery,T1614.001,System Location Discovery: System Language Discovery
a1f48fa3ddee658b29b414523c9a295b,atomic,Basic Permission Groups Discovery Windows (Local),"Basic Permission Groups Discovery for Windows. This test will display some errors if run on a computer not connected to a domain. Upon execution, domain
information will be displayed.
",discovery,T1069.001,Permission Groups Discovery: Local Groups
e58589c66265f18565769c5254f5b5aa,atomic,Security Software Discovery - ps (macOS),"Methods to identify Security Software on an endpoint
when sucessfully executed, command shell  is going to display AV/Security software it is running.
",discovery,T1518.001,Software Discovery: Security Software Discovery
68a0a328719faa26fff5b92e18108b3f,atomic,Enumerate users and groups,"Utilize local utilities to enumerate users and groups
",discovery,T1087.001,Account Discovery: Local Account
33a24ff44719e6ac0614b58f8c9a7c72,atomic,Security Software Discovery - Sysmon Service,"Discovery of an installed Sysinternals Sysmon service using driver altitude (even if the name is changed).

when sucessfully executed, the test is going to display sysmon driver instance if it is installed.
",discovery,T1518.001,Software Discovery: Security Software Discovery
0667a2ac10e4acb40163d61b0d923ad6,atomic,AWS S3 Enumeration,"This test will enumerate all the S3 buckets in the user account and lists all the files in each bucket. 
",discovery,T1619,Cloud Storage Object Discovery
097bbd452cdc6506e728287c7084333f,atomic,Adfind - Enumerate Active Directory Trusts,"Adfind tool can be used for reconnaissance in an Active directory environment. This example has been documented by ransomware actors enumerating Active Directory Trusts
reference- http://www.joeware.net/freetools/tools/adfind/, https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html
",discovery,T1482,Domain Trust Discovery
d7456d8122cfc76421fc4806934fc448,atomic,Linux List Kernel Modules,"Enumerate kernel modules installed 3 different ways. Upon successful execution stdout will display kernel modules installed on host 2 times, followed by list of modules matching 'vmw' if present.
",discovery,T1082,System Information Discovery
d7f1270ba66d5947a1422f7d5b1a36ef,atomic,WinPwn - shareenumeration,Network share enumeration using the shareenumeration function of WinPwn,discovery,T1135,Network Share Discovery
c84a57391dbc724dc51436deb3e0ca00,atomic,Get-DomainUser with PowerView,"Utilizing PowerView, run Get-DomainUser to identify the domain users. Upon execution, Users within the domain will be listed.
",discovery,T1087.002,Account Discovery: Domain Account
c75a55384a1e7026bb91f841e4ca2ba9,atomic,Enumerate Active Directory Computers with ADSISearcher,"The following Atomic test will utilize ADSISearcher to enumerate computers within Active Directory.
Upon successful execution a listing of computers will output with their paths in AD.
Reference: https://devblogs.microsoft.com/scripting/use-the-powershell-adsisearcher-type-accelerator-to-search-active-directory/
",discovery,T1018,Remote System Discovery
feec1b093708c05e2f946a4e32253342,atomic,Nix File and Directory Discovery 2,"Find or discover files on the file system
",discovery,T1083,File and Directory Discovery
221d4ebcb41e708b6ee90c1c0369a969,atomic,GetCurrent User with PowerShell Script,"Use the PowerShell ""GetCurrent"" method of the WindowsIdentity .NET class to identify the logged user.",discovery,T1033,System Owner/User Discovery
1c4b648dcee865a0233a5f15b0c5da8b,atomic,Network Share Discovery,"Network Share Discovery
",discovery,T1135,Network Share Discovery
76147189e1a5880afa047d0869cf6d17,atomic,Security Software Discovery - AV Discovery via WMI,"Discovery of installed antivirus products via a WMI query.

when sucessfully executed, the test is going to display installed AV software.
",discovery,T1518.001,Software Discovery: Security Software Discovery
1033c974479429c54dff4470e614113d,atomic,Simulating MAZE Directory Enumeration,"This test emulates MAZE ransomware's ability to enumerate directories using Powershell. 
Upon successful execution, this test will output the directory enumeration results to a specified file, as well as display them in the active window. 
See https://www.mandiant.com/resources/tactics-techniques-procedures-associated-with-maze-ransomware-incidents
",discovery,T1083,File and Directory Discovery
6920475188a41452389e254b61f745b4,atomic,Permission Groups Discovery for Containers- Local Groups,"Attackers may try to obtain a list of services that are operating on remote hosts and local network infrastructure devices, in order to identify potential vulnerabilities that can be exploited through remote software attacks. They typically use tools to conduct port and vulnerability scans in order to obtain this information.",discovery,T1069.001,Permission Groups Discovery: Local Groups
ed77c603f0d7c1fe3b19a9d4d9701158,atomic,Security Software Discovery - powershell,"Methods to identify Security Software on an endpoint

when sucessfully executed, powershell is going to processes related AV products if they are running.
Note that, depending on the privilege of current user, get-process | ?{$_.Description -like ""*""} may not return the processes related to AV products of the check.
For instance, only with Administrator right, you can see the process description of McAffee processes. Hence, it is better to use get-process | ?{$_.ProcessName -like ""*""},
if you know the name of those processes.
",discovery,T1518.001,Software Discovery: Security Software Discovery
e658d2552728a97b1a3c70838176c94d,atomic,Launch DirLister Executable,"Launches the DirLister executable for a short period of time and then exits.

Recently seen used by [BlackCat ransomware](https://news.sophos.com/en-us/2022/07/14/blackcat-ransomware-attacks-not-merely-a-byproduct-of-bad-luck/) to create a list of accessible directories and files.",discovery,T1083,File and Directory Discovery
f7a0f7d704aa52a764d9d1bee81e65d6,atomic,List Mozilla Firefox bookmarks on Windows with command prompt,"Searches for Mozilla Firefox bookmarks file (on Windows distributions) that contains bookmarks in a SQLITE database.
Upon execution, paths that contain bookmark files will be displayed.
",discovery,T1217,Browser Bookmark Discovery
e643e21318c069d0a576da91650c76fe,atomic,Enable Windows Remote Management,"Powershell Enable WinRM

Upon successful execution, powershell will ""Enable-PSRemoting"" allowing for remote PS access.
",lateral-movement,T1021.006,Remote Services: Windows Remote Management
ca1f1ab85939ac18903d5abc4367fec1,atomic,Copy and Execute File with PsExec,"Copies a file to a remote host and executes it using PsExec. Requires the download of PsExec from [https://docs.microsoft.com/en-us/sysinternals/downloads/psexec](https://docs.microsoft.com/en-us/sysinternals/downloads/psexec).
",lateral-movement,T1021.002,Remote Services: SMB/Windows Admin Shares
55e5a14e5601b7ea81e8bb272b7e03be,atomic,WinRM Access with Evil-WinRM,An adversary may attempt to use Evil-WinRM with a valid account to interact with remote systems that have WinRM enabled,lateral-movement,T1021.006,Remote Services: Windows Remote Management
28ed45c4da059b14a1b2d4f061b912b8,atomic,RDP to DomainController,"Attempt an RDP session via Remote Desktop Application to a DomainController.
",lateral-movement,T1021.001,Remote Services: Remote Desktop Protocol
a719076e595f5a106be38682a444ad2c,atomic,Map admin share,"Connecting To Remote Shares
",lateral-movement,T1021.002,Remote Services: SMB/Windows Admin Shares
831c7f8dda2eda2720f46aeba37cbe48,atomic,RDP hijacking,"[RDP hijacking](https://medium.com/@networksecurity/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6) - how to hijack RDS and RemoteApp sessions transparently to move through an organization
",lateral-movement,T1563.002,Remote Service Session Hijacking: RDP Hijacking
a2a4d8a2f11ed41fe32ab1001ed78ffd,atomic,Changing RDP Port to Non Standard Port via Powershell,"Changing RDP Port to Non Standard Port via Powershell
",lateral-movement,T1021.001,Remote Services: Remote Desktop Protocol
68df771632fd6216858edd20458ee5bb,atomic,PowerShell Lateral Movement using MMC20,"Powershell lateral movement using the mmc20 application com object.

Reference:

https://blog.cobaltstrike.com/2017/01/24/scripting-matt-nelsons-mmc20-application-lateral-movement-technique/

Upon successful execution, cmd will spawn calc.exe on a remote computer.
",lateral-movement,T1021.003,Remote Services: Distributed Component Object Model
7844eb9751d121b16f9517817a31eee4,atomic,Remote Code Execution with PS Credentials Using Invoke-Command,"Simulate lateral movement with PowerShell Remoting on the local host. 
Upon successful execution, PowerShell will execute `whoami` using `Invoke-Command`, targeting the 
local machine as remote target.
",lateral-movement,T1021.006,Remote Services: Windows Remote Management
31a7326fcc56c71d97da23e3fe1ec364,atomic,Map Admin Share PowerShell,"Map Admin share utilizing PowerShell
",lateral-movement,T1021.002,Remote Services: SMB/Windows Admin Shares
41e7255e8dc65f43482a623000773dd3,atomic,Changing RDP Port to Non Standard Port via Command_Prompt,"Changing RDP Port to Non Standard Port via Command_Prompt
",lateral-movement,T1021.001,Remote Services: Remote Desktop Protocol
5c2ddc375b4963647ac9c913641ab6d6,atomic,Execute command writing output to local Admin Share,"Executes a command, writing the output to a local Admin Share.
This technique is used by post-exploitation frameworks.
",lateral-movement,T1021.002,Remote Services: SMB/Windows Admin Shares
36f50411a52fddf639b03b14918d988f,atomic,Exfiltrate data HTTPS using curl windows,"Exfiltrate data HTTPS using curl to file share site file.io
",exfiltration,T1048.002,Exfiltration Over Alternative Protocol - Exfiltration Over Asymmetric Encrypted Non-C2 Protocol
7db784562afbea0265fcafc4243b66de,atomic,Exfiltration Over Alternative Protocol - SSH,"Input a domain and test Exfiltration over SSH

Local to Remote

Upon successful execution, tar will compress /Users/* directory and password protect the file modification of `Users.tar.gz.enc` as output.
",exfiltration,,
548a620bf3463f72a42937faf7614935,atomic,Exfiltration Over Alternative Protocol - HTTP,"Exfiltration of specified file over HTTP.
Upon successful execution, powershell will invoke web request using POST method to exfiltrate notepad.exe to a remote address (default http://127.0.0.1). Results will be via stdout.
",exfiltration,T1048.003,Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol
e4316d90e4dbc776f4e2bae602109d83,atomic,Exfiltration Over Alternative Protocol - SMTP,"Exfiltration of specified file over SMTP.
Upon successful execution, powershell will send an email with attached file to exfiltrateto a remote address. Results will be via stdout.
",exfiltration,T1048.003,Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol
976ba17d4fcab66c2a917b81f54ab654,atomic,DNSExfiltration (doh),"DNSExfiltrator allows for transfering (exfiltrate) a file over a DNS request covert channel. This is basically a data leak testing tool allowing to exfiltrate data over a covert channel.
!!! Test will fail without a domain under your control with A record and NS record !!! 
See this github page for more details - https://github.com/Arno0x/DNSExfiltrator
",exfiltration,T1048,Exfiltration Over Alternative Protocol
305c23215a4bf6184ed701b5ca1d1af7,atomic,IcedID Botnet HTTP PUT,"Creates a text file
Tries to upload to a server via HTTP PUT method with ContentType Header
Deletes a created file",exfiltration,T1020,Automated Exfiltration
5ac7f6ec1898d8d408f9cdc687262cc7,atomic,Exfiltration Over Alternative Protocol - SSH,"Input a domain and test Exfiltration over SSH

Remote to Local

Upon successful execution, sh will spawn ssh contacting a remote domain (default: target.example.com) writing a tar.gz file.
",exfiltration,,
bbb0df644aaeee17fa4c4ca0d3a8a29e,atomic,Data Transfer Size Limits,"Take a file/directory, split it into 5Mb chunks
",exfiltration,,
72784d12700b219ec134aa42cec5603e,atomic,C2 Data Exfiltration,"Exfiltrates a file present on the victim machine to the C2 server.
",exfiltration,T1041,Exfiltration Over C2 Channel
447a2314183957f35cccd808182c0997,atomic,Exfiltrate data with rclone to cloud Storage - Mega (Windows),"This test uses rclone to exfiltrate data to a remote cloud storage instance. (Mega)
See https://thedfirreport.com/2022/06/16/sans-ransomware-summit-2022-can-you-detect-this/
",exfiltration,T1567.002,Exfiltration Over Web Service: Exfiltration to Cloud Storage
1ecd8f81d020145064af72dbcd47110a,atomic,Exfiltrate data HTTPS using curl linux,"Exfiltrate data HTTPS using curl to file share site file.io
",exfiltration,T1048.002,Exfiltration Over Alternative Protocol - Exfiltration Over Asymmetric Encrypted Non-C2 Protocol
6646e3ecc1d5a25bc1cd7e68fe43763b,atomic,MAZE FTP Upload,"This test simulates MAZE's ransomware's ability to exfiltrate data via FTP.
Upon successful execution, all 7z files within the %windir%\temp directory will be uploaded to a remote FTP server. 
Reference: https://www.mandiant.com/resources/tactics-techniques-procedures-associated-with-maze-ransomware-incidents
",exfiltration,T1048.003,Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol
f531571265dc24625b8799007cbeb1d5,atomic,Python3 http.server,"An adversary may use the python3 standard library module http.server to exfiltrate data. This test checks if python3 is available and if so, creates a HTTP server on port 9090, captures the PID, sleeps for 10 seconds, then kills the PID and unsets the $PID variable.
",exfiltration,T1048.003,Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol
3f73be176cadf2762623b3117e25335d,atomic,Exfiltration Over Alternative Protocol - FTP - Rclone,"Rclone may be used by an adversary to exfiltrate data to a publicly hosted FTP server.
[Reference](https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/)",exfiltration,T1048.003,Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol
6baab84fe7a52dd5c4ede612fc0d255f,atomic,Exfiltration Over Alternative Protocol - ICMP,"Exfiltration of specified file over ICMP protocol.

Upon successful execution, powershell will utilize ping (icmp) to exfiltrate notepad.exe to a remote address (default 127.0.0.1). Results will be via stdout.
",exfiltration,T1048.003,Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol
5c568978b49775033fc57f7740b84e43,atomic,Change login shell,"An adversary may want to use a different login shell. The chsh command changes the user login shell. The following test, creates an art user with a /bin/bash shell, changes the users shell to sh, then deletes the art user. 
",execution,T1059.004,Command and Scripting Interpreter: Bash
b939c81cba750f4b3ef67e6b0456b41e,atomic,Malicious Execution from Mounted ISO Image,Adversaries may rely on a user running a malicious image to facilitate execution,execution,T1204.003,User Execution: Malicious Image
03a80d4a4c02d99295b5901ee695cc79,atomic,Potentially Unwanted Applications (PUA),"The Potentially Unwanted Applications (PUA) protection feature in antivirus software can identify and block PUAs from downloading and installing on endpoints in your network. These applications are not considered viruses, malware, or other types of threats, but might perform actions on endpoints that adversely affect their performance or use. This file is similar to EICAR test virus file, but is considered a Potentially Unwanted Application (PUA) instead of a VIRUS (i.e. not actually malicious, but is flagged as it to verify anti-pua protection).
",execution,T1204.002,User Execution: Malicious File
b3ea15867906316fd87a4f320a9403d3,atomic,Execute Python via Python executables (Linux),"Create Python file (.py) then compile to binary (.pyc) that downloads an external malicious script then executes locally using the supplied executor and arguments
",execution,T1059.006,Command and Scripting Interpreter: Python
c0177717b47f2cd07949186523fa3c6b,atomic,ATHPowerShellCommandLineParameter -Command parameter variations,Executes powershell.exe with variations of the -Command parameter,execution,T1059.001,Command and Scripting Interpreter: PowerShell
724693bb7a55fdc94d84bd52d58c60b7,atomic,Powershell XML requests,"Powershell xml download request. Upon execution, ""Download Cradle test success!"" will be dispalyed.

Provided by https://github.com/mgreen27/mgreen27.github.io
",execution,T1059.001,Command and Scripting Interpreter: PowerShell
a0eddf3ba6bede6cf017eb99ee1cefd8,atomic,Execute a Command as a Service,"Creates a service specifying an arbitrary command and executes it. When executing commands such as PowerShell, the service will report that it did not start correctly even when code executes properly.

Upon successful execution, cmd.exe creates a new service using sc.exe that will start powershell.exe to create a new file `art-marker.txt`

[BlackCat Ransomware (ALPHV)](https://www.varonis.com/blog/blackcat-ransomware)  
[Cybereason vs. BlackCat Ransomware](https://www.cybereason.com/blog/cybereason-vs.-blackcat-ransomware)
",execution,T1569.002,System Services: Service Execution
4960dc6d42d2c82ac32c9c50b64de097,atomic,Command line scripts,"An adversary may type in elaborate multi-line shell commands into a terminal session because they can't or don't wish to create script files on the host. The following command is a simple loop, echoing out Atomic Red Team was here!
",execution,T1059.004,Command and Scripting Interpreter: Bash
71e15fde52e9acd90c3d5a4c1826279d,atomic,Cobalt Strike Artifact Kit pipe,"Uses the [Named Pipes Micro Emulation](https://github.com/center-for-threat-informed-defense/adversary_emulation_library/tree/master/micro_emulation_plans/src/named_pipes) executable from the Center for Threat Informed Defense to create a named pipe for inter-process communication.

The named pipe executable will pause for 30 seconds to allow the client and server to exchange a message through the pipe.
",execution,T1559,Inter-Process Communication
73d241349f2c6579d3196f01ad1cc462,atomic,Simulate BlackByte Ransomware Print Bombing,"This test attempts to open a file a specified number of times in Wordpad, then prints the contents. 
It is designed to mimic BlackByte ransomware's print bombing technique, where tree.dll, which contains the ransom note, is opened in Wordpad 75 times and then printed. 
See https://redcanary.com/blog/blackbyte-ransomware/. 
",execution,T1059.003,Command and Scripting Interpreter: Windows Command Shell
a935a79ba61ecb00458208b0bd5ef15e,atomic,ATHPowerShellCommandLineParameter -EncodedCommand parameter variations with encoded arguments,Executes powershell.exe with variations of the -EncodedCommand parameter with encoded arguments supplied,execution,T1059.001,Command and Scripting Interpreter: PowerShell
e401dd1a8de06f4a52b66736c2050bb7,atomic,Execute PowerShell script via Word DDE,"When the word document opens it will prompt the user to click ok on a dialogue box, then attempt to run PowerShell with DDEAUTO to download and execute a powershell script
",execution,T1559.002,Inter-Process Communication: Dynamic Data Exchange
50d199543d7813b877e299ac48c908ba,atomic,Use PsExec to execute a command on a remote host,"Requires having Sysinternals installed, path to sysinternals is one of the input input_arguments
Will start a process on a remote host.

Upon successful execution, cmd will utilize psexec.exe to spawn calc.exe on a remote endpoint (default:localhost).
",execution,T1569.002,System Services: Service Execution
52bcd9532d677ff09b834956a0b3ea75,atomic,WMI Execute rundll32,"This test uses wmic.exe to execute a DLL function using rundll32. Specify a valid value for remote IP using the node parameter.
",execution,T1047,Windows Management Instrumentation
85758c8aa8c05f1b82e74e02ca26a97a,atomic,Execute Python via scripts (Linux),Create Python file (.py) that downloads and executes shell script via executor arguments,execution,T1059.006,Command and Scripting Interpreter: Python
0ecc3d4729cf37c719528291d63f9f99,atomic,Run Bloodhound from Memory using Download Cradle,"Upon execution SharpHound will load into memory and execute against a domain. It will set up collection methods, run and then compress and store the data to the temp directory. If system is unable to contact a domain, proper execution will not occur.

Successful execution will produce stdout message stating ""SharpHound Enumeration Completed"". Upon completion, final output will be a *BloodHound.zip file.
",execution,T1059.001,Command and Scripting Interpreter: PowerShell
7c6a6ffb23e7949d5ce5b0b9dfcbd73f,atomic,Cobalt Strike Lateral Movement (psexec_psh) pipe,"Uses the [Named Pipes Micro Emulation](https://github.com/center-for-threat-informed-defense/adversary_emulation_library/tree/master/micro_emulation_plans/src/named_pipes) executable from the Center for Threat Informed Defense to create a named pipe for inter-process communication.

The named pipe executable will pause for 30 seconds to allow the client and server to exchange a message through the pipe.
",execution,T1559,Inter-Process Communication
bba7fe7940f8719efa3c38e54ec79e2c,atomic,PowerShell Session Creation and Use,"Connect to a remote powershell session and interact with the host.
Upon execution, network test info and 'T1086 PowerShell Session Creation and Use' will be displayed.
",execution,T1059.001,Command and Scripting Interpreter: PowerShell
d4aa13cd6322080455d334e6fc2d5972,atomic,Create and Execute Batch Script,"Creates and executes a simple batch script. Upon execution, CMD will briefly launch to run the batch script then close again.
",execution,T1059.003,Command and Scripting Interpreter: Windows Command Shell
28004c307d9958351c450cb0384efaf9,atomic,Create a Process using WMI Query and an Encoded Command,"Solarigate persistence is achieved via backdoors deployed via various techniques including using PowerShell with an EncodedCommand
 Powershell -nop -exec bypass -EncodedCommand <encoded command>
Where the –EncodedCommand, once decoded, would resemble:
  Invoke-WMIMethod win32_process -name create -argumentlist ‘rundll32 c:\windows\idmu\common\ypprop.dll _XInitImageFuncPtrs’ -ComputerName WORKSTATION
The EncodedCommand in this atomic is the following: Invoke-WmiMethod -Path win32_process -Name create -ArgumentList notepad.exe
You should expect to see notepad.exe running after execution of this test.
[Solarigate Analysis from Microsoft](https://www.microsoft.com/security/blog/2020/12/18/analyzing-solorigate-the-compromised-dll-file-that-started-a-sophisticated-cyberattack-and-how-microsoft-defender-helps-protect/)
",execution,T1047,Windows Management Instrumentation
e71f5cb2d3a9b87877a7162c76c9a8da,atomic,Command Prompt read contents from CMD file and execute,"Simulate Raspberry Robin using the ""standard-in"" command prompt feature cmd `/R <` to read and execute a file via cmd.exe
See https://redcanary.com/blog/raspberry-robin/. 
",execution,T1059.003,Command and Scripting Interpreter: Windows Command Shell
fca2ce47cdb3acfde35139ca9017af80,atomic,ATHPowerShellCommandLineParameter -EncodedCommand parameter variations,Executes powershell.exe with variations of the -EncodedCommand parameter,execution,T1059.001,Command and Scripting Interpreter: PowerShell
d56753da33c882128773634140c0efa5,atomic,Invoke-AppPathBypass,"Note: Windows 10 only. Upon execution windows backup and restore window will be opened.

Bypass is based on: https://enigma0x3.net/2017/03/14/bypassing-uac-using-app-paths/
",execution,T1059.001,Command and Scripting Interpreter: PowerShell
e2e6f33cf77d10e3c82c244014da20c5,atomic,Abuse Nslookup with DNS Records,"Red teamer's avoid IEX and Invoke-WebRequest in your PowerShell commands. Instead, host a text record with a payload to compromise hosts.
[reference](https://twitter.com/jstrosch/status/1237382986557001729)
",execution,T1059.001,Command and Scripting Interpreter: PowerShell
88210b707791d09a7db8026d521f71b1,atomic,JScript execution to gather local computer information via wscript,"JScript execution test, execute JScript via wscript command. When successful, system information will be shown with four message boxes.",execution,T1059.007,Command and Scripting Interpreter: JavaScript
181d6efe03889f7c26073257a90c4a1e,atomic,What shell is running,"An adversary will want to discover what shell is running so that they can tailor their attacks accordingly. The following commands will discover what shell is running.
",execution,T1059.004,Command and Scripting Interpreter: Bash
98adc43648b0e4ea6e90a88ad5ae4b3d,atomic,Headless Chrome code execution via VBA,"This module uses Google Chrome combined with ScriptControl to achieve code execution. It spawns a local
webserver hosting our malicious payload. Headless Google Chrome will then reach out to this webserver
and pull down the script and execute it. By default the payload will execute calc.exe on the system.
",execution,T1204.002,User Execution: Malicious File
705c4b9714ce06223e7d7038cd332808,atomic,Office launching .bat file from AppData,Microsoft Office creating then launching a .bat script from an AppData directory. The .bat file launches calc.exe when opened.,execution,T1204.002,User Execution: Malicious File
c104b41e565e972fb3bf129bdb9a8a89,atomic,Detecting pipe-to-shell,"An adversary may develop a useful utility or subvert the CI/CD pipe line of a legitimate utility developer, who requires or suggests installing their utility by piping a curl download directly into bash. Of-course this is a very bad idea. The adversary may also take advantage of this BLIND install method and selectively running extra commands in the install script for those who DO pipe to bash and not for those who DO NOT. This test uses curl to download the pipe-to-shell.sh script, the first time without piping it to bash and the second piping it into bash which executes the echo command.
",execution,T1059.004,Command and Scripting Interpreter: Bash
ba763ea19604a73e3e1f9d9d8d86d9cc,atomic,PowerUp Invoke-AllChecks,"Check for privilege escalation paths using PowerUp from PowerShellMafia
",execution,T1059.001,Command and Scripting Interpreter: PowerShell
2b7b8128c448ccaedfa1618498884296,atomic,Docker Exec Into Container,"Attackers who have permissions, can run malicious commands in containers in the cluster using exec command (“docker exec”). In this method, attackers can use legitimate images, such as an OS image (e.g., Ubuntu) as a backdoor container, and run their malicious code remotely by using “docker exec”. Kinsing (Golang-based malware) was executed with an Ubuntu container entry point that runs shell scripts.
",execution,T1609,Kubernetes Exec Into Container
c3f3b1ce2eb966f2c2d64e39fb6afba1,atomic,Suspicious Execution via Windows Command Shell,"Command line executed via suspicious invocation. Example is from the 2021 Threat Detection Report by Red Canary.
",execution,T1059.003,Command and Scripting Interpreter: Windows Command Shell
7d45fed6428da84d356357a1ad79bfe4,atomic,Mirror Blast Emulation,"Emulates the JS -> MSI chain of the MirrorBlast T505 campaign by executing an xlsm file designed. 
Requires the 32 bit version of Office to run. [MirrorBlast Campaign Analysis](https://blog.morphisec.com/explosive-new-mirrorblast-campaign-targets-financial-companies)
",execution,T1204.002,User Execution: Malicious File
623806a6fd4d832b6692eb275535f636,atomic,Excel 4 Macro,"This module creates an Excel 4 Macro (XLM) enabled spreadsheet and executes it. The XLM will first write a ""malicious""
VBS file to %TEMP%, then execute this file. The VBS will download Process Explorer to the same directory (%TEMP%) and exec.

A note regarding this module. By default, this module will pull the current username from the system and places it into the macro. If
you'd like to utilize the ""=GET.WORKSPACE(26)"" method, that many maldoc authors use, you will need to ensure that the User Name associated
with Excel matches that of the local system. This username can be found under Files -> Options -> Username
",execution,T1204.002,User Execution: Malicious File
8dffc63a433a6abb131ae70845e66126,atomic,Visual Basic script execution to gather local computer information,"Visual Basic execution test, execute vbscript via PowerShell.

When successful, system information will be written to $env:TEMP\T1059.005.out.txt.",execution,T1059.005,Command and Scripting Interpreter: Visual Basic
58193baa89a80d5bcd0276e89b3f76c6,atomic,Launchctl,"Utilize launchctl
",execution,T1569.001,System Services: Launchctl
ca3c058554276f34ac84b996af0caf0d,atomic,Office Generic Payload Download,"This Test uses a VBA macro to launch Powershell which will download a file from a user defined web server.
Required input agruments are c2_domain and file_name
Execution is handled by [Invoke-MalDoc](https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1204.002/src/Invoke-MalDoc.ps1) to load and execute VBA code into Excel or Word documents.
Example for c2 server located at 127.0.0.1 for the file test.txt which is nested below the parent directory in the tests/my-test folder
Example input args for file in root directory c2-domain = 127.0.0.1, file-name = test.txt
",execution,T1204.002,User Execution: Malicious File
f6d9c3fbee5549837ea37ff933291656,atomic,WinPwn - Get SYSTEM shell - Pop System Shell using NamedPipe Impersonation technique,Get SYSTEM shell - Pop System Shell using NamedPipe Impersonation technique via function of WinPwn,execution,T1106,Native API
c157df565590c06f433bc25a3ac5a8e9,atomic,LinEnum tool execution,"LinEnum is a bash script that performs discovery commands for accounts,processes, kernel version, applications, services, and uses the information from these commands to present operator with ways of escalating privileges or further exploitation of targeted host.
",execution,T1059.004,Command and Scripting Interpreter: Bash
753ad1ad41cf59a2d3a7e2972c0d16c4,atomic,Use RemCom to execute a command on a remote host,"Requires having RemCom installed, path to RemCom is one of the input input_arguments
Will start a process on a remote host.
Upon successful execution, cmd will utilize RemCom.exe to spawn calc.exe on a remote endpoint (default:localhost).
",execution,T1569.002,System Services: Service Execution
b262964145fa55e27265e7caa89b1169,atomic,WinPwn - Get SYSTEM shell - Pop System Shell using CreateProcess technique,Get SYSTEM shell - Pop System Shell using CreateProcess technique via function of WinPwn,execution,T1106,Native API
a9df2530a06e1aa7d1ba9e9309364b9f,atomic,PowerShell Invoke Known Malicious Cmdlets,Powershell execution of known Malicious PowerShell Cmdlets,execution,T1059.001,Command and Scripting Interpreter: PowerShell
a3a4320ad140e1046b224082cccd3be9,atomic,Cobalt Strike post-exploitation pipe (4.2 and later),"Uses the [Named Pipes Micro Emulation](https://github.com/center-for-threat-informed-defense/adversary_emulation_library/tree/master/micro_emulation_plans/src/named_pipes) executable from the Center for Threat Informed Defense to create a named pipe for inter-process communication.

The named pipe executable will pause for 30 seconds to allow the client and server to exchange a message through the pipe.
",execution,T1559,Inter-Process Communication
431121fe12b6fd82938a9a52526b3423,atomic,OSTap Style Macro Execution,"This Test uses a VBA macro to create and execute #{jse_path} with cscript.exe. Upon execution, the .jse file launches wscript.exe.
Execution is handled by [Invoke-MalDoc](https://github.com/redcanaryco/invoke-atomicredteam/blob/master/Public/Invoke-MalDoc.ps1) to load and execute VBA code into Excel or Word documents.
This is a known execution chain observed by the OSTap downloader commonly used in TrickBot campaigns.
References:
  https://www.computerweekly.com/news/252470091/TrickBot-Trojan-switches-to-stealthy-Ostap-downloader
",execution,T1204.002,User Execution: Malicious File
e9d6ab093c65f521e9d900b9dc9eca28,atomic,WMI Reconnaissance List Remote Services,"An adversary might use WMI to check if a certain Remote Service is running on a remote device. 
When the test completes, a service information will be displayed on the screen if it exists.
A common feedback message is that ""No instance(s) Available"" if the service queried is not running.
A common error message is ""Node - (provided IP or default)  ERROR Description =The RPC server is unavailable"" 
if the provided remote host is unreacheable
",execution,T1047,Windows Management Instrumentation
ab1b50880382b06d48d3d23ad1786239,atomic,Maldoc choice flags command execution,"This Test uses a VBA macro to execute cmd with flags observed in recent maldoc and 2nd stage downloaders. Upon execution, CMD will be launched.
Execution is handled by [Invoke-MalDoc](https://github.com/redcanaryco/invoke-atomicredteam/blob/master/Public/Invoke-MalDoc.ps1) to load and execute VBA code into Excel or Word documents.
",execution,T1204.002,User Execution: Malicious File
b6885315a5836b702271546774e7109a,atomic,Obfuscated command line scripts,"An adversary may pre-compute the base64 representations of the terminal commands that they wish to execute in an attempt to avoid or frustrate detection. The following commands base64 encodes the text string id, then base64 decodes the string, then pipes it as a command to bash, which results in the id command being executed.
",execution,T1059.004,Command and Scripting Interpreter: Bash
6d40caedb0738bd37dd673f0321ab584,atomic,psexec.py (Impacket),"Will execute a command on the remote host with Impacket psexec.py script.
",execution,T1569.002,System Services: Service Execution
f7b58d2d5452b2ee0ce406655eb48697,atomic,Snake Malware Service Create,"The following Atomic Test will create a new service named WerFaultSvc with a binary path of WinSxS\x86_microsoft-windows-errorreportingfaults_31bf3856ad364e35_4.0.9600.16384_none_a13f7e283339a050\WerFault.exe.
This was recently seen in the Snake Malware report. 
Upon execution, sc.exe will create a new service named WerFaultSvc with a bin path \WinSxS\x86_microsoft-windows-errorreportingfaults_31bf3856ad364e35_4.0.9600.16384_none_a13f7e283339a050\WerFault.exe and a display name of WerFault Service.
[Snake Malware - CISA](https://media.defense.gov/2023/May/09/2003218554/-1/-1/0/JOINT_CSA_HUNTING_RU_INTEL_SNAKE_MALWARE_20230509.PDF)  
",execution,T1569.002,System Services: Service Execution
c5951c819c5f6125e0e5987a12a344f9,atomic,NTFS Alternate Data Stream Access,"Creates a file with an alternate data stream and simulates executing that hidden code/file. Upon execution, ""Stream Data Executed"" will be displayed.
",execution,T1059.001,Command and Scripting Interpreter: PowerShell
48a861eb5802bd7abdaa64b4fcd30924,atomic,PowerShell Downgrade Attack,"This test requires the manual installation of PowerShell V2.

Attempts to run powershell commands in version 2.0 https://www.leeholmes.com/blog/2017/03/17/detecting-and-preventing-powershell-downgrade-attacks/
",execution,T1059.001,Command and Scripting Interpreter: PowerShell
b0255b5120cbabc062d8d4510a142c3b,atomic,WMI Reconnaissance Users,"An adversary might use WMI to list all local User Accounts. 
When the test completes , there should be local user accounts information displayed on the command line.
",execution,T1047,Windows Management Instrumentation
8afcc1dcfffe03846de54686dff957ab,atomic,Cobalt Strike SSH (postex_ssh) pipe,"Uses the [Named Pipes Micro Emulation](https://github.com/center-for-threat-informed-defense/adversary_emulation_library/tree/master/micro_emulation_plans/src/named_pipes) executable from the Center for Threat Informed Defense to create a named pipe for inter-process communication.

The named pipe executable will pause for 30 seconds to allow the client and server to exchange a message through the pipe.
",execution,T1559,Inter-Process Communication
1aa4061e002213b7c1e0985f68d4e18c,atomic,Harvest SUID executable files,"AutoSUID application is the Open-Source project, the main idea of which is to automate harvesting the SUID executable files and to find a way for further escalating the privileges. 
",execution,T1059.004,Command and Scripting Interpreter: Bash
80cda763aa992b775038ce134c892070,atomic,Create a Process using obfuscated Win32_Process,"This test tries to mask process creation by creating a new class that inherits from Win32_Process. Indirect call of suspicious method such as Win32_Process::Create can break detection logic.
[Cybereason blog post No Win32_ProcessNeeded](https://www.cybereason.com/blog/wmi-lateral-movement-win32)
",execution,T1047,Windows Management Instrumentation
dbe8b7090136539f0b6dea3c802024f5,atomic,Environment variable scripts,"An adversary may place scripts in an environment variable because they can't or don't wish to create script files on the host. The following test, in a bash shell, exports the ART variable containing an echo command, then pipes the variable to /bin/bash
",execution,T1059.004,Command and Scripting Interpreter: Bash
e0d7856bf28741789ecf1e0654d96995,atomic,Writes text to a file and displays it.,"Writes text to a file and display the results. This test is intended to emulate the dropping of a malicious file to disk.
",execution,T1059.003,Command and Scripting Interpreter: Windows Command Shell
ef943918da20ee40d378ad000bbcc3b7,atomic,Obfuscation Tests,"Different obfuscated methods to test. Upon execution, reaches out to bit.ly/L3g1t and displays: ""SUCCESSFULLY EXECUTED POWERSHELL CODE FROM REMOTE LOCATION""
",execution,T1059.001,Command and Scripting Interpreter: PowerShell
ac2764f7a67a9ce92b54e8e59b361838,atomic,WMI Reconnaissance Processes,"An adversary might use WMI to list Processes running on the compromised host.
When the test completes , there should be running processes listed on the command line.
",execution,T1047,Windows Management Instrumentation
1b2111f68be9d4b4d69413ee1b581c32,atomic,Python pty module and spawn function used to spawn sh or bash,"Uses the Python spawn function to spawn a sh shell followed by a bash shell. Per Volexity, this technique was observed in exploitation of Atlassian Confluence [CVE-2022-26134]. Reference: https://www.volexity.com/blog/2022/06/02/zero-day-exploitation-of-atlassian-confluence
",execution,T1059.006,Command and Scripting Interpreter: Python
2f5e819a0fdae54834fa85a0b797d302,atomic,PowerShell Command Execution,"Use of obfuscated PowerShell to execute an arbitrary command; outputs ""Hello, from PowerShell!"". Example is from the 2021 Threat Detection Report by Red Canary.
",execution,T1059.001,Command and Scripting Interpreter: PowerShell
106045f14741390cfb3fe95300585fb6,atomic,ATHPowerShellCommandLineParameter -Command parameter variations with encoded arguments,Executes powershell.exe with variations of the -Command parameter with encoded arguments supplied,execution,T1059.001,Command and Scripting Interpreter: PowerShell
c3aaa4585223289f5f29e977253dd045,atomic,BlackCat pre-encryption cmds with Lateral Movement,This atomic attempts to emulate the unique behavior of BlackCat ransomware prior to encryption and during Lateral Movement attempts via PsExec on Windows. Uses bundled PsExec like BlackCat,execution,T1569.002,System Services: Service Execution
9c955a373154a7090d4b4396b561f5da,atomic,Encoded VBS code execution,"This module takes an encoded VBS script and executes it from within a malicious document. By default, upon successful execution
a message box will pop up displaying ""ART T1059.005""

A note regarding this module, due to the way that this module utilizes ""ScriptControl"" a 64bit version of Microsoft Office is required.
You can validate this by opening WinWord -> File -> Account -> About Word
",execution,T1059.005,Command and Scripting Interpreter: Visual Basic
8a84968196ec3b64b747b15008cafc2f,atomic,Create and Execute Bash Shell Script,"Creates and executes a simple bash script.
",execution,T1059.004,Command and Scripting Interpreter: Bash
42302f7d89c15f8070f83e743771d567,atomic,Extract Memory via VBA,"This module attempts to emulate malware authors utilizing well known techniques to extract data from memory/binary files. To do this
we first create a string in memory then pull out the pointer to that string. Finally, it uses this pointer to copy the contents of that
memory location to a file stored in the $env:TEMP\atomic_t1059_005_test_output.bin.
",execution,T1059.005,Command and Scripting Interpreter: Visual Basic
ba3f3acd2d5a1429dfc2e4612b1a8953,atomic,What shells are available,"An adversary may want to discover which shell's are available so that they might switch to that shell to tailor their attacks to suit that shell. The following commands will discover what shells are available on the host.
",execution,T1059.004,Command and Scripting Interpreter: Bash
43f1775664b60cdf31c1b9ea0d7dd8a7,atomic,Execution through API - CreateProcess,"Execute program by leveraging Win32 API's. By default, this will launch calc.exe from the command prompt.",execution,T1106,Native API
11674ad10631f621dd4bdcd611c706ad,atomic,New script file in the tmp directory,"An attacker may create script files in the /tmp directory using the mktemp utility and execute them. The following commands creates a temp file and places a pointer to it in the variable $TMPFILE, echos the string id into it, and then executes the file using bash, which results in the id command being executed.
",execution,T1059.004,Command and Scripting Interpreter: Bash
2ca71106ee0aff2eda551bb6ed2b39e4,atomic,WinPwn - Get SYSTEM shell - Bind System Shell using CreateProcess technique,Get SYSTEM shell - Bind System Shell using CreateProcess technique via function of WinPwn,execution,T1106,Native API
ed736a123da6fb2aab22cfd4f437e8b5,atomic,WMI Reconnaissance Software,"An adversary might use WMI to list installed Software hotfix and patches.
When the test completes, there should be a list of installed patches and when they were installed.
",execution,T1047,Windows Management Instrumentation
fe19a5f38374d4f46032ee18ac1aa474,atomic,Powershell MsXml COM object - with prompt,"Powershell MsXml COM object. Not proxy aware, removing cache although does not appear to write to those locations. Upon execution, ""Download Cradle test success!"" will be displayed.

Provided by https://github.com/mgreen27/mgreen27.github.io
",execution,T1059.001,Command and Scripting Interpreter: PowerShell
0ed5491929cf9b5d9cf848dfeea869eb,atomic,AppleScript,"Shell Script with AppleScript. The encoded python script will perform an HTTP GET request to 127.0.0.1:80 with a session cookie of ""t3VhVOs/DyCcDTFzIKanRxkvk3I="", unless 'Little Snitch' is installed, in which case it will just exit. 
You can use netcat to listen for the connection and verify execution, e.g. use ""nc -l 80"" in another terminal window before executing this test and watch for the request.

Reference: https://github.com/EmpireProject/Empire
",execution,T1059.002,Command and Scripting Interpreter: AppleScript
6aaf86c797e33b0ee3d16592be76f46e,atomic,Mimikatz,"Download Mimikatz and dump credentials. Upon execution, mimikatz dump details and password hashes will be displayed.
",execution,T1059.001,Command and Scripting Interpreter: PowerShell
cde814c61dcd8b0fbeeb14f005c2432f,atomic,OSTAP JS version,"Malicious JavaScript executing CMD which spawns wscript.exe //e:jscript
Execution is handled by [Invoke-MalDoc](https://github.com/redcanaryco/invoke-atomicredteam/blob/master/Public/Invoke-MalDoc.ps1) to load and execute VBA code into Excel or Word documents.
",execution,T1204.002,User Execution: Malicious File
5e85bef7dcda5706a9948bea69e09ade,atomic,Execute shell script via python's command mode arguement,Download and execute shell script and write to file then execute locally using Python -c (command mode),execution,T1059.006,Command and Scripting Interpreter: Python
301c5fa0f27e0c63c2a3a0d14e043b83,atomic,Run BloodHound from local disk,"Upon execution SharpHound will be downloaded to disk, imported and executed. It will set up collection methods, run and then compress and store the data to the temp directory on the machine. If system is unable to contact a domain, proper execution will not occur.

Successful execution will produce stdout message stating ""SharpHound Enumeration Completed"". Upon completion, final output will be a *BloodHound.zip file.
",execution,T1059.001,Command and Scripting Interpreter: PowerShell
5caa8f9190e3ec3a6f948d70ce67a738,atomic,Application uninstall using WMIC,Emulates uninstalling  applications using WMIC.  This method only works if the product was installed with an msi file.  APTs have been seen using this to uninstall security products.,execution,T1047,Windows Management Instrumentation
94bd4682c1c109fcc1d4011c3a616405,atomic,PowerShell Fileless Script Execution,"Execution of a PowerShell payload from the Windows Registry similar to that seen in fileless malware infections. Upon exection, open ""C:\Windows\Temp"" and verify that
art-marker.txt is in the folder.
",execution,T1059.001,Command and Scripting Interpreter: PowerShell
fd43e89c476ae8a53cdc25143977e070,atomic,WMI Execute Remote Process,"This test uses wmic.exe to execute a process on a remote host. Specify a valid value for remote IP using the node parameter.
To clean up, provide the same node input as the one provided to run the test
A common error message is ""Node - (provided IP or default)  ERROR Description =The RPC server is unavailable"" if the default or provided IP is unreachable
",execution,T1047,Windows Management Instrumentation
f71199dcf1e307fc37c5a0cb9e4031b9,atomic,LNK Payload Download,This lnk files invokes powershell to download putty from the internet and opens the file. https://twitter.com/ankit_anubhav/status/1518932941090410496,execution,T1204.002,User Execution: Malicious File
d01777fabe1567d53f720d0d4e348c33,atomic,JScript execution to gather local computer information via cscript,"JScript execution test, execute JScript via cscript command. When successful, system information will be written to $env:TEMP\T1059.007.out.txt",execution,T1059.007,Command and Scripting Interpreter: JavaScript
b7dbd4b15fb43757def1ccebfc02b350,atomic,Powershell invoke mshta.exe download,"Powershell invoke mshta to download payload. Upon execution, a new PowerShell window will be opened which will display ""Download Cradle test success!"".

Provided by https://github.com/mgreen27/mgreen27.github.io
",execution,T1059.001,Command and Scripting Interpreter: PowerShell
7471518905b120283ba2644c9519bee2,atomic,Cobalt Strike post-exploitation pipe (before 4.2),"Uses the [Named Pipes Micro Emulation](https://github.com/center-for-threat-informed-defense/adversary_emulation_library/tree/master/micro_emulation_plans/src/named_pipes) executable from the Center for Threat Informed Defense to create a named pipe for inter-process communication.

The named pipe executable will pause for 30 seconds to allow the client and server to exchange a message through the pipe.
",execution,T1559,Inter-Process Communication
90c76bd616efee6d7c98dc6c1dcc6e99,atomic,Mimikatz - Cradlecraft PsSendKeys,"Run mimikatz via PsSendKeys. Upon execution, automated actions will take place to open file explorer, open notepad and input code, then mimikatz dump info will be displayed.
",execution,T1059.001,Command and Scripting Interpreter: PowerShell
43f573167a6260250bab539a9fd5de68,atomic,ExecIntoContainer,"Attackers who have permissions, can run malicious commands in containers in the cluster using exec command (“kubectl exec”). In this method, attackers can use legitimate images, such as an OS image (e.g., Ubuntu) as a backdoor container, and run their malicious code remotely by using “kubectl exec”.
",execution,T1609,Kubernetes Exec Into Container
9712e4aabe914d8a978ceb8c787f93a7,atomic,WMI Execute Local Process,"This test uses wmic.exe to execute a process on the local host.
When the test completes , a new process will be started locally .A notepad application will be started when input is left on default.
",execution,T1047,Windows Management Instrumentation
8764d6c964901b9a56ca3ffe5e5a004a,atomic,Command-Line Interface,"Using Curl to download and pipe a payload to Bash. NOTE: Curl-ing to Bash is generally a bad idea if you don't control the server.

Upon successful execution, sh will download via curl and wget the specified payload (echo-art-fish.sh) and set a marker file in `/tmp/art-fish.txt`.
",execution,T1059.004,Command and Scripting Interpreter: Bash
373d28654268ba4613372df3904eb11f,atomic,OSTap Payload Download,"Uses cscript //E:jscript to download a file
",execution,T1204.002,User Execution: Malicious File
6149b491c05b505e56aa8ec9ef9c357a,atomic,Registry-free process scope COR_PROFILER,"Creates process scope environment variables to enable a .NET profiler (COR_PROFILER) without making changes to the registry. The unmanaged profiler DLL (`T1574.012x64.dll`) executes when the CLR is loaded by PowerShell.

Reference: https://redcanary.com/blog/cor_profiler-for-persistence/
",multiple,T1574.012,Hijack Execution Flow: COR_PROFILER
697e8a432031075e47cccba24417013d,atomic,Suspicious vbs file run from startup Folder,"vbs files can be placed in and ran from the startup folder to maintain persistance. Upon execution, ""T1547.001 Hello, World VBS!"" will be displayed twice. 
Additionally, the new files can be viewed in the ""$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup""
folder and will also run when the computer is restarted and the user logs in.
",multiple,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
9ac97b0e88af420a8c767a7512985895,atomic,Parent PID Spoofing - Spawn from Specified Process,Spawns a notepad.exe process as a child of the current process.,multiple,T1134.004,Access Token Manipulation: Parent PID Spoofing
77f61dda65d9eefb8f8a08321e1c00c8,atomic,rc.local,"Modify rc.local
",multiple,T1037.004,Boot or Logon Initialization Scripts: Rc.common
7e2dc6c4605119184437dbc8cdb80265,atomic,Trap EXIT,"Launch bash shell with command arg to create TRAP on EXIT.
The trap executes script that writes to /tmp/art-fish.txt
",multiple,T1546.005,Event Triggered Execution: Trap
37355813cce32de2f3f6e5c6208f7b4d,atomic,Install AppInit Shim,"AppInit_DLLs is a mechanism that allows an arbitrary list of DLLs to be loaded into each user mode process on the system. Upon succesfully execution, 
you will see the message ""The operation completed successfully."" Each time the DLL is loaded, you will see a message box with a message of ""Install AppInit Shim DLL was called!"" appear.
This will happen regularly as your computer starts up various applications and may in fact drive you crazy. A reliable way to make the message box appear and verify the 
AppInit Dlls are loading is to start the notepad application. Be sure to run the cleanup commands afterwards so you don't keep getting message boxes showing up.

Note: If secure boot is enabled, this technique will not work. https://docs.microsoft.com/en-us/windows/win32/dlls/secure-boot-and-appinit-dlls
",multiple,T1546.010,Event Triggered Execution: AppInit DLLs
f64e72ba624a18d79c329f6bc9878cfc,atomic,Shortcut Modification,"This test to simulate shortcut modification and then execute. example shortcut (*.lnk , .url) strings check with powershell;
gci -path ""C:\Users"" -recurse -include *.url -ea SilentlyContinue | Select-String -Pattern ""exe"" | FL.
Upon execution, calc.exe will be launched.
",multiple,T1547.009,Boot or Logon Autostart Execution: Shortcut Modification
3b705c3783af10560a0cdfa46c7bc78f,atomic,Logging bash history to syslog,"There are several variables that can be set to control the appearance of the bash command prompt: PS1, PS2, PS3, PS4 and PROMPT_COMMAND. The contents of these variables are executed as if they had been typed on the command line. The PROMPT_COMMAND variable ""if set"" will be executed before the PS1 variable and can be configured to write the latest ""bash history"" entries to the syslog.

To gain persistence the command could be added to the users .bashrc or .bash_aliases or the systems default .bashrc in /etc/skel/ 
",multiple,T1056.001,Input Capture: Keylogging
506074e8dd220bcbee66150349292c00,atomic,Launch Daemon,"Utilize LaunchDaemon to launch `Hello World`
",multiple,T1543.004,Create or Modify System Process: Launch Daemon
64ccf7cd4358a0540ab51c8015c1b744,atomic,Detect Virtualization Environment via WMI Manufacturer/Model Listing (Windows),"Windows Management Instrumentation(WMI) objects contain system information which helps to detect virtualization. This test will get the model and manufacturer of the machine to determine if it is a virtual machine, such as through VMware or VirtualBox. 
",multiple,T1497.001,Virtualization/Sandbox Evasion: System Checks
cb8a765078926ac84335e80f18258c7d,atomic,Azure Persistence Automation Runbook Created or Modified,"Identifies when an Azure Automation runbook is created or modified. An adversary may create or modify an Azure
Automation runbook to execute malicious code and maintain persistence in their target's environment.
",multiple,T1078.004,Valid Accounts: Cloud Accounts
2db3b2385ba856424bfe130f69fc0529,atomic,COM hijacking via TreatAs,"This test first create a custom CLSID class pointing to the Windows Script Component runtime DLL. This DLL looks for the ScriptletURL key to get the location of the script to execute.
Then, it hijacks the CLSID for the Work Folders Logon Synchronization to establish persistence on user logon by creating the 'TreatAs' with the malicious CLSID as default value. The
test is validated by running 'rundll32.exe -sta ""AtomicTest""' to avoid logging out.

References:

https://youtu.be/3gz1QmiMhss?t=1251

https://github.com/enigma0x3/windows-operating-system-archaeology",multiple,T1546.015,Event Triggered Execution: Component Object Model Hijacking
dd1eadab4aa421d3a0048c3c85bf60e3,atomic,Sudo usage,"Common Sudo enumeration methods.
",multiple,T1548.003,Abuse Elevation Control Mechanism: Sudo and Sudo Caching
2fc2b9c9b48990938653dbe8966d487d,atomic,Persistence with Custom AutodialDLL,"The DLL pointed to by the AutodialDLL registry key is loaded every time a process connects to the internet. Attackers can gain persistent code execution by setting this key to a DLL of their choice. 

The sample dll provided, AltWinSock2DLL, will launch the notepad process. Starting and stopping a web browser such as MS Edge or Chrome should result in the dll executing.
[Blog](https://www.mdsec.co.uk/2022/10/autodialdlling-your-way/)
",multiple,T1546,Event Triggered Execution
0a3220a423ed7c7804af6e3587ad8811,atomic,HKLM - Policy Settings Explorer Run Key,"This test will create a HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run key value to launch calc.exe on boot. 
*Requires reboot
",multiple,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
6aafc5f2ffba8d901f5c59233700944d,atomic,Radmin Viewer Utility,"An adversary may use Radmin Viewer Utility to remotely control Windows device, this will start the radmin console.
",multiple,T1072,Software Deployment Tools
1bb96a80fd7968839ead470953ffb738,atomic,WinPwn - UAC Bypass ccmstp technique,UAC bypass using ccmstp technique via function of WinPwn,multiple,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
8b29cf959638afc0ecc68406e492b197,atomic,UACME Bypass Method 39,"Executes User Account Control Bypass according to the methods listed below. Upon successful execution you should see event viewer load and two administrative command prompts.
Note: The cleanup_command's which kill the spawned cmd and event viewer processes only work if run as admin.

Author: Stefan Kanthak

Type:	Dll Hijack

Method: .NET Code Profiler

Target:	\system32\mmc.exe

Component:	Attacker defined

Implementation:	ucmCorProfilerMethod

UCM Method:	UacMethodCorProfiler

https://github.com/hfiref0x/UACME
",multiple,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
88b05adaded4e793f1bfee0072c72da3,atomic,Bypass UAC by Mocking Trusted Directories,"Creates a fake ""trusted directory"" and copies a binary to bypass UAC. The UAC bypass may not work on fully patched systems
Upon execution the directory structure should exist if the system is patched, if unpatched Microsoft Management Console should launch
",multiple,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
1f15ab22c39a9b6bb2bb0d77276dfcb3,atomic,Add Executable Shortcut Link to User Startup Folder,Adds a non-malicious executable shortcut link to the current users startup directory. Test can be verified by going to the users startup directory and checking if the shortcut link exists. ,multiple,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
29797527e006f065df5c2d1f7b1b0b56,atomic,HKLM - Modify default System Shell - Winlogon Shell KEY Value ,"This test change the default value of HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell from ""explorer.exe"" to the full path of ""C:\Windows\explorer.exe"" 
to log a change to the key's default value without breaking boot sequence. 
An atacker will alternatively replace this with a custom shell. 
",multiple,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
34dfc0264e6fd27b4997fea21c0bbada,atomic,Change Startup Folder - HKCU Modify User Shell Folders Startup Value,"This test will modify the HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders  -V ""Startup"" value 
to point to a new startup folder where a payload could be stored to launch at boot.  *successful execution requires system restart
",multiple,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
01a2ad691dfb47b11d050fab371718d2,atomic,Persistence by modifying Windows Terminal profile,Modify Windows Terminal settings.json file to gain persistence. [Twitter Post](https://twitter.com/nas_bench/status/1550836225652686848),multiple,T1547.015,Boot or Logon Autostart Execution: Login Items
3de4b86460576de0cab88993cb3f03cd,atomic,Service ImagePath Change with reg.exe,"Change Service registry ImagePath of a bengin service to a malicious file
",multiple,T1574.011,Hijack Execution Flow: Services Registry Permissions Weakness
23246f1b042898be6b168efedcb36fd4,atomic,Launch Agent,"Create a plist and execute it
",multiple,T1543.001,Create or Modify System Process: Launch Agent
0c328b7ec82e0074cbb0745db3a53602,atomic,Bypass UAC using Fodhelper,"Bypasses User Account Control using the Windows 10 Features on Demand Helper (fodhelper.exe). Requires Windows 10.
Upon execution, ""The operation completed successfully."" will be shown twice and command prompt will be opened.
",multiple,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
adaa45fb1e639a778fbac7cba1278bcb,atomic,Disable tty_tickets for sudo caching,"Sets sudo caching tty_tickets value to disabled. This is dangerous to modify without using 'visudo', do not do this on a production system.
",multiple,T1548.003,Abuse Elevation Control Mechanism: Sudo and Sudo Caching
7440c68b83b6d728b4111d083facefec,atomic,Bypass UAC using Event Viewer (PowerShell),"PowerShell code to bypass User Account Control using Event Viewer and a relevant Windows Registry modification. More information here - https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/
Upon execution command prompt should be launched with administrative privalages
",multiple,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
49a7502f9c667aa3af9c87f6ab1e68b3,atomic,Append malicious start-process cmdlet,"Appends a start process cmdlet to the current user's powershell profile pofile that points to a malicious executable. Upon execution, calc.exe will be launched.
",multiple,T1546.013,Event Triggered Execution: PowerShell Profile
ef767bd150ff4c55c23837f0e3be6195,atomic,UACME Bypass Method 56,"Executes User Account Control Bypass according to the methods listed below. Upon successful execution you should see event viewer load and two administrative command prompts.
Note: The cleanup_command's which kill the spawned cmd and event viewer processes only work if run as admin.

Author: Hashim Jawad

Type:	Shell API

Method: Registry key manipulation

Target:	\system32\WSReset.exe

Component:	Attacker defined

Implementation:	ucmShellRegModMethod

UCM Method:	UacMethodShellWSReset

https://github.com/hfiref0x/UACME
",multiple,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
64430e7597668877a832b9d1e379c9f2,atomic,UAC Bypass with WSReset Registry Modification,"The following UAC bypass is focused on a registry key under ""HKCU:\Software\Classes\AppX82a6gwre4fdg3bt635tn5ctqjf8msdd2\Shell\open\command"" that will trigger a command once wsreset.exe runs. 
This bypass is limited to Windows 10 1803/1809 and may not run on Server platforms. The registry mod is where interest will be.
If successful, the command to run will spawn off wsreset.exe. 
[UAC Bypass in Windows 10 Store Binary](https://0x1.gitlab.io/exploit/UAC-Bypass-in-Windows-10-Store-Binary/)
",multiple,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
9b74d10b3164f13d357830d1a6ee334a,atomic,SystemBC Malware-as-a-Service Registry,"This Atomic will create a registry key called socks5_powershell for persistance access
https://medium.com/walmartglobaltech/systembc-powershell-version-68c9aad0f85c
",multiple,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
9bd17863cd45f82002a6f011de139363,atomic,rc.common,"Modify rc.common
",multiple,T1037.004,Boot or Logon Initialization Scripts: Rc.common
2e136b3814e4eb292c9234b5830833e1,atomic,Make and modify capabilities of a binary,"Make and modify [capabilities](https://man7.org/linux/man-pages/man7/capabilities.7.html) of a C source code file.
The binary doesn't have to modify the UID, but the binary is given the capability to arbitrarily modify it at any time with `setuid(0)`.
Without being owned by root, the binary can set the UID to 0.
",multiple,T1548.001,Abuse Elevation Control Mechanism: Setuid and Setgid
57058d39378e4ce49ccc8560efc49ee5,atomic,secedit used to create a Run key in the HKLM Hive,"secedit allows to manipulate the HKLM hive of the Windows registry. This test creates a Run key with the keyname calc having calc.exe as the value in the HKLM hive.
[Reference](https://blueteamops.medium.com/secedit-and-i-know-it-595056dee53d)
",multiple,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
22f293978e324252426f9c7e337ae181,atomic,HKLM - Add atomic_test key to launch executable as part of user setup,"This test will create an ""atomic_test"" key under 'HKLM:\SOFTWARE\Microsoft\Active Setup\Installed Components' to launch calc by configuring an active setup executable and 
forcing to run active setup using the ""runonce.exe /AlternateShellStartup"" command. 
Without the ""runonce.exe /AlternateShellStartup"" command it would run during the next logon for each user.

Note: If you logout before running the cleanup command, you will be required to go through the OOBE (out-of-box experience) setup sequence to log back in. 
The payload will only run once unless the cleanup command is run in between tests.

[Active Setup Explained](https://helgeklein.com/blog/active-setup-explained/)
",multiple,T1547.014,Active Setup
824ec334619ca634d13aff308a9a064c,atomic,WinPwn - UAC Magic,UAC bypass using Magic technique via function of WinPwn,multiple,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
7675653e29a9ca33083f7d66d87bec13,atomic,Modify SSP configuration in registry,"Add a value to a Windows registry SSP key, simulating an adversarial modification of those keys.",multiple,T1547.005,Boot or Logon Autostart Execution: Security Support Provider
9fdb4afa0cadeac6542326af9b29d8dc,atomic,Living off the land Terminal Input Capture on Linux with pam.d,"Pluggable Access Module, which is present on all modern Linux systems, generally contains a library called pam_tty_audit.so which logs all keystrokes for the selected users and sends it to audit.log.  All terminal activity on any new logins would then be archived and readable by an adversary with elevated privledges.

Passwords hidden by the console can also be logged, with 'log_passwd' as in this example.  If root logging is enabled, then output from any process which is later started by root is also logged, even if this policy is carefully enabled (e.g. 'disable=*' as the initial command).

Use 'aureport --tty' or other audit.d reading tools to read the log output, which is binary.  Mac OS does not currently contain the pam_tty_audit.so library. 
",multiple,T1056.001,Input Capture: Keylogging
1169b67e9f991716ba91833486f3c564,atomic,Change Startup Folder - HKLM Modify User Shell Folders Common Startup Value,"This test will modify the HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders -V ""Common Startup"" 
value to point to a new startup folder where a payload could be stored to launch at boot.  *successful execution requires system restart
",multiple,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
ec2e99e253e94b51fe6f07f83f29a7ef,atomic,Create Systemd Service and Timer,"This test creates Systemd service and timer then starts and enables the Systemd timer 
",multiple,T1053.006,Scheduled Task/Job: Systemd Timers
23000b943f18392d477ad7a1cad6586c,atomic,HKCU - Policy Settings Explorer Run Key,"This test will create a new value under HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run to launch calc.exe on boot. 
*Requires reboot
",multiple,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
575e90a4ba9a5eb7019c0238681c018a,atomic,Login as nobody (Linux),"An adversary may try to re-purpose a system account to appear legitimate. In this test change the login shell of the nobody account, change its password to nobody, su to nobody, exit, then reset nobody's shell to /usr/sbin/nologin.
",multiple,T1078.003,Valid Accounts: Local Accounts
ed508e035ded2716b4622276bc3da403,atomic,Mimikatz Pass the Hash,"Note: must dump hashes first
[Reference](https://github.com/gentilkiwi/mimikatz/wiki/module-~-sekurlsa#pth)
",multiple,T1550.002,Use Alternate Authentication Material: Pass the Hash
92a964d6a72ac5162788d5a81cf1311a,atomic,MacOS Swift Keylogger,"Utilizes a swift script to log keys to sout. It runs for 5 seconds then dumps the output to standard. Input Monitoring is required.
Input Monitoring can be enabled in System Preferences > Security & Privacy > Privacy > Input Monitoring.
Referece: https://cedowens.medium.com/taking-esf-for-a-nother-spin-6e1e6acd1b74
",multiple,T1056.001,Input Capture: Keylogging
95f9e48ea1fbdac2f1c7c656b655ae4c,atomic,USB Malware Spread Simulation,"Simulates an adversary copying malware to all connected removable drives. 
",multiple,T1091,Replication Through Removable Media
e3d4f78fc9dac33343b2f0865a8f8d45,atomic,AppleScript - Prompt User for Password,"Prompt User for Password (Local Phishing)
Reference: http://fuzzynop.blogspot.com/2014/10/osascript-for-local-phishing.html
",multiple,T1056.002,Input Capture: GUI Input Capture
b473176c321f31824c909c73807caf92,atomic,WinPwn - UAC Bypass DccwBypassUAC technique,UAC Bypass DccwBypassUAC technique via function of WinPwn,multiple,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
5e0427f03faf554046c6a29864087b49,atomic,LockBit Black - Modify Group policy settings -Powershell,"An adversary modifies group policy settings
",multiple,T1484.001,Domain Policy Modification: Group Policy Modification
0bba96f96380dbc1fe2f3f4db148b8c0,atomic,UACME Bypass Method 61,"Executes User Account Control Bypass according to the methods listed below. Upon successful execution you should see event viewer load and two administrative command prompts.
Note: The cleanup_command's which kill the spawned cmd and event viewer processes only work if run as admin.

Author: Enigma0x3/bytecode77 derivative by Nassim Asrir

Type:	Shell API

Method: Registry key manipulation

Target:	\system32\slui.exe, \system32\changepk.exe

Component:	Attacker defined

Implementation:	ucmShellRegModMethod

UCM Method:	UacMethodDebugObject

https://github.com/hfiref0x/UACME
",multiple,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
b75167c93041f3e37b246961277b128a,atomic,Set a SetGID flag on file,"This test sets the SetGID flag on a file in Linux and macOS.
",multiple,T1548.001,Abuse Elevation Control Mechanism: Setuid and Setgid
38609b9decfc9731e611769bb4923f1b,atomic,Filtered Packet Capture macOS using /dev/bpfN with sudo,"Opens a /dev/bpf file (O_RDONLY), sets BPF filter for 'udp' and captures packets for a few seconds.
",multiple,T1040,Network Sniffing
5a9be3b1696cc0cce8557f9596547e13,atomic,Bitsadmin Download (PowerShell),"This test simulates an adversary leveraging bitsadmin.exe to download
and execute a payload leveraging PowerShell

Upon execution you will find a github markdown file downloaded to the Temp directory
",multiple,T1197,BITS Jobs
63bbedafba2f541552ac3579e9e3737b,atomic,DLL Search Order Hijacking - amsi.dll,"Adversaries can take advantage of insecure library loading by PowerShell to load a vulnerable version of amsi.dll in order to bypass AMSI (Anti-Malware Scanning Interface)
https://enigma0x3.net/2017/07/19/bypassing-amsi-via-com-server-hijacking/

Upon successful execution, powershell.exe will be copied and renamed to updater.exe and load amsi.dll from a non-standard path.
",multiple,T1574.001,Hijack Execution Flow: DLL Search Order Hijacking
506788e383957332249010fb89399634,atomic,Set Arbitrary Binary as Screensaver,"This test copies a binary into the Windows System32 folder and sets it as the screensaver so it will execute for persistence. Requires a reboot and logon.
",multiple,T1546.002,Event Triggered Execution: Screensaver
120efc1cd824a8039d1bde03788cd04a,atomic,Bits download using desktopimgdownldr.exe (cmd),"This test simulates using desktopimgdownldr.exe to download a malicious file
instead of a desktop or lockscreen background img. The process that actually makes 
the TCP connection and creates the file on the disk is a svchost process (“-k netsvc -p -s BITS”) 
and not desktopimgdownldr.exe. See https://labs.sentinelone.com/living-off-windows-land-a-new-native-file-downldr/
",multiple,T1197,BITS Jobs
92578413245a3418c9dc21dc5db784ff,atomic,Winlogon HKLM Userinit Key Persistence - PowerShell,"PowerShell code to set Winlogon userinit key to execute a binary at logon along with userinit.exe.

Upon successful execution, PowerShell will modify a registry value to execute cmd.exe upon logon/logoff.
",multiple,T1547.004,Boot or Logon Autostart Execution: Winlogon Helper DLL
4e0f69a36c9e0b956f08afd5824972ce,atomic,Activate Guest Account,"The Adversaries can activate the default Guest user. The guest account is inactivated by default
",multiple,T1078.001,Valid Accounts: Default Accounts
f27b37f253617c39ac010d2ee1238b7e,atomic,WinPwn - UAC Bypass DiskCleanup technique,UAC bypass using DiskCleanup technique via function of WinPwn,multiple,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
fcbd91ebc012731e51a8d79264d49531,atomic,Scheduled task Remote,"Create a task on a remote system.
Upon successful execution, cmd.exe will create a scheduled task to spawn cmd.exe at 20:10 on a remote endpoint.
",multiple,T1053.005,Scheduled Task/Job: Scheduled Task
7a5720249df1912017c99a2df7f3d1a8,atomic,Append to existing loginwindow for Re-Opened Applications,"Appends an entry to launch Calculator hidden loginwindow.*.plist for next login.
Note that the change may not result in the added Calculator program launching on next user login.
It may depend on which version of macOS you are running on.
",multiple,T1547.007,Boot or Logon Autostart Execution: Re-opened Applications
e7d20e7f0087f8a4234c1d1b7a228bb0,atomic,Disable UAC admin consent prompt via ConsentPromptBehaviorAdmin registry key,"Disable User Account Conrol (UAC) for admin by setting the registry key 
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\ConsentPromptBehaviorAdmin to 0.

[MedusaLocker Ransomware](https://cloudsek.com/technical-analysis-of-medusalocker-ransomware/), 
[Purple Fox Rootkit](https://blogs.blackberry.com/en/2022/01/threat-thursday-purple-fox-rootkit), 
[Avaddon Ransomware](https://blogs.blackberry.com/en/2021/06/threat-thursday-avaddon-ransomware-uses-ddos-attacks-as-triple-threat)
",multiple,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
d45d48dbea3384059e638eab6b03abb5,atomic,Application Shim Installation,"Install a shim database. This technique is used for privilege escalation and bypassing user access control.
Upon execution, ""Installation of AtomicShim complete."" will be displayed. To verify the shim behavior, run 
the AtomicTest.exe from the <PathToAtomicsFolder>\\T1546.011\\bin directory. You should see a message box appear
with ""Atomic Shim DLL Test!"" as defined in the AtomicTest.dll. To better understand what is happening, review
the source code files is the <PathToAtomicsFolder>\\T1546.011\\src directory.
",multiple,T1546.011,Event Triggered Execution: Application Shimming
ce6632edd5ed72863c2300e15c9114bb,atomic,Suspicious bat file run from startup Folder,"bat files can be placed in and executed from the startup folder to maintain persistance

Upon execution, cmd will be run and immediately closed. Additionally, the new files can be viewed in the ""$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup""
folder and will also run when the computer is restarted and the user logs in.
",multiple,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
9b43c0d47dd2e7366c830755063df400,atomic,Service Installation PowerShell,"Installs A Local Service via PowerShell.
Upon successful execution, powershell will download `AtomicService.exe` from github. Powershell will then use `New-Service` and `Start-Service` to start service. Results will be displayed.
",multiple,T1543.003,Create or Modify System Process: Windows Service
2d5466e4b31c7db0860642bce47ef5ca,atomic,Detect Virtualization Environment (Linux),"systemd-detect-virt detects execution in a virtualized environment.
At boot, dmesg stores a log if a hypervisor is detected.
",multiple,T1497.001,Virtualization/Sandbox Evasion: System Checks
0739c2e7c60bf7703b36a4f8f3480ccc,atomic,System shell profile scripts,"An adversary may wish to establish persistence by adding commands into any of the script files in the /etc/profile.d/ directory, which are executed every time ""any"" user logs in.
",multiple,T1546.004,Event Triggered Execution: .bash_profile and .bashrc
90d152c066fad4dc7d54b9a9e4443b50,atomic,Process Hollowing using PowerShell,"This test uses PowerShell to create a Hollow from a PE on disk with explorer as the parent.
Credit to FuzzySecurity (https://github.com/FuzzySecurity/PowerShell-Suite/blob/master/Start-Hollow.ps1)
",multiple,T1055.012,Process Injection: Process Hollowing
244cd00410232659c0098f9ad4b9da2a,atomic,Add macOS LoginItem using Applescript,"Runs osascript on a file to create new LoginItem for current user.
NOTE: Will popup dialog prompting user to Allow or Deny Terminal.app to control ""System Events""
Therefore, it can't be automated until the TCC is granted.
The login item launches Safari.app when user logs in, but there is a cleanup script to remove it as well.
In addition to the `osascript` Process Events, file modification events to
`/Users/*/Library/Application Support/com.apple.backgroundtaskmanagementagent/backgrounditems.btm` should be seen.
",multiple,T1547.015,Boot or Logon Autostart Execution: Login Items
2e91cc775c1137720e978b906e2396fe,atomic,Scheduled task Local,"Upon successful execution, cmd.exe will create a scheduled task to spawn cmd.exe at 20:10.
",multiple,T1053.005,Scheduled Task/Job: Scheduled Task
b74a2618d5277373529a8eae0e301f80,atomic,"Create Systemd Service file,  Enable the service , Modify and Reload the service.","This test creates a systemd service unit file and enables it to autostart on boot. Once service is created and enabled, it also modifies this same service file showcasing both Creation and Modification of system process. 
",multiple,,
2883ed253a0b6fa034cd76ec72c89d3b,atomic,Create registry persistence via AppCert DLL,"Creates a new 'AtomicTest' value pointing to an AppCert DLL in the AppCertDlls registry key. 
Once the computer restarted, the DLL will be loaded in multiple processes and write an 
'AtomicTest.txt' file in C:\Users\Public\ to validate that the DLL executed succesfully.

Reference: https://skanthak.homepage.t-online.de/appcert.html
",multiple,T1546.009,Event Triggered Execution: AppCert DLLs
074cad3a55b99b8e434702ffcf44f4d1,atomic,Cron - Replace crontab with referenced file,"This test replaces the current user's crontab file with the contents of the referenced file. This technique was used by numerous IoT automated exploitation attacks.
",multiple,T1053.003,Scheduled Task/Job: Cron
1b82e5d4e4707c4923e7a0f8143b3186,atomic,At.exe Scheduled task,"Executes cmd.exe
Note: deprecated in Windows 8+

Upon successful execution, cmd.exe will spawn at.exe and create a scheduled task that will spawn cmd at a specific time.
",multiple,T1053.002,Scheduled Task/Job: At
bbc5f212082c3b0472a1f50748d9be2a,atomic,Create local account with admin privileges using sysadminctl utility - MacOS,After execution the new account will be active and added to the Administrators group,multiple,T1078.003,Valid Accounts: Local Accounts
d1bde9af5206152c9980a5b6adcc1813,atomic,Named pipe client impersonation,"Uses PowerShell and Empire's [GetSystem module](https://github.com/BC-SECURITY/Empire/blob/v3.4.0/data/module_source/privesc/Get-System.ps1). The script creates a named pipe, and a service that writes to that named pipe. When the service connects to the named pipe, the script impersonates its security context.
When executed successfully, the test displays the domain and name of the account it's impersonating (local SYSTEM).

Reference: https://blog.cobaltstrike.com/2014/04/02/what-happens-when-i-type-getsystem/",multiple,T1134.001,Access Token Manipulation: Token Impersonation/Theft
596285d5302f5ad6527e7811d620bebf,atomic,At - Schedule a job,"This test submits a command to be run in the future by the `at` daemon.
",multiple,T1053.002,Scheduled Task/Job: At
8694818da4f9da7580fdb477b6a3685a,atomic,Packet Capture macOS using /dev/bpfN with sudo,"Opens a /dev/bpf file (O_RDONLY) and captures packets for a few seconds.
",multiple,T1040,Network Sniffing
e538e0ff74962aaf1dbd08baa5c7853f,atomic,powerShell Persistence via hijacking default modules - Get-Variable.exe,"Colibri leverages PowerShell in a unique way to maintain persistence after a reboot. Depending on the Windows version, Colibri drops its copy in %APPDATA%\Local\Microsoft\WindowsApps and 
names it Get-Variable.exe for Windows 10 and above.
https://blog.malwarebytes.com/threat-intelligence/2022/04/colibri-loader-combines-task-scheduler-and-powershell-in-clever-persistence-technique/
",multiple,T1574.008,Hijack Execution Flow: Path Interception by Search Order Hijacking
16e6823c4656f5cd155051f5f1e5d6ad,atomic,Suspicious jse file run from startup Folder,"jse files can be placed in and ran from the startup folder to maintain persistance.
Upon execution, ""T1547.001 Hello, World JSE!"" will be displayed twice. 
Additionally, the new files can be viewed in the ""$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup""
folder and will also run when the computer is restarted and the user logs in.
",multiple,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
f0e294c25efe6c5a459c2e353f586b10,atomic,Create a user level transient systemd service and timer,"Schedule a user level transient task (will not survive a reboot) without having to create the .timer or .service files by using the systemd-run command. 
",multiple,T1053.006,Scheduled Task/Job: Systemd Timers
23a55c307920b731e16aa89f32d18f7a,atomic,"Packet Capture Linux socket AF_INET,SOCK_RAW,TCP with sudo","Captures packets with domain=AF_INET,type=SOCK_RAW,protocol=TCP for a few seconds.
",multiple,T1040,Network Sniffing
7ca3ddd55eb462f0bea2e31a88773ddc,atomic,Netsh Helper DLL Registration,"You can register a ""helper dll"" with Netsh as a persistance mechanism. The code in the dll is executed every time netsh.exe is called.
The NetshHelper.dll provided with the atomic will simply launch notepad when netsh.exe is run.

[Blog](https://htmlpreview.github.io/?https://github.com/MatthewDemaske/blogbackup/blob/master/netshell.html)
[Sample DLL code](https://github.com/outflanknl/NetshHelperBeacon)
",multiple,T1546.007,Event Triggered Execution: Netsh Helper DLL
920a251237fac2b70fe4d647aa16bfdd,atomic,Task Scheduler via VBA,"This module utilizes the Windows API to schedule a task for code execution (notepad.exe). The task scheduler will execute ""notepad.exe"" within
30 - 40 seconds after this module has run
",multiple,T1053.005,Scheduled Task/Job: Scheduled Task
bdd0be771e2462e572e2ecfbe5bf2eb7,atomic,Snake Malware Kernel Driver Comadmin,"The following Atomic Test will write an file, comadmin.dat, to disk. From the report, Snake's installer drops the kernel driver and a custom DLL which is used to load the driver into a
single AES encrypted file on disk. Typically, this file is named “comadmin.dat” and is stored in the %windows%\system32\Com directory. 
This Atomic Test will write a hardcoded named file to disk in the com directory named comadmin.dat.
[Snake Malware - CISA](https://media.defense.gov/2023/May/09/2003218554/-1/-1/0/JOINT_CSA_HUNTING_RU_INTEL_SNAKE_MALWARE_20230509.PDF)  
",multiple,T1547.006,Boot or Logon Autostart Execution: Kernel Modules and Extensions
44dfbc0aace944657118f7287b828da2,atomic,UACME Bypass Method 59,"Executes User Account Control Bypass according to the methods listed below. Upon successful execution you should see event viewer load and two administrative command prompts.
Note: The cleanup_command's which kill the spawned cmd and event viewer processes only work if run as admin.

Author: James Forshaw

Type:	AppInfo ALPC

Method: RAiLaunchAdminProcess and DebugObject

Target:	Attacker defined

Component:	Attacker defined

Implementation:	ucmDebugObjectMethod

UCM Method:	UacMethodDebugObject

https://github.com/hfiref0x/UACME
",multiple,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
e0d59dde7cd701edd5144a01d622a5f2,atomic,Rubeus Kerberos Pass The Ticket,"Requesting a TGT on a remote system and retrieving it locally before requesting a service ticket with it. This is a Pass-The-Ticket attack because the TGT is obtained on the remote system, then used from a different machine (local).
PsExec is used to execute commands on the remote system, and the ""C$"" admin share is used to retrieve the TGT, so the current user must have admin rights remotely and other PsExec prerequisites must be met.
",multiple,T1550.003,Use Alternate Authentication Material: Pass the Ticket
6de55cdb0e4e9cc25ea32b66d93d3039,atomic,Create a system level transient systemd service and timer,"Schedule a system level transient task (will not survive a reboot) without having to create the .timer or .service files by using the systemd-run command. 
",multiple,T1053.006,Scheduled Task/Job: Systemd Timers
501af516bd8b24fee0c7c650ae5cc861,atomic,Create shortcut to cmd in startup folders,"LNK file to launch CMD placed in startup folder. Upon execution, open File Explorer and browse to ""%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup\""
to view the new shortcut.
",multiple,T1547.009,Boot or Logon Autostart Execution: Shortcut Modification
9630f6d2ac825e459abc69a7d692e98b,atomic,Malicious PAM module,"Creates a PAM module, inserts a rule to use it, and then tests it.

Upon successful execution, this test will create a PAM module that allows every user to su to root without a password.
",multiple,T1556.003,Modify Authentication Process: Pluggable Authentication Modules
7cdbf13211f9012f4192405636a97e20,atomic,Add a new/existing user to the admin group using dseditgroup utility - macOS,After execution the current/new user will be added to the Admin group,multiple,T1078.003,Valid Accounts: Local Accounts
59202d45130d86feab6050a72d2047fc,atomic,Enable Guest account with RDP capability and admin privileges,"After execution the Default Guest account will be enabled (Active) and added to Administrators and Remote Desktop Users Group,
and desktop will allow multiple RDP connections.
",multiple,T1078.001,Valid Accounts: Default Accounts
552764b3178c11896543fea2c7117f87,atomic,Dylib Injection via DYLD_INSERT_LIBRARIES,"injects a dylib that opens calculator via env variable
",multiple,T1574.006,Hijack Execution Flow: LD_PRELOAD
557321faaf98c77b2b452cecd7b1de37,atomic,RunPE via VBA,"This module executes notepad.exe from within the WINWORD.EXE process
",multiple,T1055.012,Process Injection: Process Hollowing
c74f43a6ba27a277e8214be228a6360f,atomic,Create local account with admin privileges,After execution the new account will be active and added to the Administrators group,multiple,T1078.003,Valid Accounts: Local Accounts
acf646b22c5d2c2b1058feb7da1f3bdc,atomic,Modify BootExecute Value,"This test modifies the BootExecute registry value to ""autocheck autoche *"", which can be used to simulate an adversary's attempt to tamper with the system's boot process. 
Reference - https://www.welivesecurity.com/wp-content/uploads/2018/09/ESET-LoJax.pdf
NOTE that by not saving the correct value, you may inhibit your system from booting properly. Only run on a test system. There is a reg export before running the Atomic.
",multiple,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
c1392878b0e39a2060e7e1b70e5a580b,atomic,WinPwn - Get SYSTEM shell - Bind System Shell using UsoClient DLL load technique,Get SYSTEM shell - Bind System Shell using UsoClient DLL load technique via function of WinPwn,multiple,T1055.001,Process Injection: Dynamic-link Library Injection
e5b238f98f504894f9c2387cf411022b,atomic,Enable root account using dsenableroot utility - MacOS,After execution the current/new user will have root access,multiple,T1078.003,Valid Accounts: Local Accounts
412b488e4abdb153189de78b3a79af44,atomic,Re-Opened Applications using LoginHook,"Mac Defaults

[Reference](https://developer.apple.com/library/content/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CustomLogin.html)
",multiple,T1547.007,Boot or Logon Autostart Execution: Re-opened Applications
6b55fcd6d1b26db7252faac7cf27a2ee,atomic,Shellcode execution via VBA,"This module injects shellcode into a newly created process and executes. By default the shellcode is created,
with Metasploit, for use on x86-64 Windows 10 machines.

Note: Due to the way the VBA code handles memory/pointers/injection, a 64bit installation of Microsoft Office
is required.
",multiple,T1055,Process Injection
5ce7136a4547b0bf3ca074c94fb10b24,atomic,WinPwn - Loot local Credentials - powerhell kittie,Loot local Credentials - powerhell kittie technique via function of WinPwn,multiple,T1078.003,Valid Accounts: Local Accounts
3d4732e94edec084f95224e4169c767d,atomic,Shared Library Injection via LD_PRELOAD,"This test injects a shared object library via the LD_PRELOAD environment variable to execute. This technique was used by threat actor Rocke during the exploitation of Linux web servers. This requires the `glibc` package.

Upon successful execution, bash will utilize LD_PRELOAD to load the shared object library `/etc/ld.so.preload`. Output will be via stdout.
",multiple,T1574.006,Hijack Execution Flow: LD_PRELOAD
f91d7dfb1e6fd4fa742f24927ca4af26,atomic,Bypass UAC using ComputerDefaults (PowerShell),"PowerShell code to bypass User Account Control using ComputerDefaults.exe on Windows 10
Upon execution administrative command prompt should open
",multiple,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
03c06bf996733700b9bc025c7f5bc887,atomic,Running Chrome VPN Extensions via the Registry 2 vpn extension,"Running Chrome VPN Extensions via the Registry install 2 vpn extension, please see ""T1133\src\list of vpn extension.txt"" to view complete list
",multiple,T1133,External Remote Services
84942e0bfed7ce40449941faec766c5e,atomic,Replace binary of sticky keys,"Replace sticky keys binary (sethc.exe) with cmd.exe
",multiple,T1546.008,Event Triggered Execution: Accessibility Features
b889d0e778b45382f11a30f8f011344a,atomic,Reactivate a locked/expired account (Linux),"A system administrator may have locked and expired a user account rather than deleting it. ""the user is coming back, at some stage"" An adversary may reactivate a inactive account in an attempt to appear legitimate. 

In this test we create a ""art"" user with the password art, lock and expire the account, try to su to art and fail, unlock and renew the account, su successfully, then delete the account.
",multiple,T1078.003,Valid Accounts: Local Accounts
d04c129f52b4b6c47582faf785fdb541,atomic,TinyTurla backdoor service w64time,"It's running Dll as service to emulate the TinyTurla backdoor

[Related Talos Blog](https://blog.talosintelligence.com/2021/09/tinyturla.html)
",multiple,T1543.003,Create or Modify System Process: Windows Service
a852c0f47cea36898e87cbd8fa53f943,atomic,Input Capture,"Utilize PowerShell and external resource to capture keystrokes
[Payload](https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1056.001/src/Get-Keystrokes.ps1)
Provided by [PowerSploit](https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Get-Keystrokes.ps1)

Upon successful execution, Powershell will execute `Get-Keystrokes.ps1` and output to key.log.
",multiple,T1056.001,Input Capture: Keylogging
c13fdd68cb4b40650f00e5451ffde021,atomic,Create a new time provider,"Establishes persistence by creating a new time provider registry key under HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W32Time\TimeProvider.
The new time provider will point to a DLL which will be loaded after the w32time service is started. The DLL will then create the file AtomicTest.txt
in C:\Users\Public\ as validation that the test is successful.

Payload source code: https://github.com/tr4cefl0w/payloads/tree/master/T1547.003/
",multiple,T1547.003,Time Providers
5f939e65285f8e67507359887d2109a2,atomic,"Persist, Download, & Execute","This test simulates an adversary leveraging bitsadmin.exe to schedule a BITS transferand execute a payload in multiple steps.
Note that in this test, the file executed is not the one downloaded. The downloading of a random file is simply the trigger for getting bitsdamin to run an executable.
This has the interesting side effect of causing the executable (e.g. notepad) to run with an Initiating Process of ""svchost.exe"" and an Initiating Process Command Line of ""svchost.exe -k netsvcs -p -s BITS""
This job will remain in the BITS queue until complete or for up to 90 days by default if not removed.
",multiple,T1197,BITS Jobs
3571488e9343065a62e25f45fe8848f0,atomic,New shim database files created in the default shim database directory,"Upon execution, check the ""C:\Windows\apppatch\Custom\"" folder for the new shim database

https://www.fireeye.com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html
",multiple,T1546.011,Event Triggered Execution: Application Shimming
13dee93f2cdf7f027718d0c517c60c8c,atomic,Set a SetUID flag on file,"This test sets the SetUID flag on a file in Linux and macOS.
",multiple,T1548.001,Abuse Elevation Control Mechanism: Setuid and Setgid
60a4a8dcf702a076bbf4e04d3a049263,atomic,Execution of program.exe as service with unquoted service path,"When a service is created whose executable path contains spaces and isn’t enclosed within quotes, leads to a vulnerability
known as Unquoted Service Path which allows a user to gain SYSTEM privileges.
In this case, if an executable program.exe in C:\ exists, C:\program.exe will be executed instead of test.exe in C:\Program Files\subfolder\test.exe.
",multiple,T1574.009,Hijack Execution Flow: Path Interception by Unquoted Path
5043cd5dca66ce6b455b4aa793f0f0d5,atomic,Persistance with Event Monitor - emond,"Establish persistence via a rule run by OSX's emond (Event Monitor) daemon at startup, based on https://posts.specterops.io/leveraging-emond-on-macos-for-persistence-a040a2785124
",multiple,T1546.014,Event Triggered Execution: Emond
5503b4931592d3d01840133599b87893,atomic,Reg Key Run,"Run Key Persistence

Upon successful execution, cmd.exe will modify the registry by adding \""Atomic Red Team\"" to the Run key. Output will be via stdout. 
",multiple,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
534ee0652aca292fc05421f6f429918b,atomic,Reg Key RunOnce,"RunOnce Key Persistence.

Upon successful execution, cmd.exe will modify the registry to load AtomicRedTeam.dll to RunOnceEx. Output will be via stdout. 
",multiple,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
efc885d494a744745a149ad2802e7403,atomic,Install and Register Password Filter DLL,"Uses PowerShell to install and register a password filter DLL. Requires a reboot and administrative privileges.
The binary in bin is https://www.virustotal.com/gui/file/95140c1ad39fd632d1c1300b246293297aa272ce6035eecc3da56e337200221d/detection
Source is in src folder. 
This does require a reboot to see the filter loaded into lsass.exe. 
It does require Administrative privileges to import the clean registry values back into LSA, it is possible you may have to manually do this after for cleanup.
",multiple,T1556.002,Modify Authentication Process: Password Filter DLL
8ad2169ec4d0df6df900f8f8959ad761,atomic,Bypass UAC using Event Viewer (cmd),"Bypasses User Account Control using Event Viewer and a relevant Windows Registry modification. More information here - https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/
Upon execution command prompt should be launched with administrative privileges. 
",multiple,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
084a99acba0e75a6a5c99b8fd0bb3a92,atomic,IFEO Add Debugger,"Leverage Global Flags Settings
",multiple,T1546.012,Event Triggered Execution: Image File Execution Options Injection
004870c555d9397f779884031520700a,atomic,Remote Service Installation CMD,"Download an executable from github and start it as a service on a remote endpoint
Upon successful execution, powershell will download `AtomicService.exe` from github. cmd.exe will spawn sc.exe which will create and start the service. Results will output via stdout.
",multiple,T1543.003,Create or Modify System Process: Windows Service
9cfb8e47dd14ee8f6d44afeaa294bab1,atomic,Add Port Monitor persistence in Registry,Add key-value pair to a Windows Port Monitor registry. On the subsequent reboot DLL will be execute under spoolsv with NT AUTHORITY/SYSTEM privilege.,multiple,T1547.010,Boot or Logon Autostart Execution: Port Monitors
0e63d76adc58b1d2a1ff6215a64e0a2a,atomic,COM Hijacking - InprocServer32,"This test uses PowerShell to hijack a reference to a Component Object Model by creating registry values under InprocServer32 key in the HKCU hive then calling the Class ID to be executed via rundll32.exe.

Reference: https://bohops.com/2018/06/28/abusing-com-registry-structure-clsid-localserver32-inprocserver32/",multiple,T1546.015,Event Triggered Execution: Component Object Model Hijacking
f782c9b7007a34343faec301b64e7435,atomic,Bypass UAC using sdclt DelegateExecute,"Bypasses User Account Control using a fileless method, registry only.
Upon successful execution, sdclt.exe will spawn cmd.exe to spawn notepad.exe
[Reference - sevagas.com](http://blog.sevagas.com/?Yet-another-sdclt-UAC-bypass)
Adapted from [MITRE ATT&CK Evals](https://github.com/mitre-attack/attack-arsenal/blob/66650cebd33b9a1e180f7b31261da1789cdceb66/adversary_emulation/APT29/CALDERA_DIY/evals/payloads/stepFourteen_bypassUAC.ps1)
",multiple,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
6881a4589710d53f0c146e91db513f01,atomic,Windows Internal Packet Capture,"Uses the built-in Windows packet capture
After execution you should find a file named trace.etl and trace.cab in the temp directory",multiple,T1040,Network Sniffing
0466a75bd82ff4bb4ff79cee53ac4312,atomic,Import XML Schedule Task with Hidden Attribute,"Create an scheduled task that executes calc.exe after user login from XML that contains hidden setting attribute. 
This technique was seen several times in tricbot malware and also with the targetted attack campaigne the industroyer2.
",multiple,T1053.005,Scheduled Task/Job: Scheduled Task
01d1dfec9efbf1f20ee65df03209cf5b,atomic,Append to the system shell profile,"An adversary may wish to establish persistence by executing malicious commands from the systems /etc/profile every time ""any"" user logs in.
",multiple,T1546.004,Event Triggered Execution: .bash_profile and .bashrc
a55327064e0992e3a12b50328733034d,atomic,UACME Bypass Method 34,"Executes User Account Control Bypass according to the methods listed below. Upon successful execution you should see event viewer load and two administrative command prompts.
Note: The cleanup_command's which kill the spawned cmd and event viewer processes only work if run as admin.

Author: James Forshaw

Type:	Shell API

Method: Environment variables expansion

Target:	\system32\svchost.exe via \system32\schtasks.exe

Component:	Attacker defined

Implementation:	ucmDiskCleanupEnvironmentVariable

UCM Method:	UacMethodDiskSilentCleanup

https://github.com/hfiref0x/UACME
",multiple,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
6623d6925383b47a30d6c7e5e8c4d752,atomic,Windows Internal pktmon capture,"Will start a packet capture and store log file as t1040.etl.
https://lolbas-project.github.io/lolbas/Binaries/Pktmon/",multiple,T1040,Network Sniffing
c075d43b9dbd82bcbe36e82c7fee318a,atomic,UACME Bypass Method 23,"Executes User Account Control Bypass according to the methods listed below. Upon successful execution you should see event viewer load and two administrative command prompts.
Note: The cleanup_command's which kill the spawned cmd and event viewer processes only work if run as admin.

Author: Leo Davidson derivative

Type:	Dll Hijack

Method: IFileOperation

Target:	\system32\pkgmgr.exe

Component: DismCore.dll

Implementation:	ucmDismMethod

UCM Method:	UacMethodDISM

https://github.com/hfiref0x/UACME
",multiple,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
97eb1eb07611c5f98768250b1b705a67,atomic,Trap SIGINT,"Launch bash shell with command arg to create TRAP on SIGINT (CTRL+C), then send SIGINT signal.
The trap executes script that writes to /tmp/art-fish.txt
",multiple,T1546.005,Event Triggered Execution: Trap
4bdc05fe2f0006f86575053dc740edf3,atomic,Attaches Command Prompt as a Debugger to a List of Target Processes,"Attaches cmd.exe to a list of processes. Configure your own Input arguments to a different executable or list of executables.
Upon successful execution, powershell will modify the registry and swap osk.exe with cmd.exe.
",multiple,T1546.008,Event Triggered Execution: Accessibility Features
3e78d2e02cf72b0ed83ba4849ff1f32e,atomic,Do reconnaissance for files that have the setgid bit set,"This test simulates a command that can be run to enumerate files that have the setgid bit set
",multiple,T1548.001,Abuse Elevation Control Mechanism: Setuid and Setgid
0dbdf1a2a87e718a6ac8a8e3415a7fac,atomic,Add persistance via Recycle bin,"Add a persistance via Recycle bin [vxunderground](https://github.com/vxunderground/VXUG-Papers/blob/main/The%20Persistence%20Series/Persistence%20via%20Recycle%20Bin/Persistence_via_Recycle_Bin.pdf)
User have to clic on the recycle bin to lauch the payload (here calc)
",multiple,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
00b2b957c27c8ecb65d72d9c515a3e4c,atomic,Hook PowerShell TLS Encrypt/Decrypt Messages,"Hooks functions in PowerShell to read TLS Communications
",multiple,T1056.004,Input Capture: Credential API Hooking
5db2884b6ca3ab932848f295a3896dc0,atomic,Scheduled Task Startup Script,"Run an exe on user logon or system startup.  Upon execution, success messages will be displayed for the two scheduled tasks. To view
the tasks, open the Task Scheduler and look in the Active Tasks pane.
",multiple,T1053.005,Scheduled Task/Job: Scheduled Task
4c1562d00577b20d261d16ac889434bd,atomic,Cron - Add script to /var/spool/cron/crontabs/ folder,"This test adds a script to a /var/spool/cron/crontabs folder configured to execute on a schedule. This technique was used by the threat actor Rocke during the exploitation of Linux web servers.
",multiple,T1053.003,Scheduled Task/Job: Cron
50a9be8bbff4d4ffe0b699cb8d040c6d,atomic,HKLM - Persistence using CommandProcessor AutoRun key (With Elevation),"An adversary may abuse the CommandProcessor AutoRun registry key to persist. Every time cmd.exe is executed, the command defined in the AutoRun key also gets executed.
[reference](https://devblogs.microsoft.com/oldnewthing/20071121-00/?p=24433)",multiple,T1546,Event Triggered Execution
79cc22aa5dd3e0e7dba90a3d0cfa1f0c,atomic,Packet Capture macOS using tcpdump or tshark,"Perform a PCAP on macOS. This will require Wireshark/tshark to be installed. TCPdump may already be installed.

Upon successful execution, tshark or tcpdump will execute and capture 5 packets on interface en0A.
",multiple,T1040,Network Sniffing
2125c8629020f136ed11d2124dc76d2c,atomic,Packet Capture Windows Command Prompt,"Perform a packet capture using the windows command prompt. This will require a host that has Wireshark/Tshark
installed.

Upon successful execution, tshark will execute and capture 5 packets on interface ""Ethernet"".
",multiple,T1040,Network Sniffing
6c2b844d6dcbe8b2c527dca7fe49a8d9,atomic,Winlogon Notify Key Logon Persistence - PowerShell,"PowerShell code to set Winlogon Notify key to execute a notification package DLL at logon.

Upon successful execution, PowerShell will modify a registry value to execute atomicNotificationPackage.dll upon logon/logoff.
",multiple,T1547.004,Boot or Logon Autostart Execution: Winlogon Helper DLL
ed65658e4431bc3b636dd0de29bf8e35,atomic,Registry key creation and/or modification events for SDB,"Create registry keys in locations where fin7 typically places SDB patches. Upon execution, output will be displayed describing
the registry keys that were created. These keys can also be viewed using the Registry Editor.

https://www.fireeye.com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html
",multiple,T1546.011,Event Triggered Execution: Application Shimming
3e1dbbddf490e1869a130a07cb254e5f,atomic,Do reconnaissance for files that have the setuid bit set,"This test simulates a command that can be run to enumerate files that have the setuid bit set
",multiple,T1548.001,Abuse Elevation Control Mechanism: Setuid and Setgid
d0966749d457cb6218a8cd5ee5128ea2,atomic,Parent PID Spoofing - Spawn from Current Process,Spawns a powershell.exe process as a child of the current process.,multiple,T1134.004,Access Token Manipulation: Parent PID Spoofing
b9dd5e8853b5e83299c439c34f9b77de,atomic,MacOS - Load Kernel Module via KextManagerLoadKextWithURL(),"This test uses the IOKit API to load a kernel module for macOS.
Harcoded to use SoftRAID kext
",multiple,T1547.006,Boot or Logon Autostart Execution: Kernel Modules and Extensions
4150ef18184112953ae5742a3f8de64e,atomic,PowerShell Modify A Scheduled Task,"Create a scheduled task with an action and modify the action to do something else. The initial idea is to showcase Microsoft Windows TaskScheduler Operational log modification of an action on a Task already registered. 
It will first be created to spawn cmd.exe, but modified to run notepad.exe.

Upon successful execution, powershell.exe will create a scheduled task and modify the action. 
",multiple,T1053.005,Scheduled Task/Job: Scheduled Task
50598e403dbf17cf341e4e08a9c5b0d1,atomic,Modify Fax service to run PowerShell,"This test will temporarily modify the service Fax by changing the binPath to PowerShell
and will then revert the binPath change, restoring Fax to its original state.
Upon successful execution, cmd will modify the binpath for `Fax` to spawn powershell. Powershell will then spawn.
",multiple,T1543.003,Create or Modify System Process: Windows Service
7ade8854cf5f27a38e6b9d9aba15e22b,atomic,Auditd keylogger,"The linux audit tool auditd can be used to capture 32 and 64 bit command execution and place the command in the /var/log/audit/audit.log audit log. 
",multiple,T1056.001,Input Capture: Keylogging
5ee8fce78c4cef28c4e6ecebe77bdba4,atomic,LLMNR Poisoning with Inveigh (PowerShell),Inveigh conducts spoofing attacks and hash/credential captures through both packet sniffing and protocol specific listeners/sockets. This Atomic will run continuously until you cancel it or it times out.,multiple,T1557.001,Adversary-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay
41d1aa5e9ab0eb27bf8f9fb0f43ac0ab,atomic,PDQ Deploy RAT,"An adversary may use PDQ Deploy Software to deploy the Remote Adminstartion Tool, this will start the PDQ console.
",multiple,T1072,Software Deployment Tools
dc594307cc6b1ed451b35e51f192dbac,atomic,"Packet Capture Linux socket AF_INET,SOCK_PACKET,UDP with sudo","Captures packets with domain=AF_INET,type=SOCK_PACKET,protocol=UDP for a few seconds.
SOCK_PACKET is ""obsolete"" according to the man page, but still works on Ubuntu 20.04
",multiple,T1040,Network Sniffing
6fae357c43fd211c9d39fe7583281bf0,atomic,Access Token Manipulation,"This Action demonstrates how an access token for a specific program can spawn another program under a different owner. 
Adversaries can leverage access tokens to run programs under a different user not only to achieve privilege escalation but also to evade detection by blending in with normal user activity. 
This Action will query all processes and list the process name and owner.It will then make a copy of an existing token to create a new instance of cmd.exe
",multiple,T1134.002,Create Process with Token
87c08b408756abf34e1fa3403d01fde7,atomic,MacOS - Load Kernel Module via kextload and kmutil,"This test uses the kextload and kmutil commands to load and unload a MacOS kernel module.
",multiple,T1547.006,Boot or Logon Autostart Execution: Kernel Modules and Extensions
6f6518545b5dd35eecbed18dfa828e8c,atomic,Create Symbolic Link From osk.exe to cmd.exe,"Replace accessiblity executable with cmd.exe to provide elevated command prompt from login screen without logging in.
",multiple,T1546.008,Event Triggered Execution: Accessibility Features
fe3527480a77ab0b52a518654e120b72,atomic,WinPwn - Loot local Credentials - Safetykatz,Loot local Credentials - Safetykatz technique via function of WinPwn,multiple,T1078.003,Valid Accounts: Local Accounts
4fc7ed6101b8c04379734b0e4261902d,atomic,Detect Virtualization Environment (MacOS),"ioreg contains registry entries for all the device drivers in the system. If it's a virtual machine, one of the device manufacturer will be a Virtualization Software.
",multiple,T1497.001,Virtualization/Sandbox Evasion: System Checks
7e8dd75577f0fa81b5a9b81ed6eae063,atomic,Create Systemd Service,"This test creates a Systemd service unit file and enables it as a service.
",multiple,T1543.002,Create or Modify System Process: Systemd Service
aa40e8fe704a97fb7f7a5a02e9334824,atomic,Parent PID Spoofing - Spawn from svchost.exe,Spawnd a process as a child of the first accessible svchost.exe process.,multiple,T1134.004,Access Token Manipulation: Parent PID Spoofing
55636ecc1eac15ca3c32a9f01626e413,atomic,Bypass UAC using SilentCleanup task,"Bypass UAC using SilentCleanup task on Windows 8-10 using bat file from https://www.reddit.com/r/hacking/comments/ajtrws/bypassing_highest_uac_level_windows_810/

There is an auto-elevated task called SilentCleanup located in %windir%\system32\cleanmgr.exe This can be abused to elevate any file with Administrator privileges without prompting UAC (even highest level).

For example, we can set the windir registry kye to: ""cmd /k REM ""

And forcefully run SilentCleanup task:

schtasks /run /tn \Microsoft\Windows\DiskCleanup\SilentCleanup /I

REM will tell it to ignore everything after %windir% and treat it just as a NOTE. Therefore just executing cmd with admin privs.
",multiple,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
02a8d7845cd152ae5878f3dfea94e9a4,atomic,Process Injection via C#,"Process Injection using C#
reference: https://github.com/pwndizzle/c-sharp-memory-injection
Excercises Five Techniques
1. Process injection
2. ApcInjectionAnyProcess
3. ApcInjectionNewProcess
4. IatInjection
5. ThreadHijack
Upon successful execution, cmd.exe will execute T1055.exe, which exercises 5 techniques. Output will be via stdout.
",multiple,T1055.004,Process Injection: Asynchronous Procedure Call
ded1bca3c653f7ee376b7f9f72146597,atomic,CreateCronjob,"Kubernetes Job is a controller that creates one or more pods and ensures that a specified number of them successfully terminate. Kubernetes Job can be used to run containers that perform finite tasks for batch jobs. Kubernetes CronJob is used to schedule Jobs. Attackers may use Kubernetes CronJob for scheduling execution of malicious code that would run as a container in the cluster.
",multiple,T1053.007,Kubernetes Cronjob
c627649c38266ebb83e477796312be3c,atomic,Modify Registry to load Arbitrary DLL into LSASS - LsaDbExtPt,"The following Atomic will modify an undocumented registry key that may be abused to load a arbitrary DLL into LSASS. 

Upon execution, the registry key will be modified and a value will contain the path to the DLL. 
Reference: https://blog.xpnsec.com/exploring-mimikatz-part-1/ and source https://github.com/oxfemale/LogonCredentialsSteal
Note that if any LSA based protection is enabled, this will most likely not be successful with LSASS.exe loading the DLL.
",multiple,T1547.008,Boot or Logon Autostart Execution: LSASS Driver
6f5096d87a8f9ac4c397215cb58cc978,atomic,PowerShell - Prompt User for Password,"Prompt User for Password (Local Phishing) as seen in Stitch RAT. Upon execution, a window will appear for the user to enter their credentials.

Reference: https://github.com/nathanlopez/Stitch/blob/master/PyLib/askpass.py
",multiple,T1056.002,Input Capture: GUI Input Capture
4df4fdb269f34dd6d55969c83ff06c73,atomic,Persistence via WMI Event Subscription - ActiveScriptEventConsumer,"Run from an administrator powershell window. After running, reboot the victim machine.
After it has been online for 4 minutes you should see notepad.exe running as SYSTEM.

Code references

https://gist.github.com/mgreen27/ef726db0baac5623dc7f76bfa0fc494c
",multiple,T1546.003,Event Triggered Execution: Windows Management Instrumentation Event Subscription
61fddd16aa5019ccc7e5440fc1be4dfc,atomic,Add file to Local Library StartupItems,"Modify or create an file in /Library/StartupItems

[Reference](https://www.alienvault.com/blogs/labs-research/diversity-in-recent-mac-malware)
",multiple,T1037.005,Boot or Logon Initialization Scripts: Startup Items
d9a63c6a2dac4621d430d0570c995a09,atomic,Cron - Add script to all cron subfolders,"This test adds a script to /etc/cron.hourly, /etc/cron.daily, /etc/cron.monthly and /etc/cron.weekly folders configured to execute on a schedule. This technique was used by the threat actor Rocke during the exploitation of Linux web servers.
",multiple,T1053.003,Scheduled Task/Job: Cron
9ae998b0c1d7aa13b5393f962794b50f,atomic,IFEO Global Flags,"Leverage Global Flags Settings
",multiple,T1546.012,Event Triggered Execution: Image File Execution Options Injection
290915ea4ec9fae461442bd89d9d8098,atomic,Launch NSudo Executable,"Launches the NSudo executable for a short period of time and then exits.
NSudo download observed after maldoc execution. NSudo is a system management tool for advanced users to launch programs with full privileges.",multiple,T1134.001,Access Token Manipulation: Token Impersonation/Theft
d51f79852d358a701aa4fcd3f9cb8adc,atomic,Bash session based keylogger,"When a command is executed in bash, the BASH_COMMAND variable contains that command. For example :~$ echo $BASH_COMMAND = ""echo $BASH_COMMAND"". The trap command is not a external command, but a built-in function of bash and can be used in a script to run a bash function when some event occurs. trap will detect when the BASH_COMMAND variable value changes and then pipe that value into a file, creating a bash session based keylogger. 

To gain persistence the command could be added to the users .bashrc or .bash_aliases or the systems default .bashrc in /etc/skel/ 
",multiple,T1056.001,Input Capture: Keylogging
a50586369af237825fc9ccd500b80e5d,atomic,Logon Scripts,"Adds a registry value to run batch script created in the %temp% directory. Upon execution, there will be a new environment variable in the HKCU\Environment key
that can be viewed in the Registry Editor.
",multiple,T1037.001,Boot or Logon Initialization Scripts: Logon Script (Windows)
3c0760559a620aad7664cdf98f486127,atomic,PowerShell Registry RunOnce,"RunOnce Key Persistence via PowerShell
Upon successful execution, a new entry will be added to the runonce item in the registry.
",multiple,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
d9c719f978740efa1ed6db8fbc749706,atomic,Windows Internal pktmon set filter,"Select Desired ports for packet capture 
https://lolbas-project.github.io/lolbas/Binaries/Pktmon/",multiple,T1040,Network Sniffing
7f43a2b144f2534eb979d2b6638e0283,atomic,GlobalFlags in Image File Execution Options,"The following Atomic Test will create a GlobalFlag key under Image File Execution Options, also a SilentProcessExit Key with ReportingMode and MonitorProcess values. This test is similar to a recent CanaryToken that will generate an EventCode 3000 in the Application log when a command, whoami.exe for example, is executed.
Upon running Whoami.exe, a command shell will spawn and start calc.exe based on the MonitorProcess value. 
Upon successful execution, powershell will modify the registry and spawn calc.exe. An event 3000 will generate in the Application log.
",multiple,T1546.012,Event Triggered Execution: Image File Execution Options Injection
78c03eac53060523b4eef3ad473d218c,atomic,Add command to .bashrc,"Adds a command to the .bashrc file of the current user
",multiple,T1546.004,Event Triggered Execution: .bash_profile and .bashrc
74117090d6c33ade24c37b5d5b804681,atomic,Linux - Load Kernel Module via insmod,"This test uses the insmod command to load a kernel module for Linux.
",multiple,T1547.006,Boot or Logon Autostart Execution: Kernel Modules and Extensions
20d68348c822d2947e5a795ac15a22b0,atomic,Bypass UAC using Fodhelper - PowerShell,"PowerShell code to bypass User Account Control using the Windows 10 Features on Demand Helper (fodhelper.exe). Requires Windows 10.
Upon execution command prompt will be opened.
",multiple,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
31a63c6d775c708f307a784f73e1b410,atomic,Bitsadmin Download (cmd),"This test simulates an adversary leveraging bitsadmin.exe to download
and execute a payload
",multiple,T1197,BITS Jobs
e9345933cc8cb67dbc560f3c2066edd0,atomic,LockBit Black - Modify Group policy settings -cmd,"An adversary can modify the group policy settings.
",multiple,T1484.001,Domain Policy Modification: Group Policy Modification
c214325cdad9e7f8099cea7c890d4156,atomic,Shared Library Injection via /etc/ld.so.preload,"This test adds a shared library to the `ld.so.preload` list to execute and intercept API calls. This technique was used by threat actor Rocke during the exploitation of Linux web servers. This requires the `glibc` package.

Upon successful execution, bash will echo `../bin/T1574.006.so` to /etc/ld.so.preload. 
",multiple,T1574.006,Hijack Execution Flow: LD_PRELOAD
495536c73651969fd80a8f263c293194,atomic,HKCU - Persistence using CommandProcessor AutoRun key (Without Elevation),"An adversary may abuse the CommandProcessor AutoRun registry key to persist. Every time cmd.exe is executed, the command defined in the AutoRun key also gets executed.
[reference](https://devblogs.microsoft.com/oldnewthing/20071121-00/?p=24433)",multiple,T1546,Event Triggered Execution
3a67bc42e7f567d9faffab9af37afa72,atomic,Disable UAC using reg.exe,"Disable User Account Conrol (UAC) using the builtin tool reg.exe by changing its registry key
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\EnableLUA from 1 to 0
",multiple,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
1091a1dcd359e4ad8d577e7d3d1a18b3,atomic,Append commands user shell profile,"An adversary may wish to establish persistence by executing malicious commands from the users ~/.profile every time the ""user"" logs in.
",multiple,T1546.004,Event Triggered Execution: .bash_profile and .bashrc
c718b1860b3b1689beda518f39b4e90a,atomic,Deploy Docker container,"Adversaries may deploy containers based on retrieved or built malicious images or from benign images that download and execute malicious payloads at runtime. They can do this using docker create and docker start commands. Kinsing & Doki was exploited using this technique. 
",multiple,T1610,Deploy a container
5bfd20d7a230f8472d78362fd2b9416f,atomic,WMI Invoke-CimMethod Scheduled Task,"Create an scheduled task that executes notepad.exe after user login from XML by leveraging WMI class PS_ScheduledTask. Does the same thing as Register-ScheduledTask cmdlet behind the scenes.
",multiple,T1053.005,Scheduled Task/Job: Scheduled Task
f4ae0566412bb12efb2d03466b4546e7,atomic,Bad Potato,"https://github.com/BeichenDream/BadPotato
Privilege escalation using named pipe connections",multiple,T1134.001,Access Token Manipulation: Token Impersonation/Theft
5bf05600c43ae20df8e0723ce2c3c30b,atomic,Add a driver,"Install a driver via pnputil.exe lolbin
",multiple,T1547,Boot or Logon Autostart Execution
5c23188ed301af9f1b6b55d4f3f60b46,atomic,Winlogon Userinit Key Persistence - PowerShell,"PowerShell code to set Winlogon userinit key to execute a binary at logon along with userinit.exe.

Upon successful execution, PowerShell will modify a registry value to execute cmd.exe upon logon/logoff.
",multiple,T1547.004,Boot or Logon Autostart Execution: Winlogon Helper DLL
434e3cfb32590973acfc2cad9c3b523a,atomic,Parent PID Spoofing using PowerShell,"This test uses PowerShell to replicates how Cobalt Strike does ppid spoofing and masquerade a spawned process.
Upon execution, ""Process C:\Program Files\Internet Explorer\iexplore.exe is spawned with pid ####"" will be displayed and
calc.exe will be launched.

Credit to In Ming Loh (https://github.com/countercept/ppid-spoofing/blob/master/PPID-Spoof.ps1)
",multiple,T1134.004,Access Token Manipulation: Parent PID Spoofing
52b03ab57c6d0594e014da562857b49f,atomic,Change Default File Association,"Change Default File Association From cmd.exe of hta to notepad.

Upon successful execution, cmd.exe will change the file association of .hta to notepad.exe. 
",multiple,T1546.001,Event Triggered Execution: Change Default File Association
6fb0cdea444d58a340896d606baf281a,atomic,WMI Invoke-CimMethod Start Process,"The following Atomic will create a New-CimSession on a remote endpoint and start a process usnig Invoke-CimMethod.
This is a novel way to perform lateral movement or to start a remote process.
This does require WinRM to be enabled. The account performing the run will also need to be elevated.
A successful execution will stdout that the process started. On the remote endpoint, wmiprvse.exe will spawn the given process.
",multiple,T1546,Event Triggered Execution
d7264e14d130acb7e172b05ec2e1ae47,atomic,Create local account with admin privileges - MacOS,After execution the new account will be active and added to the Administrators group,multiple,T1078.003,Valid Accounts: Local Accounts
7ebfbb078ecbc1808b6539325f9b4f6d,atomic,"Packet Capture Linux socket AF_PACKET,SOCK_RAW with BPF filter for UDP with sudo","Captures packets with domain=AF_PACKET,type=SOCK_RAW for a few seconds.
Sets a BPF filter on the socket to filter for UDP traffic.
",multiple,T1040,Network Sniffing
52dff845d1f77f440cd58189e2de92cf,atomic,ListCronjobs,"Kubernetes Job is a controller that creates one or more pods and ensures that a specified number of them successfully terminate. Kubernetes Job can be used to run containers that perform finite tasks for batch jobs. Kubernetes CronJob is used to schedule Jobs. Attackers may use Kubernetes CronJob for scheduling execution of malicious code that would run as a container in the cluster.
",multiple,T1053.007,Kubernetes Cronjob
e9e69b4fedb8e40d634865ce9a3192dc,atomic,Detect Virtualization Environment (Windows),"Windows Management Instrumentation(WMI) objects contains system information which helps to detect virtualization. This command will specifically attempt to get the CurrentTemperature value from this object and will check to see if the attempt results in an error that contains the word supported. This is meant to find the result of Not supported, which is the result if run in a virtual machine
",multiple,T1497.001,Virtualization/Sandbox Evasion: System Checks
732a2ad9a39ad8abffdc02c80246c32a,atomic,Service Installation CMD,"Download an executable from github and start it as a service.
Upon successful execution, powershell will download `AtomicService.exe` from github. cmd.exe will spawn sc.exe which will create and start the service. Results will output via stdout.
",multiple,T1543.003,Create or Modify System Process: Windows Service
b45598708fd9e5b197cb58cf193f4778,atomic,HKLM - Add malicious StubPath value to existing Active Setup Entry,"This test will add a StubPath entry to the Active Setup native registry key associated with 'Internet Explorer Core Fonts' (UUID {C9E9A340-D1F1-11D0-821E-444553540600}) 
Said key doesn't have a StubPath value by default, by adding one it will launch calc by forcing to run active setup using runonce.exe /AlternateShellStartup. 
Without the last command it will normally run on next user logon. Note: this test will only run once successfully if no cleanup command is run in between test.
",multiple,T1547.014,Active Setup
7ecae3350a573cf886e1a51e21b2cbbd,atomic,Make and modify binary from C source,"Make, change owner, and change file attributes on a C source code file
",multiple,T1548.001,Abuse Elevation Control Mechanism: Setuid and Setgid
d7047b60bc9fe8c0b7a99f0d3dbdce55,atomic,Process Injection via mavinject.exe,"Windows 10 Utility To Inject DLLS.

Upon successful execution, powershell.exe will download T1055.dll to disk. Powershell will then spawn mavinject.exe to perform process injection in T1055.dll.
With default arguments, expect to see a MessageBox, with notepad's icon in taskbar.
",multiple,T1055.001,Process Injection: Dynamic-link Library Injection
f85556ac016baf1d7938396a6c048166,atomic,Thread Execution Hijacking,"This test injects a MessageBox shellcode generated by msfvenom in Notepad.exe using Thread Execution Hijacking. When successful, a message box will appear with the ""Atomic Red Team"" caption after one or two seconds. ",multiple,T1055.003,Thread Execution Hijacking
ae73a53476995f46b71f11709f525319,atomic,`SeDebugPrivilege` token duplication,"Uses PowerShell and Empire's [GetSystem module](https://github.com/BC-SECURITY/Empire/blob/v3.4.0/data/module_source/privesc/Get-System.ps1). The script uses `SeDebugPrivilege` to obtain, duplicate and impersonate the token of a another process.
When executed successfully, the test displays the domain and name of the account it's impersonating (local SYSTEM).",multiple,T1134.001,Access Token Manipulation: Token Impersonation/Theft
fdc26580786ac9d3ffc38aea053cbd29,atomic,WinPwn - Get SYSTEM shell - Pop System Shell using Token Manipulation technique,Get SYSTEM shell - Pop System Shell using Token Manipulation technique via function of WinPwn,multiple,T1134.002,Create Process with Token
13370afb983bcc3344af451d8877f047,atomic,Copy in loginwindow.plist for Re-Opened Applications,"Copy in new loginwindow.plist to launch Calculator.
",multiple,T1547.007,Boot or Logon Autostart Execution: Re-opened Applications
ba17b809fd2fd268b61eb9f41d939f98,atomic,Enable Guest Account on macOS,This test enables the guest account on macOS using sysadminctl utility.,multiple,T1078.001,Valid Accounts: Default Accounts
776315112cd7318c4afd38f7847465fb,atomic,Add Federation to Azure AD,"Add a new federated domain to Azure AD using PowerShell.
The malicious domain to be federated must be configured beforehand (outside of the scope of this test):
    1. Open Azure Portal
    2. Add a new ""custom domain name""
    3. Verify the domain by following instructions (i.e. create the requested DNS record)
",multiple,T1484.002,Domain Trust Modification
ab44803d5a9c299258efff185b0f70b5,atomic,rc.common,"Modify rc.common

[Reference](https://developer.apple.com/library/content/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/StartupItems.html)
",multiple,T1037.004,Boot or Logon Initialization Scripts: Rc.common
67fe3c9df14ec9c65b9fdeb5fcc62bb6,atomic,Edit an existing time provider,"Establishes persistence by editing the NtpServer time provider registry key under HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W32Time\TimeProvider.
The time provider will point to a DLL which will be loaded after the w32time service is started. The DLL will then create the file AtomicTest.txt
in C:\Users\Public\ as validation that the test is successful.

Payload source code: https://github.com/tr4cefl0w/payloads/tree/master/T1547.003/
",multiple,T1547.003,Time Providers
b52cfdbe25a4907867c8a7a4d639e471,atomic,SSHD PAM keylogger,"Linux PAM (Pluggable Authentication Modules) is used in sshd authentication. The Linux audit tool auditd can use the pam_tty_audit module to enable auditing of TTY input and capture all keystrokes in a ssh session and place them in the /var/log/audit/audit.log file after the session closes.
",multiple,T1056.001,Input Capture: Keylogging
e41543eff9eebdbceef4ee8229cabf98,atomic,System Scope COR_PROFILER,"Creates system scope environment variables to enable a .NET profiler (COR_PROFILER). System scope environment variables require a restart to take effect.
The unmanaged profiler DLL (T1574.012x64.dll`) executes when the CLR is loaded by any process. Additionally, the profiling DLL will inherit the integrity
level of Event Viewer bypassing UAC and executing `notepad.exe` with high integrity. If the account used is not a local administrator the profiler DLL will
still execute each time the CLR is loaded by a process, however, the notepad process will not execute with high integrity.

Reference: https://redcanary.com/blog/cor_profiler-for-persistence/
",multiple,T1574.012,Hijack Execution Flow: COR_PROFILER
0e43a2cb76678e7dcaeb96646fa99c14,atomic,Provide the SetUID capability to a file,"This test gives a file the capability to set UID without using flags.
",multiple,T1548.001,Abuse Elevation Control Mechanism: Setuid and Setgid
33548b5551dd6fe979b00d2ad37e499b,atomic,Injection SID-History with mimikatz,"Adversaries may use SID-History Injection to escalate privileges and bypass access controls. Must be run on domain controller
",multiple,T1134.005,Access Token Manipulation: SID-History Injection
c3b299c5e0884f167a3c2c2be447067c,atomic,DLL Side-Loading using the dotnet startup hook environment variable,"Utilizing the dotnet_startup_hooks environment variable, this method allows for registering a global method in an assembly that will be executed whenever a .net core application is started. This unlocks a whole range of scenarios, from injecting a profiler to tweaking a static context in a given environment. [blog post](https://medium.com/criteo-engineering/c-have-some-fun-with-net-core-startup-hooks-498b9ad001e1)
",multiple,T1574.002,Hijack Execution Flow: DLL Side-Loading
36d1f9546258d3a8ca9489853597acd3,atomic,"Packet Capture Linux socket AF_PACKET,SOCK_RAW with sudo","Captures packets with domain=AF_PACKET, type=SOCK_RAW for a few seconds.
",multiple,T1040,Network Sniffing
dc74af5b90b9cbb4dcfbcaaa3e412a5e,atomic,Winlogon HKLM Shell Key Persistence - PowerShell,"PowerShell code to set Winlogon shell key to execute a binary at logon along with explorer.exe.

Upon successful execution, PowerShell will modify a registry value to execute cmd.exe upon logon/logoff.
",multiple,T1547.004,Boot or Logon Autostart Execution: Winlogon Helper DLL
b745ad6d82b54521c261f827005136e7,atomic,Remote Process Injection in LSASS via mimikatz,"Use mimikatz to remotely (via psexec) dump LSASS process content for RID 500 via code injection (new thread).
Especially useful against domain controllers in Active Directory environments.
It must be executed in the context of a user who is privileged on remote `machine`.

The effect of `/inject` is explained in <https://blog.3or.de/mimikatz-deep-dive-on-lsadumplsa-patch-and-inject.html>
",multiple,T1055,Process Injection
07315b5d93b5ea5a78b34a54be41222f,atomic,Create local account (Linux),"An adversary may wish to create an account with admin privileges to work with. In this test we create a ""art"" user with the password art, switch to art, execute whoami, exit and delete the art user.
",multiple,T1078.003,Valid Accounts: Local Accounts
5fef3e10a3e1113d7d31a26c03c5117a,atomic,Section View Injection,"This test creates a section object in the local process followed by a local section view.
The shellcode is copied into the local section view and a remote section view is created in the target process, pointing to the local section view. 
A thread is then created in the target process, using the remote section view as start address.
",multiple,T1055,Process Injection
55e14d8b479b905a13976c8d94016a7b,atomic,HKLM - Append Command to Winlogon Userinit KEY Value,"This test will append a command to the  HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit value to launch calc.exe on boot.
* Requires reboot
",multiple,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
ba8ddc38c7c6ced12fecc0d695c5e57c,atomic,Powershell Cmdlet Scheduled Task,"Create an atomic scheduled task that leverages native powershell cmdlets.

Upon successful execution, powershell.exe will create a scheduled task to spawn cmd.exe at 20:10.
",multiple,T1053.005,Scheduled Task/Job: Scheduled Task
f1debf348737a5744911d71cec0ca4ea,atomic,Unlimited sudo cache timeout,"Sets sudo caching timestamp_timeout to a value for unlimited. This is dangerous to modify without using 'visudo', do not do this on a production system.
",multiple,T1548.003,Abuse Elevation Control Mechanism: Sudo and Sudo Caching
47782bfea04a05a4b7b1c4b59279b4fb,atomic,User scope COR_PROFILER,"Creates user scope environment variables and CLSID COM object to enable a .NET profiler (COR_PROFILER).
The unmanaged profiler DLL (`T1574.012x64.dll`) executes when the CLR is loaded by the Event Viewer process.
Additionally, the profiling DLL will inherit the integrity level of Event Viewer bypassing UAC and executing `notepad.exe` with high integrity.
If the account used is not a local administrator the profiler DLL will still execute each time the CLR is loaded by a process, however,
the notepad process will not execute with high integrity.

Reference: https://redcanary.com/blog/cor_profiler-for-persistence/
",multiple,T1574.012,Hijack Execution Flow: COR_PROFILER
7ad5840a79f3259965fa28835dda93c4,atomic,HKLM - re-execute 'Internet Explorer Core Fonts' StubPath payload by decreasing version number,"This test will decrease the version number of the 'Internet Explorer Core Fonts' (UUID {C9E9A340-D1F1-11D0-821E-444553540600}) registry key for the current user, 
which will force the StubPath payload (if set) to execute.
",multiple,T1547.014,Active Setup
938a659c52ed102a8b35c7b1bb49eb11,atomic,Persistence via WMI Event Subscription - CommandLineEventConsumer,"Run from an administrator powershell window. After running, reboot the victim machine.
After it has been online for 4 minutes you should see notepad.exe running as SYSTEM.

Code references

https://gist.github.com/mattifestation/7fe1df7ca2f08cbfa3d067def00c01af

https://github.com/EmpireProject/Empire/blob/master/data/module_source/persistence/Persistence.psm1#L545
",multiple,T1546.003,Event Triggered Execution: Windows Management Instrumentation Event Subscription
fd2611bbbe81dfbe6c282799fea56737,atomic,Mimikatz Kerberos Ticket Attack,"Similar to PTH, but attacking Kerberos
",multiple,T1550.003,Use Alternate Authentication Material: Pass the Ticket
f46fcebae29a2bde63127a3bcee47d23,atomic,Add command to .bash_profile,"Adds a command to the .bash_profile file of the current user
",multiple,T1546.004,Event Triggered Execution: .bash_profile and .bashrc
f204aa8bd030dab20527e2bc8a230f35,atomic,COM Hijacking with RunDLL32 (Local Server Switch),"This test uses PowerShell to hijack a reference to a Component Object Model by creating registry values under InprocServer32 key in the HKCU hive then calling the Class ID to be executed via ""rundll32.exe -localserver [clsid]"". 
This method is generally used as an alternative to 'rundll32.exe -sta [clsid]' to execute dll's while evading detection. 
Reference: https://www.hexacorn.com/blog/2020/02/13/run-lola-bin-run/
Upon successful execution of this test with the default options, whenever certain apps are opened (for example, Notepad), a calculator window will also be opened. ",multiple,T1546.015,Event Triggered Execution: Component Object Model Hijacking
7cd5d1852fb4a534fa9b735288ca158f,atomic,Winlogon Shell Key Persistence - PowerShell,"PowerShell code to set Winlogon shell key to execute a binary at logon along with explorer.exe.

Upon successful execution, PowerShell will modify a registry value to execute cmd.exe upon logon/logoff.
",multiple,T1547.004,Boot or Logon Autostart Execution: Winlogon Helper DLL
2f8f26ef6caacf086dd9b7f7b5031fa5,atomic,Authentication Package,"Establishes persistence using a custom authentication package for the Local Security Authority (LSA).
After a reboot, Notepad.exe will be executed as child process of lsass.exe.
Payload source code: https://github.com/tr4cefl0w/payloads/tree/master/T1547.002/package
[Related blog](https://pentestlab.blog/2019/10/21/persistence-security-support-provider/)
",multiple,T1547.002,Authentication Package
3e08ce272958e39325d1a9f4a2b71bda,atomic,crackmapexec Pass the Hash,"command execute with crackmapexec
",multiple,T1550.002,Use Alternate Authentication Material: Pass the Hash
65543e25f0be2d93b572fd6e774a8432,atomic,UACME Bypass Method 33,"Executes User Account Control Bypass according to the methods listed below. Upon successful execution you should see event viewer load and two administrative command prompts.
Note: The cleanup_command's which kill the spawned cmd and event viewer processes only work if run as admin.

Author: winscripting.blog

Type:	Shell API

Method: Registry key manipulation

Target:	\system32\fodhelper.exe

Component:	Attacker defined

Implementation:	ucmShellRegModMethod

UCM Method:	UacMethodMsSettings2

https://github.com/hfiref0x/UACME
",multiple,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
cf0d29048615fe0d040e55067b684b49,atomic,Create/Append to .bash_logout,"The Bash shell runs ~/.bash_logout ""if it exists"" to run commands on user logout. An adversary may create or append to a .bash_logout to clear history, start processes etc. Note the ~/.bash_logout is only run if you explicitly exit or log out of an ""interactive login shell session"" i.e. via the console, SSH, /bin/bash -l or su -l <username>. 

This test creates the art user, logs in, creates a .bash_logout which will echo some text into the art.txt file on logout and logs out and the /home/art/art.txt is created.
",multiple,T1546.004,Event Triggered Execution: .bash_profile and .bashrc
f4873fff8940c0507868b38e78de1b0d,atomic,Malicious PAM rule,"Inserts a rule into a PAM config and then tests it.

Upon successful execution, this test will insert a rule that allows every user to su to root without a password.
",multiple,T1556.003,Modify Authentication Process: Pluggable Authentication Modules
469f554b1c5e8613d3ec3662e9d9e3e1,atomic,Scheduled Task Executing Base64 Encoded Commands From Registry,"A Base64 Encoded command will be stored in the registry (ping 127.0.0.1) and then a scheduled task will be created.
The scheduled task will launch powershell to decode and run the command in the registry daily.
This is a persistence mechanism recently seen in use by Qakbot.  

[Additiona Information](https://thedfirreport.com/2022/02/07/qbot-likes-to-move-it-move-it/)
",multiple,T1053.005,Scheduled Task/Job: Scheduled Task
8ce073cf3170576e1f5c6e4d06e1873a,atomic,Invoke-WMIExec Pass the Hash,"Use Invoke-WMIExec to Pass the Hash
Note: must dump hashes first
[Reference](https://github.com/gentilkiwi/mimikatz/wiki/module-~-sekurlsa#pth)",multiple,T1550.002,Use Alternate Authentication Material: Pass the Hash
d94bcdfc9d0f769b062e1960f7af6804,atomic,Powershell Execute COM Object,"Use the PowerShell to execute COM CLSID object.
Reference: https://pentestlab.blog/2020/05/20/persistence-com-hijacking/",multiple,T1546.015,Event Triggered Execution: Component Object Model Hijacking
d67033955c82846f51aea6aba4afc14d,atomic,Service Registry Permissions Weakness,"Service registry permissions weakness check and then which can lead to privilege escalation with ImagePath. eg.
reg add ""HKLM\SYSTEM\CurrentControlSet\Services\#{weak_service_name}"" /v ImagePath /d ""C:\temp\AtomicRedteam.exe""
",multiple,T1574.011,Hijack Execution Flow: Services Registry Permissions Weakness
a858f6dce84f8f41306497474cfa952f,atomic,UACME Bypass Method 31,"Executes User Account Control Bypass according to the methods listed below. Upon successful execution you should see event viewer load and two administrative command prompts.
Note: The cleanup_command's which kill the spawned cmd and event viewer processes only work if run as admin.

Author: Enigma0x3

Type:	Shell API

Method: Registry key manipulation

Target:	\system32\sdclt.exe

Component: Attacker defined

Implementation:	ucmSdcltIsolatedCommandMethod

UCM Method:	UacMethodShellSdclt

https://github.com/hfiref0x/UACME
",multiple,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
4e9bac619326378b219b3635c9a91b94,atomic,Parent PID Spoofing - Spawn from New Process,Creates a notepad.exe process and then spawns a powershell.exe process as a child of it.,multiple,T1134.004,Access Token Manipulation: Parent PID Spoofing
3b2764c4c99a4adec2c68dc264d9e6c4,atomic,Packet Capture Linux using tshark or tcpdump,"Perform a PCAP. Wireshark will be required for tshark. TCPdump may already be installed.

Upon successful execution, tshark or tcpdump will execute and capture 5 packets on interface ens33.
",multiple,T1040,Network Sniffing
6df7f4008df545053790a890dd68e27c,atomic,Event Monitor Daemon Persistence,"This test adds persistence via a plist to execute via the macOS Event Monitor Daemon. 
",multiple,T1543.001,Create or Modify System Process: Launch Agent
353949fcc1528656830ece93878589cb,atomic,Windows MOFComp.exe Load MOF File,"The following Atomic will utilize MOFComp.exe to load a local MOF file.
The Managed Object Format (MOF) compiler parses a file containing MOF statements and adds the classes and class instances defined in the file to the WMI repository. 
To query for the class:  gwmi __eventfilter -namespace root\subscription
A successful execution will add the class to WMI root namespace.
Reference: https://pentestlab.blog/2020/01/21/persistence-wmi-event-subscription/ and https://thedfirreport.com/2022/07/11/select-xmrig-from-sqlserver/.
",multiple,T1546.003,Event Triggered Execution: Windows Management Instrumentation Event Subscription
db9cadf506caece270e0cf2aeff67693,atomic,DLL Side-Loading using the Notepad++ GUP.exe binary,"GUP is an open source signed binary used by Notepad++ for software updates, and is vulnerable to DLL Side-Loading, thus enabling the libcurl dll to be loaded.
Upon execution, calc.exe will be opened.
",multiple,T1574.002,Hijack Execution Flow: DLL Side-Loading
17864bace5099482c4b06b3ab032fb71,atomic,Creating GCP Service Account and Service Account Key,"GCP Service Accounts can be used to gain intial access as well as maintain persistence inside Google Cloud.
",multiple,T1078.004,Valid Accounts: Cloud Accounts
bed8f28e-c0ed-463e-9e31-d5607e5473df,access,Load Metasploit Abilities,Load Metasploit Abilities,build-capabilities,T1349,Build or acquire exploits
567eaaba-94cc-4a27-83f8-768e5638f4e1,access,NMAP scan,Scan an external host for open ports and services,technical-information-gathering,T1254,Conduct active scanning
